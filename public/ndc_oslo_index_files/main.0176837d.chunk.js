(this["webpackJsonp@checkin.no/registration"]=this["webpackJsonp@checkin.no/registration"]||[]).push([[0],{107:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationType=void 0,function(e){e[e.SUCCESS=0]="SUCCESS",e[e.ERROR=1]="ERROR",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.DARK=4]="DARK"}(t.NotificationType||(t.NotificationType={}))},30:function(e,t,n){var a=n(787).create();a.import(n(797)),a.import(n(801)),a.import(n(387)),a.import(n(305)),a.import(n(805)),a.import(n(818)),e.exports=a},973:function(e,t){},977:function(e,t,n){},978:function(e,t,n){"use strict";n.r(t),n.d(t,"Registration",(function(){return Vu}));var a,i,r,s,c,o,d,l,u,m,p,h,b=n(0),f=n.n(b),v=n(65),j=n.n(v),g=(n(565),n(569),n(570),n(571),n(572),n(573),n(574),n(575),n(576),n(577),n(578),n(579),n(580),n(581),n(582),n(583),n(584),n(585),n(586),n(587),n(588),n(589),n(590),n(592),n(593),n(291),n(594),n(595),n(596),n(597),n(598),n(599),n(600),n(601),n(602),n(603),n(604),n(605),n(606),n(608),n(609),n(610),n(611),n(612),n(613),n(614),n(615),n(616),n(617),n(618),n(619),n(621),n(622),n(623),n(624),n(625),n(626),n(627),n(628),n(629),n(630),n(631),n(632),n(634),n(635),n(636),n(637),n(638),n(639),n(640),n(641),n(643),n(644),n(645),n(646),n(647),n(648),n(649),n(650),n(651),n(652),n(653),n(654),n(655),n(656),n(657),n(658),n(659),n(660),n(661),n(662),n(663),n(665),n(666),n(667),n(668),n(674),n(675),n(676),n(678),n(679),n(680),n(681),n(682),n(683),n(684),n(685),n(686),n(687),n(688),n(453),n(691),n(692),n(693),n(694),n(695),n(696),n(697),n(456),n(698),n(699),n(700),n(701),n(702),n(703),n(705),n(706),n(707),n(708),n(709),n(710),n(711),n(712),n(713),n(714),n(715),n(716),n(717),n(718),n(719),n(720),n(721),n(722),n(723),n(724),n(728),n(729),n(730),n(731),n(732),n(733),n(734),n(735),n(736),n(737),n(738),n(739),n(742),n(743),n(744),n(745),n(746),n(747),n(748),n(749),n(750),n(751),n(752),n(753),n(754),n(755),n(756),n(757),n(758),n(759),n(760),n(761),n(762),n(763),n(764),n(765),n(767),n(768),n(769),n(770),n(772),n(467),n(382),n(773),n(37)),O=n(25),y=n.n(O),x=n(40),k=n(26),C=n(4),T=n(29),E=n(17),S=n(19),N=n(189),_=n(21),I=n(20),w=n(232),A=n.n(w),R=n(151),P=n.n(R),D=n(109),M=n(998),F=n(994),L=n(546),W=n(471),q=n(995),V=function(e,t){return Object.values(e.additionals).filter((function(e){var n=t.child_id?t.child_id:t.id;return e.triggered_by.includes(n)}))},B=n(48),U=n(24),H="default",z="reservation",K="mail",Q="ehf",G="card",$="post",Y="arrival",X="vipps",J="Company",Z="Private",ee="NextButton",te="EditButton",ne="ticketRegistrationAndCloseLastTicket",ae="unavailable",ie="failed",re="error",se="connected",ce="connecting",oe="disconnected",de="NONE",le="DENY",ue="ALLOW",me="FORCE",pe=[11266,11873,12113,12131,12103,12185,12674,12064,13280],he="chooseTicketsWrapper",be="ticketBuyer",fe="ticketRegistration",ve="orderAdditionals",je="summary",ge="payment",Oe="seatmap",ye={male:"MALE",female:"FEMALE"},xe=n(272),ke=n(270),Ce=n(1e3),Te=n(229),Ee=n(35),Se=n(499),Ne=Object(Se.a)(a||(a=Object(Ee.a)(["\n  query getCrm($customer_id: Int!, $id: Int!, $hash: String) {\n    crm(customer_id: $customer_id, id: $id, hash: $hash) {\n      id\n      type\n      name\n      first_name\n      last_name\n      org_nr\n      email\n      prefix\n      tlf\n      country_code\n      customer {\n        id\n        name\n      }\n      address {\n        id\n        address\n        zip\n        city\n        country\n      }\n      links {\n        type\n        crm {\n          id\n          type\n          name\n          org_nr\n          first_name\n          last_name\n          email\n          prefix\n          tlf\n          country_code\n          hash\n          born\n          address {\n            id\n            address\n            zip\n            city\n            country\n          }\n        }\n      }\n    }\n  }\n"]))),_e=(Object(Se.a)(i||(i=Object(Ee.a)(["\n  query getEventAdditionals($id: Int!, $invitations: [EventInvitationInput!]) {\n    event(id: $id, invitations: $invitations) {\n      total_left\n      additionals {\n        id\n        name\n        type\n        description\n        price_ex_vat\n        vat\n        price\n        required\n        checked\n        available\n        discount\n        left\n        isUsingLeftFromCampaignQuota\n        triggered_by\n        children {\n          id\n          name\n          description\n          price_ex_vat\n          price\n          discount\n          vat\n          available\n          left\n          isUsingLeftFromCampaignQuota\n        }\n      }\n    }\n  }\n"]))),Object(Se.a)(r||(r=Object(Ee.a)(["\n  query getAvailable($id: Int!, $invitations: [EventInvitationInput!]) {\n    event(id: $id, invitations: $invitations) {\n      total_left\n      categories {\n        id\n        left\n        isUsingLeftFromCampaignQuota\n        name\n        available\n        min_tickets\n      }\n    }\n  }\n"])))),Ie=Object(Se.a)(s||(s=Object(Ee.a)(["\n  query getAvailable($id: Int!, $invitations: [EventInvitationInput!]) {\n    event(id: $id, invitations: $invitations) {\n      total_left\n      additionals {\n        id\n        name\n        type\n        description\n        price_ex_vat\n        vat\n        price\n        required\n        checked\n        available\n        discount\n        left\n        isUsingLeftFromCampaignQuota\n        triggered_by\n        children {\n          id\n          name\n          description\n          price_ex_vat\n          price\n          discount\n          vat\n          available\n          left\n          isUsingLeftFromCampaignQuota\n        }\n      }\n      categories {\n        id\n        additionals {\n          id\n          available\n          minSelectableChoices\n          maxSelectableChoices\n          name\n          left\n          isUsingLeftFromCampaignQuota\n          children {\n            id\n            name\n            description\n            price_ex_vat\n            price\n            discount\n            vat\n            available\n            left\n            isUsingLeftFromCampaignQuota\n          }\n        }\n      }\n    }\n  }\n"]))),we=Object(Se.a)(c||(c=Object(Ee.a)(["\n  query ipLookup {\n    ipLookup {\n      country\n    }\n  }\n"]))),Ae=Object(Se.a)(o||(o=Object(Ee.a)(["\n  query getEventCategories($id: Int!, $invitations: [EventInvitationInput!], $subject: TokenSubjectEnum!) {\n    token: getTokenRegistration(subject: $subject) {\n      token\n    }\n    event(id: $id, invitations: $invitations) {\n      id\n      name\n      total_left\n      type\n      opens\n      close\n      translations {\n        id\n        eventId\n        childId\n        table\n        field\n        language\n        text\n      }\n      customer {\n        id\n        price_mode\n      }\n      uiSettings {\n        sameAsTicketBuyer\n      }\n      settings {\n        payment_company\n        invoiceStartsSendingAt\n        language\n        coupons\n        ticket_limit\n        waiting_list {\n          holdBackInvoice\n          forceWaitinglist\n          confirmationContent\n        }\n        fields {\n          key\n          required\n          label\n        }\n        ticketUserProperties {\n          id\n          type\n          required\n        }\n        discounts {\n          start\n          stop\n          trigger\n          trigger_value\n          type\n          value\n          affects\n          affects_value\n          modes\n          categories\n          category_only\n          times_total\n          times_used\n        }\n        analytics {\n          registration {\n            meta {\n              isActive\n            }\n            google {\n              isActive\n            }\n          }\n        }\n        modes\n        payment_method\n        payment_methods\n        paymentMethods {\n          corporate\n          private\n        }\n        texts {\n          conditions\n          thankyou\n          thankyou_url\n        }\n        ticket_fee {\n          fee\n          mode\n          free\n        }\n      }\n      categories {\n        id\n        name\n        description\n        prices {\n          price\n          vat\n        }\n        price\n        price_ex_vat\n        discount\n        vat\n        left\n        isUsingLeftFromCampaignQuota\n        available\n        min_tickets\n        waiting_list\n        private\n        digital\n        published\n        seating\n        additionals {\n          id\n          name\n          description\n          type\n          available\n          left\n          isUsingLeftFromCampaignQuota\n          triggered_by\n          minSelectableChoices\n          maxSelectableChoices\n          price\n          required\n          checked\n          vat\n          discount\n          waiting_list\n          price_ex_vat\n          children {\n            id\n            name\n            description\n            price_ex_vat\n            waiting_list\n            price\n            discount\n            vat\n            available\n            left\n            isUsingLeftFromCampaignQuota\n          }\n        }\n      }\n      additionals {\n        id\n        name\n        description\n        available\n        type\n        left\n        isUsingLeftFromCampaignQuota\n        triggered_by\n        price\n        required\n        checked\n        vat\n        minSelectableChoices\n        maxSelectableChoices\n        discount\n        price_ex_vat\n        waiting_list\n        children {\n          id\n          name\n          description\n          price_ex_vat\n          price\n          discount\n          vat\n          available\n          left\n          isUsingLeftFromCampaignQuota\n          waiting_list\n        }\n      }\n      deletedAt\n      cancelledAt\n      seatmap {\n        svg\n        priceGroups {\n          name\n          price\n          description\n          tickets {\n            ticketId\n            price\n            vat\n          }\n        }\n        options {\n          seatsBuffer\n          forceSeatAllocation\n        }\n      }\n    }\n    # activeMode @client\n  }\n"]))),Re=Object(Se.a)(d||(d=Object(Ee.a)(["\n  query eventCouponValidate($id: Int!, $coupon: String!) {\n    eventCouponValidate(id: $id, coupon: $coupon) {\n      start\n      stop\n      trigger\n      trigger_value\n      type\n      value\n      affects\n      affects_value\n      modes\n      categories\n      category_only\n      times_total\n      times_used\n    }\n  }\n"]))),Pe=Object(Se.a)(l||(l=Object(Ee.a)(["\n  mutation(\n    $event_id: Int!\n    $contact_crm: ContactInput!\n    $users: [UserInput]!\n    $billing_crm: CompanyInput\n    $mode: EventOrderModeEnum\n    $coupon: String\n    $reference: String\n    $payment_form: EventPaymentFormEnum\n    $additionals: [AdditionalInput]\n    $language: LanguageEnum\n    $invitations: [EventInvitationInput!]\n  ) {\n    addEventOrder(\n      event_id: $event_id\n      contact_crm: $contact_crm\n      users: $users\n      billing_crm: $billing_crm\n      mode: $mode\n      coupon: $coupon\n      invoice_reference: $reference\n      payment_form: $payment_form\n      additionals: $additionals\n      language: $language\n      invitations: $invitations\n    ) {\n      id\n      created\n      billing_crm {\n        name\n        org_nr\n        ehf\n        email_invoice\n        address {\n          address\n          zip\n          city\n          country\n        }\n      }\n      users {\n        fields {\n          key\n          value\n        }\n        discount\n        category\n        price\n        sum\n        price_ex_vat\n        additionals {\n          name\n          value\n          price\n          discount\n        }\n      }\n      sum\n      sum_vat\n      sum_ex_vat\n      payment_url\n    }\n  }\n"]))),De=(Object(Se.a)(u||(u=Object(Ee.a)(["\n  mutation($event_id: Int!, $type: String!, $type_id: Int!, $number: Int!) {\n    registerEventOrderTmp(event_id: $event_id, type: $type, type_id: $type_id, number: $number) {\n      available\n      type_id\n    }\n  }\n"]))),Object(Se.a)(m||(m=Object(Ee.a)(["\n  query updateAvailability($id: Int!, $type: String!, $count: Int!) {\n    updateAvailability(id: $id, type: $type, count: $count) @client\n  }\n"]))),Object(Se.a)(p||(p=Object(Ee.a)(["\n  query localStateQuery @client {\n    hasOrdered\n    activeMode\n  }\n"])))),Me=Object(Se.a)(h||(h=Object(Ee.a)(["\n  query ehfLookup($orgNr: String!) {\n    ehfLookup(orgNr: $orgNr) {\n      invoice\n    }\n  }\n"])));var Fe,Le={Mutation:{setOrderMode:function(e,t,n){var a=t.mode,i=n.cache,r={activeMode:a};return i.readQuery({query:De}).activeMode!==a&&i.writeData({data:r}),a}},Query:{updateAvailability:function(e,t,n,a){var i=t.id,r=t.type,s=t.count,c=n.cache;try{var o=c.readQuery({query:Ae,variables:Je()}).event;if("category"===r)o.categories.find((function(e){return e.id===i})).available=s,c.writeQuery({query:_e,data:{event:o},variables:Je()});else o.categories.forEach((function(e){var t=e.additionals.find((function(e){return e.id===i}));t&&(t.left=s)})),c.writeQuery({query:Ie,data:{event:o},variables:Je()});return null}catch(d){return console.log("error:",d),null}}}},We="",qe=function(e){We=e},Ve=Object(Ce.a)();Fe=window.location.href.includes("beta.checkin.no")?(console.log("Using graphql on beta"),"https://beta.checkin.no/graphql"):window.location.href.includes("testing.checkin.no")||window.location.href.includes("test-registration.checkin.no/")?(console.log("Using graphql on testing"),"https://testing.checkin.no/graphql"):window.location.href.includes("checkin.no")?"https://api.checkin.no/graphql":window.location.href.includes("localhost")&&document.checkinDevelopmentLocalhost?(console.log("Using graphql on localhost"),"https://localhost/graphql"):"https://api.checkin.no/graphql";var Be=function(){for(var e=window.location.href,t=function(){for(var e=window.location.href,t=0;t<e.length;t++)if("?"===e[t])return t}(),n="",a=0;a<e.length;a++)a!==t&&"?"===e[a]?n+="&":n+=e[a];return n}();Be!==window.location.href&&window.location.replace(Be);var Ue=Xe();Ue&&!document.event_id&&(document.event_id=Number(Ue.id));var He=new xe.a({addTypename:!1}),ze=Object(Te.b)({uri:"/graphql",credentials:"include"}),Ke={},Qe=new ke.a({uri:Fe,link:ze,request:function(e){We&&e.setContext({headers:Object(C.a)({Authorization:"Bearer ".concat(We.token)},Ke)})},clientState:{defaults:{hasOrdered:!1,activeMode:"default"},connectToDevTools:!0,resolvers:Le,typeDefs:"\n\ttype Mutation {\n\t\tsetOrderMode(mode: String!): String\n\t}\n\n\ttype Query {\n\t\tactiveMode: String\n\t\thasOrdered: Boolean\n\t}\n"},cache:He,onError:function(e){e.graphQLErrors&&e.graphQLErrors.forEach((function(e){console.log("[GraphQL error]: Message: ".concat(e.message,", Location: ").concat(JSON.stringify(e.locations),", Path: ").concat(e.path))})),e.networkError&&(console.log("[Network error]: ".concat(e.networkError)),console.log("[Network error] statusCode: ".concat(e.networkError.statusCode)))}}),Ge=function(e,t){return t?e.price:e.price_ex_vat},$e=function(e,t,n){return n?e?n.price:n.price_ex_vat:e?t.price:t.price_ex_vat},Ye=function(e){var t=[],n="",a="",i="";e.includes(".")?(n=4===+(t=e.trim().split("."))[2].length?t[2]:null,a=2===+t[1].length?t[1]:null,i=2===+t[0].length?t[0]:null):e.includes("/")&&(n=4===+(t=e.trim().split("/"))[2].length?t[t.length-1]:null,a=2===+t[0].length?t[0]:null,i=2===+t[1].length?t[1]:null);var r=new Date;return r.setFullYear(n,a-1,i),Boolean(+r)&&r.getDate()==i&&r.getFullYear()==n&&r.getMonth()==a-1?"".concat(n,"-").concat(a,"-").concat(i):null};function Xe(){var e=window.location.search.substring(1);if(e.length)try{return JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}catch(t){return null}return null}var Je=function(){var e={id:Number(document.event_id),subject:"REGISTRATION"},t=Xe();return t&&t.pass&&t.category&&(e.invitations=[{id:Number(t.category),type:"TICKET",passphrase:t.pass}]),e};function Ze(e,t){var n=e.split("?");if(n.length>=2){for(var a=encodeURIComponent(t)+"=",i=n[1].split(/[&;]/g),r=i.length;r-- >0;)-1!==i[r].lastIndexOf(a,0)&&i.splice(r,1);return n[0]+(i.length>0?"?"+i.join("&"):"")}return e}var et=function(e){if(e=new RegExp("[?&]"+encodeURIComponent(e)+"=([^&]*)").exec(window.location.search))return decodeURIComponent(e[1])},tt=function(e,t){var n=e.tlf,a=e.country_code;"+"===e.prefix&&(n="",a="");var i="".concat(e.prefix).concat(n),r=Object(C.a)(Object(C.a)({},t),{},{name:e.name,firstName:e.first_name,phone:i,countryCode:a,formattedPhone:n,lastName:e.last_name,email:e.email});if(e.links.length){var s=e.links[0].crm,c=s.name,o=s.address,d=o.address,l=o.zip,u=o.city,m=s.org_nr;e.links[0].crm.address&&(r.companyName=c||"",r.orgNo=m||"",r.address=d||"",r.zipcode=l||"",r.city=u||""),"ORGANIZATION"===e.links[0].crm.type&&(r.payer=J)}return r},nt=function(){return Qe.readQuery({query:Ae,variables:Je()}).event},at=function(){var e=Object(x.a)(y.a.mark((function e(){var t,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe.query({query:Ae,variables:Je()});case 2:return t=e.sent,n=t.data.event,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),it=function(e){return nt().categories.find((function(t){return t.id===e.category_id}))},rt=function(e,t){return it(t).additionals.find((function(t){return t.id===e.id}))},st=function(e,t){return t.find((function(t){return t.children.map((function(e){return e.id})).includes(e)}))};function ct(e,t,n){t[e.id]&&t[e.id].descendants.forEach((function(e){e in t&&(n.push(t[e]),ct(t[e],t,n))}))}var ot=function(e,t,n,a){var i=null;return e&&n[e.id].additionals[t.id]?i=e.onWaiting?n[e.id].additionals[t.id].number:n[e.id].additionals[t.id].onWaiting:!e&&a[t.id]&&(i=a[t.id].onWaiting),i},dt=function(e){var t=e.ticket.additionals;return Object.keys(t).filter((function(e){return"checkbox"===t[e].type}))};function lt(e,t){var n=Object.values(e).map((function(e){return e})).filter((function(e){return e.category_id===t}));return n.length>0?n.length:0}function ut(e,t){var n=Object.values(e).map((function(e){return e})).filter((function(e){return e.category_id===t&&e.onWaiting}));return n.length>0?n.length:0}function mt(e){var t={};return e.forEach((function(n){t[n.id]=n.id in e?e[n.id]:Object(C.a)({},n);var a={};n.children.forEach((function(e){a[e.id]=e.id in n.children?n.children[e.id]:Object(C.a)(Object(C.a)({},e),{},{parent_id:n.id,descendants:[]})}));var i=Object(C.a)(Object(C.a)({},n),{},{preChecked:n.checked,children:a,descendants:[]});t[n.id]=i})),function(e,t){e.forEach((function(n){n.triggered_by.forEach((function(a){var i=st(a,e);if(i){var r=t[i.id].children[a];r.descendants.includes(n.id)||(r.descendants=[].concat(Object(k.a)(r.descendants),[n.id]))}else{var s=t[a];s&&!s.descendants.includes(n.id)&&(s.descendants=[].concat(Object(k.a)(s.descendants),[n.id]))}}))}))}(e,t),t}var pt=function(e,t,n){var a=nt();if(a){var i=a.translations.find((function(n){return n.childId===e.id&&n.field===t}));if(i&&n===i.language){if(e.child_id){var r=a.translations.find((function(n){return n.childId===e.child_id&&n.field===t}));if(r&&n===r.language)return i.text+" - "+r.text}return i.text}}return e[t]},ht=function(e){var t=nt();if(t){var n=t.translations.find((function(e){return"thankyou"===e.field}));if(n&&e===n.language)return n.text}return t.settings.texts.thankyou},bt=function(e){var t=nt();if(t){var n=t.translations.find((function(e){return"confirmationContent"===e.field}));if(n&&e===n.language)return n.text}return t.settings.waiting_list.confirmationContent},ft=function(e){var t=nt();if(t){var n=t.translations.find((function(e){return"disclaimer"===e.field}));if(n&&e===n.language)return n.text}return t.settings.texts.conditions},vt=n(1),jt=f.a.createContext(),gt=["nb","en"],Ot=Object(b.memo)((function(e){return e.dictionary[Object(b.useContext)(jt).language]})),yt=function(e){var t=Object(b.useState)("nb"),n=Object(U.a)(t,2),a=n[0],i=n[1];Object(b.useEffect)((function(){return r(),function(){r()}}),[]);var r=function(){window.addEventListener("message",(function(e){"languagechange"===e.data.type&&"form"!==e.data.source&&"string"===typeof e.data.value&&gt.includes(e.data.value)&&i(e.data.value)}))};return Object(b.useEffect)((function(){try{var e=function(){var e=Object(x.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at();case 2:if(!(t=e.sent)||!t.settings.language){e.next=6;break}return e.next=6,i(t.settings.language);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}catch(t){console.error("error:",t)}}),[e.client]),Object(vt.jsx)(jt.Provider,{value:{language:a,setLanguage:function(e){i(e.target.value),window.postMessage({type:"languagechange",value:e.target.value,source:"form"},window)}},children:e.children})},xt=Object(vt.jsx)(Ot,{dictionary:{nb:"Bestill billetter",en:"Book tickets"}}),kt=Object(vt.jsx)(Ot,{dictionary:{nb:"Bestill uspesifiserte billetter",en:"Book unspecified tickets"}}),Ct=Object(vt.jsx)(Ot,{dictionary:{nb:"Familiep\xe5melding",en:"Family registration"}}),Tt=Object(vt.jsx)(Ot,{dictionary:{nb:"Gruppep\xe5melding",en:"Group registration"}}),Et=Object(vt.jsx)(Ot,{dictionary:{nb:"Lukk",en:"Close"}}),St=Object(vt.jsx)(Ot,{dictionary:{nb:"Endre",en:"Edit"}}),Nt=Object(vt.jsx)(Ot,{dictionary:{nb:"Fortsett",en:"Next"}}),_t=Object(vt.jsx)(Ot,{dictionary:{nb:"Fyll ut neste billett",en:"Fill out next ticket"}}),It=Object(vt.jsx)(Ot,{dictionary:{nb:"Adresse",en:"Address"}}),wt=Object(vt.jsx)(Ot,{dictionary:{nb:"By",en:"City"}}),At=Object(vt.jsx)(Ot,{dictionary:{nb:"Bedriftsnavn",en:"Company name"}}),Rt=Object(vt.jsx)(Ot,{dictionary:{nb:"Velg billetter",en:"Choose tickets"}}),Pt=Object(vt.jsx)(Ot,{dictionary:{nb:"Velg billett",en:"Choose ticket"}}),Dt=Object(vt.jsx)(Ot,{dictionary:{nb:"Totalt",en:"Total"}}),Mt=Object(vt.jsx)(Ot,{dictionary:{nb:"Rabatt",en:"Discount"}}),Ft=Object(vt.jsx)(Ot,{dictionary:{nb:"Billettavgift",en:"Ticket fee"}}),Lt=Object(vt.jsx)(Ot,{dictionary:{nb:"Bestillingskontakt",en:"Order contact"}}),Wt=function(e){return Object(vt.jsx)(Ot,{dictionary:{nb:"".concat(e?"O":"o","rdre tilleggsvalg"),en:"".concat(e?"O":"o","rder additionals")}})},qt=Object(vt.jsx)(Ot,{dictionary:{nb:"Navn",en:"Name"}}),Vt=Object(vt.jsx)(Ot,{dictionary:{nb:"E-post",en:"E-mail"}}),Bt=Object(vt.jsx)(Ot,{dictionary:{nb:"Mobiltelefon",en:"Mobile phone"}}),Ut=Object(vt.jsx)(Ot,{dictionary:{nb:"Hvem betaler?",en:"Who is paying?"}}),Ht=Object(vt.jsx)(Ot,{dictionary:{nb:"Bedrift",en:"Company"}}),zt=Object(vt.jsx)(Ot,{dictionary:{nb:"Privat",en:"Private"}}),Kt=Object(vt.jsx)(Ot,{dictionary:{nb:"Organisasjonsnummer",en:"Organization number"}}),Qt=Object(vt.jsx)(Ot,{dictionary:{nb:"Postnr",en:"Zip"}}),Gt=Object(vt.jsx)(Ot,{dictionary:{nb:"Referanse / PO nummer / Ressursnummer",en:"Reference / PO number"}}),$t=Object(vt.jsx)(Ot,{dictionary:{nb:"Samme som bestillingskontakt",en:"Same as order contact"}}),Yt=Object(vt.jsx)(Ot,{dictionary:{nb:"Billettdetaljer",en:"Ticket details"}}),Xt=Object(vt.jsx)(Ot,{dictionary:{nb:"Sammendrag",en:"Summary"}}),Jt=Object(vt.jsx)(Ot,{dictionary:{nb:"Jeg har en rabattkode",en:"Enter discount code"}}),Zt=function(e){var t=e.includes("inactive");return Object(vt.jsx)(Ot,{dictionary:{nb:t?"Rabattkoden er inaktiv":"Ugyldig rabattkode",en:"Discount code is ".concat(t?"inactive":"invalid")}})},en=Object(vt.jsx)(Ot,{dictionary:{nb:"Antall",en:"Amount"}}),tn=Object(vt.jsx)(Ot,{dictionary:{nb:"Slett",en:"Delete"}}),nn=Object(vt.jsx)(Ot,{dictionary:{nb:"Total ink. MVA",en:"Total inc. VAT"}}),an=Object(vt.jsx)(Ot,{dictionary:{nb:"Total eks. MVA",en:"Total ex. VAT"}}),rn=Object(vt.jsx)(Ot,{dictionary:{nb:"Total MVA",en:"Total VAT"}}),sn=Object(vt.jsx)(Ot,{dictionary:{nb:"eks. MVA",en:"ex. VAT"}}),cn=Object(vt.jsx)(Ot,{dictionary:{nb:"inkl. MVA",en:"inc. VAT"}}),on=Object(vt.jsx)(Ot,{dictionary:{nb:"Rabattkode",en:"Discount code"}}),dn=Object(vt.jsx)(Ot,{dictionary:{nb:"Neste - betaling",en:"Next - payment"}}),ln=Object(vt.jsx)(Ot,{dictionary:{nb:"Betaling",en:"Payment"}}),un=Object(vt.jsx)(Ot,{dictionary:{nb:"Neste - bekreftelse",en:"Next - confirmation"}}),mn=Object(vt.jsx)(Ot,{dictionary:{nb:"Faktura e-post",en:"Invoice e-mail"}}),pn=Object(vt.jsx)(Ot,{dictionary:{nb:"Jeg har lest og akseptert",en:"I have read and accepted the"}}),hn=Object(vt.jsx)(Ot,{dictionary:{nb:"arrang\xf8rens vilk\xe5r",en:"organizer terms"}}),bn=Object(vt.jsx)(Ot,{dictionary:{nb:"og",en:"and"}}),fn=Object(vt.jsx)(Ot,{dictionary:{nb:"Checkins kj\xf8psvilk\xe5r",en:"Checkin's purchase conditions"}}),vn=Object(vt.jsx)(Ot,{dictionary:{nb:"Vilk\xe5r",en:"Conditions"}}),jn=Object(vt.jsx)(Ot,{dictionary:{nb:"G\xe5 til betaling",en:"Go to payment"}}),gn=Object(vt.jsx)(Ot,{dictionary:{nb:"Bekreft bestilling",en:"Confirm order"}}),On=Object(vt.jsx)(Ot,{dictionary:{nb:"Ingen betalingsformer er valgt for dette arrangementet",en:"No payments methods are enabled on this event"}}),yn=Object(vt.jsx)(Ot,{dictionary:{nb:"Din bestilling er gjennomf\xf8rt",en:"Your order has been successfully submitted"}}),xn=Object(vt.jsx)(Ot,{dictionary:{nb:"Du vil innen kort tid motta en bekreftelse per e-post",en:"You will receive a confirmation e-mail shortly"}}),kn=Object(vt.jsx)(Ot,{dictionary:{nb:"Validerer",en:"Validating"}}),Cn=Object(vt.jsx)(Ot,{dictionary:{nb:"Valider",en:"Validate"}}),Tn=Object(vt.jsx)(Ot,{dictionary:{nb:"er godkjent",en:"is valid"}}),En=Object(vt.jsx)(Ot,{dictionary:{nb:"Takk!",en:"Thank you!"}}),Sn=Object(vt.jsx)(Ot,{dictionary:{nb:"Betaling godkjent",en:"Payment confirmed"}}),Nn=Object(vt.jsx)(Ot,{dictionary:{nb:"Beklager, noe gikk galt.",en:"We're sorry something went wrong."}}),_n=Object(vt.jsx)(Ot,{dictionary:{nb:"billett",en:"ticket"}}),In=Object(vt.jsx)(Ot,{dictionary:{nb:"billetter",en:"tickets"}}),wn=Object(vt.jsx)(Ot,{dictionary:{nb:"Billetter",en:"Tickets"}}),An=Object(vt.jsx)(Ot,{dictionary:{nb:"Stillingstittel",en:"Work title"}}),Rn=Object(vt.jsx)(Ot,{dictionary:{nb:"Tilleggsvalg for billetten",en:"Ticket additionals"}}),Pn=Object(vt.jsx)(Ot,{dictionary:{nb:"Skriv inn fullt navn",en:"Enter full name"}}),Dn=Object(vt.jsx)(Ot,{dictionary:{nb:"Skriv inn en gyldig e-postadresse",en:"Enter a valid email"}}),Mn=Object(vt.jsx)(Ot,{dictionary:{nb:"Tast inn gyldig telefonnummer",en:"Enter a valid number"}}),Fn=Object(vt.jsx)(Ot,{dictionary:{nb:"'.con' er ikke gyldig. Mente du '.com'?",en:"'.con' is not valid. Did you mean'.com'?"}}),Ln=Object(vt.jsx)(Ot,{dictionary:{nb:"Bedriftsnavn er p\xe5krevd",en:"Company name is required"}}),Wn=Object(vt.jsx)(Ot,{dictionary:{nb:"Lukk",en:"Close"}}),qn=Object(vt.jsx)(Ot,{dictionary:{nb:"Organisasjonsnummer er p\xe5krevd",en:"Organization number is required"}}),Vn=Object(vt.jsx)(Ot,{dictionary:{nb:"Adresse er p\xe5krevd",en:"Address is required"}}),Bn=Object(vt.jsx)(Ot,{dictionary:{nb:"Postnr er p\xe5krevd",en:"Zip is required"}}),Un=Object(vt.jsx)(Ot,{dictionary:{nb:"By er p\xe5krevd",en:"City is required"}}),Hn=Object(vt.jsx)(Ot,{dictionary:{nb:"Land er p\xe5krevd",en:"Country is required"}}),zn=Object(vt.jsx)(Ot,{dictionary:{nb:"Feil format (dd.mm.yyyy)",en:"Wrong Format (mm/dd/yyyy)"}}),Kn=Object(vt.jsx)(Ot,{dictionary:{nb:"Felt",en:"Field"}}),Qn=Object(vt.jsx)(Ot,{dictionary:{nb:"Rad",en:"Row"}}),Gn=Object(vt.jsx)(Ot,{dictionary:{nb:"Sete",en:"Seat"}}),$n=Object(vt.jsx)(Ot,{dictionary:{nb:"Setekart",en:"Seatmap"}}),Yn=Object(vt.jsx)(Ot,{dictionary:{nb:"Velg seter",en:"Reserve seats"}}),Xn=Object(vt.jsx)(Ot,{dictionary:{nb:"Valgte seter",en:"Reserved seats"}}),Jn=function(e){return Object(vt.jsx)(Ot,{dictionary:{nb:"Velg minimum ".concat(e," alternativer"),en:"Choose a minimum of ".concat(e," options")}})},Zn=Object(vt.jsx)(Ot,{dictionary:{nb:"Lukk setekart",en:"Close seatmap"}}),ea=Object(vt.jsx)(Ot,{dictionary:{nb:"Reservert",en:"Reserved"}}),ta=Object(vt.jsx)(Ot,{dictionary:{nb:"Valgt",en:"Selected"}}),na=Object(vt.jsx)(Ot,{dictionary:{nb:"Rullestol",en:"Wheelchair"}}),aa=Object(vt.jsx)(Ot,{dictionary:{nb:"P\xe5krevd",en:"Required"}}),ia=Object(vt.jsx)(Ot,{dictionary:{nb:"P\xe5krevd felt mangler",en:"Required field is missing"}}),ra=Object(vt.jsx)(Ot,{dictionary:{nb:"Skriv inn gyldig e-mailadresse for faktura",en:"Enter a valid invoice email"}}),sa=Object(vt.jsx)(Ot,{dictionary:{nb:"Fyll ut deltakerinformasjon senere. Du mottar en link p\xe5 e-post hvor du kan fullf\xf8re dette",en:"Fill out attendee information later. A link will be sent to your email address with further instructions on how to complete the order"}}),ca=Object(vt.jsx)(Ot,{dictionary:{nb:"Uspesifiserte billetter",en:"Unspecified tickets"}}),oa=Object(vt.jsx)(Ot,{dictionary:{nb:"Beklager, noen kom deg i forkj\xf8pet",en:"Sorry, someone was faster than you"}}),da=Object(vt.jsx)(Ot,{dictionary:{nb:"Kj\xf8nn",en:"Sex"}}),la=Object(vt.jsx)(Ot,{dictionary:{nb:"Mann",en:"Male"}}),ua=Object(vt.jsx)(Ot,{dictionary:{nb:"Kvinne",en:"Female"}}),ma=Object(vt.jsx)(Ot,{dictionary:{nb:"F\xf8dselsdato",en:"Birth date"}}),pa=Object(vt.jsx)(Ot,{dictionary:{nb:"Land",en:"Country"}}),ha=Object(vt.jsx)(Ot,{dictionary:{nb:"Tilgjengelig",en:"Available"}}),ba=Object(vt.jsx)(Ot,{dictionary:{nb:"igjen",en:"left"}}),fa=function(e){return Object(vt.jsx)(Ot,{dictionary:{nb:"".concat(e.min_tickets," billetter er p\xe5krevd for ").concat(e.ticket.name),en:"".concat(e.min_tickets," tickets are required for ").concat(e.ticket.name)}})},va=Object(vt.jsx)(Ot,{dictionary:{nb:"Fullt",en:"Full"}}),ja=Object(vt.jsx)(Ot,{dictionary:{nb:"Legg til",en:"Add"}}),ga=Object(vt.jsx)(Ot,{dictionary:{nb:"Legg til flere billetter",en:"Add more tickets"}}),Oa=Object(vt.jsx)(Ot,{dictionary:{nb:"Pr\xf8v igjen",en:"Try again"}}),ya=Object(vt.jsx)(Ot,{dictionary:{nb:"Venter p\xe5 vippsbekreftelse",en:"Waiting for vipps confirmation"}}),xa=Object(vt.jsx)(Ot,{dictionary:{nb:"Venter p\xe5 bekreftelse",en:"Waiting for confirmation"}}),ka=Object(vt.jsx)(Ot,{dictionary:{nb:"Betaling feilet",en:"Payment failed"}}),Ca=Object(vt.jsx)(Ot,{dictionary:{nb:"Betaling avbrutt",en:"Payment cancelled"}}),Ta=Object(vt.jsx)(Ot,{dictionary:{nb:"E-post faktura",en:"E-mail invoice"}}),Ea=Object(vt.jsx)(Ot,{dictionary:{nb:"Kortet er ugyldig",en:"Not a valid card"}}),Sa=Object(vt.jsx)(Ot,{dictionary:{nb:"Datoen er ugyldig",en:"Not a valid date"}}),Na=Object(vt.jsx)(Ot,{dictionary:{nb:"Kortbetaling feilet. Noe gikk galt i verifiseringen av kortet.",en:"Payment Failed. Something went wrong when verifying the card"}}),_a=Object(vt.jsx)(Ot,{dictionary:{nb:"Kortbetaling feilet. Noe gikk galt i verifiseringen av kortet.",en:"Card was refused by issuer"}}),Ia=Object(vt.jsx)(Ot,{dictionary:{nb:"Kortnummer",en:"Card number"}}),wa=Object(vt.jsx)(Ot,{dictionary:{nb:"MM/\xc5\xc5",en:"MM/YY"}}),Aa=Object(vt.jsx)(Ot,{dictionary:{nb:"Angre valg",en:"Undo selection"}}),Ra=Object(vt.jsx)(Ot,{dictionary:{nb:"Synlig kun for admin",en:"Only visible for admin"}}),Pa=Object(vt.jsx)(Ot,{dictionary:{nb:"Synlig kun for inviterte",en:"Only visible for invited participants"}}),Da=Object(vt.jsx)(Ot,{dictionary:{nb:"(valgfritt)",en:"(optional)"}}),Ma=Object(vt.jsx)(Ot,{dictionary:{nb:"Ikke fylt ut",en:"Not filled"}}),Fa=Object(vt.jsx)(Ot,{dictionary:{nb:"Deltakerinformasjon",en:"Participant information"}}),La=Object(vt.jsx)(Ot,{dictionary:{nb:"Du ser skjemaet fordi du er logget inn som admin i Checkin",en:"This form is visible because you are logged in as an admin at Checkin"}}),Wa={nb:"https://www.checkin.no/kjopsvilkar",en:"https://www.checkin.no/terms-and-conditions"},qa=Object(vt.jsx)(Ot,{dictionary:{nb:"p\xe5 venteliste",en:"on waiting list"}}),Va=Object(vt.jsx)(Ot,{dictionary:{nb:"P\xe5 venteliste",en:"On waiting list"}}),Ba=Object(vt.jsx)(Ot,{dictionary:{nb:"Noen av valgene dine er ikke tilgjengelige",en:"Some of the choices were not available"}}),Ua=Object(vt.jsx)(Ot,{dictionary:{nb:"Valget kan fortsatt velges, men blir satt p\xe5 venteliste",en:"This item will still be available, but will be put on a waiting list"}}),Ha=Object(vt.jsx)(Ot,{dictionary:{nb:"OK, jeg forst\xe5r",en:"OK, I understand"}}),za=Object(vt.jsx)(Ot,{dictionary:{nb:"Venteliste (Betal senere om valget f\xe5r tildelt plass)",en:"Waiting list (Pay later if item becomes available)"}}),Ka=Object(vt.jsx)(Ot,{dictionary:{nb:"Venteliste",en:"Waiting list"}}),Qa=Object(vt.jsx)(Ot,{dictionary:{nb:"Bestillingen betales ikke f\xf8r billettene p\xe5 venteliste er blitt tildelt",en:"Pay later when tickets have been taken off waiting list"}}),Ga=Object(vt.jsx)(Ot,{dictionary:{nb:"Kunne ikke etablere en kobling til serveren",en:"Could not establish connection to server"}}),$a=Object(vt.jsx)(Ot,{dictionary:{nb:"Pr\xf8ver \xe5 koble til",en:"Trying to connect"}}),Ya=Object(vt.jsx)(Ot,{dictionary:{nb:"Start p\xe5melding",en:"Start registration"}}),Xa=Object(vt.jsx)(Ot,{dictionary:{nb:"Sesjonen er utl\xf8pt",en:"Session expired"}}),Ja=Object(vt.jsx)(Ot,{dictionary:{nb:"Obs. Noe gikk galt. Det kunne ikke opprettes en tilkobling til serveren. Pr\xf8v igjen seinere",en:"Something went wrong. Make sure that there is nothing blocking your connection to the server"}}),Za=Object(vt.jsx)(Ot,{dictionary:{nb:"Venteliste er tilgjengelig",en:"Waiting list is available"}}),ei=Object(vt.jsx)(Ot,{dictionary:{nb:"Velg sete f\xf8r du g\xe5r videre.",en:"Pick seats before proceeding to the next step."}}),ti=Object(vt.jsx)(Ot,{dictionary:{nb:"Unummerert",en:"Unnumbered"}}),ni=Object(vt.jsx)(Ot,{dictionary:{nb:"Faktura blir sendt den",en:"Invoice will be sent"}}),ai={COMPANY_NAME:"company"},ii=function(e){if(e.settings.ticketUserProperties&&e.settings.ticketUserProperties.length>0){var t=function(e){var t=[];return e.forEach((function(e){"NAME"!==e.type&&"TLF"!==e.type&&t.push({key:ai[e.type]?ai[e.type]:e.type.toLowerCase(),required:e.required})})),t}(e.settings.ticketUserProperties),n=e.settings.fields.find((function(e){return"orgnr"===e.key}));return n&&t.push({id:null,key:"orgnr",required:n.required,label:n.label}),t}return e.settings.fields},ri=/^(?:[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-zA-Z0-9-]*[a-zA-Z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/,si=function e(){var t=this;Object(E.a)(this,e),this.name=function(e){return/([^\ ]+)\ ([^\ ]+)/.test(e)?null:{hasError:!0,message:Pn}},this.email=function(e){if(ri.test(e)){var t=e.split(".");return"con"==t[t.length-1].toLowerCase()?{hasError:!0,message:Fn}:null}return{hasError:!0,message:Dn}},this.phone=function(e){var t=e.replace(/(-|\(|\)|\s)/g,"");return/^[+][0-9]+$/.test(t)&&t.length>5?null:{hasError:!0,message:Mn}},this.companyName=function(e){return e.trim().length>0?null:{hasError:!0,message:aa,error:Ln}},this.orgNo=function(e){return e&&e.trim().length>0?null:{hasError:!0,message:aa,error:qn}},this.address=function(e){return e&&e.trim().length>0?null:{hasError:!0,message:aa,error:Vn}},this.zipcode=function(e){return e&&e.trim().length>0?null:{hasError:!0,message:aa,error:Bn}},this.city=function(e){return e&&e.trim().length>0?null:{hasError:!0,message:aa,error:Un}},this.country=function(e){return e?null:{hasError:!0,message:aa,error:Hn}},this.work_title=function(e){return e.trim().length>0?null:{hasError:!0,message:aa}},this.company=function(e){return e.trim().length>0?null:{hasError:!0,message:aa}},this.invoiceEmail=function(e){return ri.test(e)?null:{hasError:!0,message:ra}},this.lengthField=function(e){return e.trim().length>0?null:{hasError:!0,message:aa}},this.born=function(e){return e?Ye(e)?null:{hasError:!0,message:zn}:{hasError:!0,message:aa}},this.sex=function(e){return!e||e!==ye.male&&e!==ye.female?{hasError:!0,message:aa}:null},this.required=function(e){var t={hasError:!0,message:aa};return e&&"string"===typeof e.text?e.text.trim().length>0?null:t:e&&"number"===typeof e.type?e.number>0?null:t:e?null:t},this.validate=function(e,n){return t[e]?t[e](n):(console.error("Property of type ".concat(e," has no validation rule")),null)}},ci=function(e,t,n){var a=t.crm,i=t.fields,r=!0,s=new si,c=["name","email","phone"],o=["address","zipcode","city","country"],d=["address","sex","born"],l={},u=[],m=function(e){l[e]&&l[e].hasError?r=!1:delete l[e]},p=nt().categories.find((function(e){return t.category_id===e.id})),h=p.additionals.filter((function(e){return e.required}));oi(h,t.additionals,c);var b=ii(nt());return b.forEach((function(e){d.includes(e.key)?c.push(e.key):["orgnr","email"].includes(e.key)||u.push(e.key)})),c.forEach((function(e){if("email"===e)(a.email.length||b.map((function(e){return e.key})).includes("email")&&b.find((function(e){return"email"===e.key})).required)&&(l[e]=s.validate(e,a[e]),m(e));else if("address"===e)b.find((function(e){return"address"===e.key})).required&&o.forEach((function(e){l[e]=s.validate(e,a.address[e]),m(e)}));else if(isNaN(e))(!b.find((function(t){return t.key===e}))||b.find((function(t){return t.key===e}))&&b.find((function(t){return t.key===e})).required)&&(l[e]=s.validate(e,a[e]),m(e));else{var n=t.additionals[e]?t.additionals[e]:null;if(!n){var i=h.find((function(t){return t.id===e}));if("multicheckbox"===i.type){var r,c=Object(B.a)(i.children);try{for(c.s();!(r=c.n()).done;){var d=r.value;if(t.additionals[d.id]){n=t.additionals[d.id];break}}}catch(p){c.e(p)}finally{c.f()}}}var u=s.validate("required",n);l[e]=u,m(e)}})),u.forEach((function(e){var t=i[e]?i[e].value:"";if(b.find((function(t){return t.key===e})).required){var n=s.validate(e,t);l[e]=n,m(e)}})),Object.values(t.additionals).forEach((function(e){if("child"===e.type){var n=p.additionals.find((function(t){return t.id===e.parent_id}));if(n.minSelectableChoices)Object.values(t.additionals).filter((function(t){return t.parent_id===e.parent_id})).length<n.minSelectableChoices&&(l[e.id]={hasError:!0,message:Jn(n.minSelectableChoices)})}})),n?l:(e(l,t),r)};function oi(e,t,n){return e.forEach((function(e){e.triggered_by.length?e.triggered_by.some((function(e){var n=Object.keys(t).find((function(n){return t[n].child_id===e})),a=t[e];return n&&(a=t[n]),e===a?a.id:a}))&&n.push(e.id):n.push(e.id)})),n}var di=function(e){if(e)for(var t=e.trim(),n=0;n<t.length;n++)if("0"!==t[n])return!0;return!1},li=n(178),ui=n.n(li);function mi(){var e=[],t=new URLSearchParams(window.location.search);return t&&t.get("pass")&&t.get("category")&&e.push({id:Number(t.get("category")),type:"TICKET",passphrase:t.get("pass")}),{invitations:e,campaignInvites:[]}}var pi=function(e){var t=e.orderInfo,n=t.firstName,a=t.lastName,i=t.formattedPhone,r=t.email,s=t.ticketBuyerAlsoAttending,c=e.users,o=[];return Object.keys(c).forEach((function(e){var t=c[e],d=t.number,l=t.additionals,u=t.ticket,m=t.vat,p=[];Object.values(l).forEach((function(e){var t={id:e.id,number:e.number};p.push(t)}));var h={crm:{first_name:n,last_name:a},vat:m,number:d,category_id:Number(u.id),additionals:p};s&&(h.crm.tlf=Number(i),h.crm.email=r),o.push(h)})),o},hi=function(e){var t=e.orderInfo,n=e.users,a=e.eventType,i=[];return Object.keys(n).forEach((function(e,r){var s=n[e],c=s.fields,o=s.crm,d=s.category_id,l=s.number,u=s.vat,m=(s.onWaiting,s.seat),p=s.checkedSameAs,h=s.id,b=Object(C.a)({},n[e].additionals),f=[];Object.values(b).forEach((function(e){var t={id:e.id,number:e.number};e.child_id&&(t.child_id=e.child_id),e.text&&(t.text=e.text.trim()),f.push(t)}));var v=Object.values(c).map((function(e){return"string"===typeof e.value&&(e.value=e.value.trim()),e})),j=[];document.checkinRegistrationData&&document.checkinRegistrationData.crmPropertyValues&&document.checkinRegistrationData.crmPropertyValues.forEach((function(e){("orderContactParticipant"===e.context&&(p||t.name==="".concat(o.first_name," ").concat(o.last_name))||"participant"===e.context&&e.participantId===h)&&("TICKETS"===a?"orderContactParticipant"===e.context&&0===r&&j.push({key:e.propertyKey,value:e.propertyValue}):j.push({key:e.propertyKey,value:e.propertyValue}))}));var g,O={fields:Object(k.a)(v),propertyValues:j,key:e,crm:{first_name:o.first_name,last_name:o.last_name,tlf:Number(o.formattedPhone),prefix:Number(o.prefix)},vat:u,number:l,category_id:d,additionals:f,seatId:m?Number(m.id):null};o.address&&((g=o.address)&&g.city&&g.address&&g.zipcode&&g.country)&&(O.crm.address={types:"PRIVATE",address:o.address.address.trim(),zip:o.address.zipcode.trim(),city:o.address.city.trim(),country:o.address.country}),o.sex&&(O.crm.sex=o.sex),o.born&&(O.crm.born=ui()(Ye(o.born)).format()),o.email.length>0&&(O.crm.email=o.email),i.push(O)})),i},bi=function(e){var t=[];return Object.values(e).forEach((function(e){var n={id:e.id,number:e.number?e.number:1};e.child_id&&(n.child_id=e.child_id),e.text&&(n.text=e.text.trim()),t.push(n)})),t},fi=function(e){var t=e.trim().split(" ").filter((function(e){return""!==e.trim()})),n=t.pop();return{first_name:t.join(" "),last_name:n}},vi=function(e){var t=[];return Object.values(e).map((function(e){for(var n=0,a=1;a<=e.number;a++){var i=Object(C.a)({},e);e.onWaiting>0&&n<e.onWaiting?(i.onWaiting=!0,n++):i.onWaiting=!1,t.push(i)}return null})),t},ji=function(e,t){var n=e.split("+".concat(t.dialCode));return delete n[0],n.join("").replace(/(-|\(|\)|\s)/g,"")},gi=n(403),Oi=n(30),yi=n.n(Oi),xi=function(e){var t=e.users,n=e.settings,a=e.waitingList,i=n.ticket_fee,r=i.fee,s=i.mode,c=i.free,o=Object.keys(t).filter((function(e){return a?t[e].price*t[e].onWaiting-t[e].discount>0:t[e].price*(t[e].number-t[e].onWaiting)-t[e].discount>0}));if("percent"===s){var d=0;return o.map((function(e){var n=t[e],i=1;i=a?n.onWaiting:n.number-n.onWaiting;var r=Pi(n.prices,n.discount,i).map((function(e){return Object(C.a)(Object(C.a)({},e),{},{price:e.price-e.discount})})),s=Ci(r,!0);return d+=s})),yi.a.chain(d).multiply(r/100).round(2).done()}if("amount"===s){if(c){var l=0;return Object.keys(t).map((function(e){var n=a?t[e].onWaiting:t[e].number-t[e].onWaiting;return l+=yi.a.chain(r).multiply(n).round().done()})),l}var u=0;return o.map((function(e){var n=a?t[e].onWaiting:t[e].number-t[e].onWaiting;return u+=yi.a.chain(r).multiply(n).round().done()})),u}},ki=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Pi(e.prices,e.discount,e.number),a=n.map((function(e){return yi.a.chain(e.discount).multiply(t?1+e.vat/100:1).round(2).done()}));return a&&a.length>0?a.reduce((function(e,t){return yi.a.chain(e).add(t).round(2).done()})):0},Ci=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.map((function(e){return yi.a.chain(e.price).multiply(t?1+e.vat/100:1).round(2).done()}));if(n&&n.length>0)return n.reduce((function(e,t){return e+t}))},Ti=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[];e.seat&&a.push({price:e.seat.price,vat:(null===(t=e.prices)||void 0===t?void 0:t.length)>0?e.seat.vat:0});return e.prices&&e.prices.length>0&&a.push.apply(a,Object(k.a)(e.prices)),a.length>0?Ci(a,n):0},Ei=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return yi.a.chain(Ti(e,t)).multiply(n?e.number:e.number-e.onWaiting).round(2).done()},Si=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;return yi.a.chain(Ti(e,t)).multiply(n).round(2).done()},Ni=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return yi.a.chain(e.price).multiply(t?1+e.vat/100:1).multiply(n?e.onWaiting:e.number-e.onWaiting).round(2).done()},_i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[];a=Ri(Object.values(e),n);var i=Ai(Object.values(t),n),r=yi.a.chain(a.sumVat).add(i.sumVat).round(2).done();return r},Ii=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=[],c=[];s=Ri(Object.values(t),r),c=Ai(Object.values(i),r);var o={sumIncVat:yi.a.chain(s.sumIncVat).add(c.sumIncVat).round(2).done(),sumExVat:yi.a.chain(s.sumExVat).add(c.sumExVat).round(2).done(),sumVat:yi.a.chain(s.sumVat).add(c.sumVat).round(2).done()},d=0;return d=n?o.sumIncVat:o.sumExVat,(d=yi.a.chain(d).add(a?e:0).round(2).done())>0?d:0},wi=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=0,r=0,s=0;return Object.keys(e).forEach((function(t){var s=e[t];if(!s.onWaiting){var c=yi.a.chain(i).add(ki(s,n)).round(2).done();i=c}a||Object.keys(s.additionals).forEach((function(e){var t=s.additionals[e];if(t.price&&t.discount&&Number(t.price)>0&&!t.onWaiting&&!s.onWaiting){var a=yi.a.chain(r).add(t.discount*(n?Number("1.".concat(t.vat)):1)).round(2).done();r=a}}))})),Object.values(t).forEach((function(e){if(e.price&&e.discount&&Number(e.price)>0){var t=yi.a.chain(s).add(e.discount*(n?Number("1.".concat(e.vat)):1)).round(2).done();s=t}})),i+r+s},Ai=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return e.map((function(e){var a=t?e.onWaiting:e.number-e.onWaiting;a&&a>0&&n.push({orderLineId:e.id,belongsToOrderLine:null,price:e.price,vat:e.vat,discount:e.discount,quantity:a})})),Mi(n)},Ri=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.map((function(e){return Di(e,t)}));return n&&n.length>0?{sumIncVat:n.reduce((function(e,t){return Number(e)+Number(t.sumIncVat)}),0),sumExVat:n.reduce((function(e,t){return Number(e)+Number(t.sumExVat)}),0),sumVat:n.reduce((function(e,t){return Number(e)+Number(t.sumVat)}),0)}:{sumIncVat:0,sumExVat:0,sumVat:0}},Pi=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=Object(gi.cloneDeep)(e),i=(a=a.sort((function(e,t){return t.vat-e.vat}))).filter((function(e){return Number(e.price)>0})).map((function(e){return{price:yi.a.chain(e.price).multiply(n).round(2).done(),vat:e.vat}})),r=t;return i.forEach((function(e){r>0?r<e.price?(e.discount=r,r=0):(e.discount=e.price,r-=e.price):e.discount="0"})),i},Di=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],a=t?e.onWaiting:e.number-e.onWaiting;if(a>0){if(e.prices&&e.prices.length>0){var i=Object(gi.cloneDeep)(e.prices).sort((function(e,t){return t.vat-e.vat}));if(e.seat){var r=i.find((function(t){return t.vat===e.seat.vat}));r?r.price=yi.a.chain(r.price).add(Number(e.seat.price)).round(2).done():(i.push({price:e.seat.price,vat:e.seat.vat}),i=i.sort((function(e,t){return t.vat-e.vat})))}var s=Pi(i,e.discount,a);s.forEach((function(t){n.push({orderLineId:e.id,belongsToOrderLine:null,price:Number(t.price),discount:t.discount,vat:t.vat,quantity:1})}))}else e.seat&&n.push({orderLineId:e.id,belongsToOrderLine:null,price:Number(e.seat.price),vat:Number(e.seat.vat),quantity:a});e.discount}return Object.keys(e.additionals).forEach((function(a){var i=e.additionals[a],r=t?e.onWaiting?i.number:i.onWaiting:e.onWaiting?0:i.number-i.onWaiting;r&&r>0&&n.push({orderLineId:i.id,belongsToOrderLine:e.id,price:i.price,vat:i.vat,discount:i.discount,quantity:r})})),Mi(n)};function Mi(e){var t=e.filter((function(e){return e.price<0})),n=0;t.length>0&&(n=-1*t.reduce((function(e,t){return Number(e)+Number(t.price)}),0));var a=0,i=0,r=0;return e.filter((function(e){return e.price>0})).sort((function(e,t){return e.vat>t.vat?-1:0})).forEach((function(e){var t=yi.a.chain(e.price).multiply(e.quantity).round(2).done();if(e.discount&&(t=yi.a.chain(t).subtract(e.discount).done()),n>0){var s=yi.a.chain(e.price).multiply(e.quantity).round(2).done();t=yi.a.chain(t).subtract(Math.min(n,s)).round(2).done(),(n=yi.a.chain(n).subtract(s).round(2).done())<0&&(n=0)}a+=yi.a.chain(t).multiply(1+e.vat/100).round(2).done(),i+=yi.a.chain(t).round(2).done(),r+=yi.a.chain(t).multiply(e.vat/100).round(2).done()})),{sumIncVat:a,sumExVat:i,sumVat:r}}var Fi=function e(t){Object(E.a)(this,e),this.type="TICKET",this.id=null,this.reserved=0,this.requested=0,this.waiting=!0,this.key=0,this.type=t.type,this.id=t.id,this.reserved=t.reserved,this.requested=t.requested,this.waiting=t.waiting,this.key=t.key},Li=n(99),Wi=function(e,t,n,a,i){var r=n.removeAdditionalFromCrm,s=n.saveAdditionalsQuantity,c=n.removeTicket,o=n.additionals,d=n.users,l=n.additionalChangedKey,u=n.ticketAdditionalChangedId;if("default"===n.activeMode){var m=0;if("additional"===a){var p="0"===i,h=Object(C.a)({},o);for(var b in Object.values(d).forEach((function(e){h=Object(C.a)(Object(C.a)({},h),e.additionals)})),h)if(h.hasOwnProperty(b)){var f=h[b];if(m<t)(f.child_id?f.child_id:f.id)===e&&(r(p?null:d[l],f),m++)}}else c(null,null,t,e)}else if("additional"===a){var v=d[n.ticket.ticket.id].ticket.additionals;v[e].number=function(e,t){var n=t.ticket,a=t.users,i=a[n.ticket.id].additionals,r=e.id in i?i[e.id].number:0;return r}(v[e],n)-t,s({target:{value:v[e].number}},v[e],d[u])}else for(var j=0;j<t;j++)Object(Li.isNullOrUndefined)(d[e].ticket)||c(d[e].ticket)},qi=function(){var e=Object(x.a)(y.a.mark((function e(t){var n,a,i,r,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in n=t.itemsToReserve,a=t.resetItemsToReserve,i=t.forceWaitinglist,n)(s=n[r])&&s.type&&window.socketHandler.reserveItem({type:"category"===s.type?"ticket":s.type,id:s.id,number:s.number,waiting:i?me:s.waiting,key:"additional"===s.type?s.key:0});a();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var Vi=n(400),Bi=n.n(Vi),Ui="itemReserve",Hi="itemAvailability",zi=function(){function e(t){var a=this;Object(E.a)(this,e),this.connected=!1,this.socketId=null,this.hasFreedItems=!1,this.socketEventQueue=[],this.completedEvents=[],this.addedEvents={},this.channelTypeEvents={},this.connectedChannels={},this.itemReserveHistory=new Map,this.pusher=n(400),this.token="",this.authorized=!1,this.refreshed=!1,this.init=function(){var e=Object(x.a)(y.a.mark((function e(t,n,i,r,s){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.initializePusher(t,n,i,r,s);case 2:case"end":return e.stop()}}),e)})));return function(t,n,a,i,r){return e.apply(this,arguments)}}(),this.reconnectToServer=function(){a.pusher.connection.runner=null,a.pusher.connection.connect()},this.initializePusher=function(){var e=Object(x.a)(y.a.mark((function e(t,n,i,r,s){var c,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.pusher&&a.pusher.connection&&a.pusher.connection.disconnect(),c="ws.checkin.no",o=443,window.location.href.includes("checkin.local")||window.location.href.includes("localhost")?(window.checkinLocalFrontendDevelopment||document.checkinDevelopmentLocalhost)&&(c="localhost",o=6001):window.location.href.includes("testing.checkin.no")||window.location.href.includes("test-registration.checkin.no")?(c="testing.checkin.no",o=6001):window.location.href.includes("beta.checkin.no")&&(c="beta.checkin.no",o=6001),a.pusher=new Bi.a("checkin",{wsHost:c,wssHost:c,wsPort:o,wssPort:o,forceTLS:"ws.checkin.no"===c,encrypted:"ws.checkin.no"===c,enabledTransports:["ws","wss"]}),e.next=7,a.bindToChannelEvents(t,n,i,r,s);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a,i,r){return e.apply(this,arguments)}}(),this.bindToChannelEvents=function(e,t,n,i,r){return new Promise((function(s,c){a.pusher.connection.bind("state_change",(function(r){i(r),r.current!==se&&(a.authorized=!1,a.pusher.channels.channels={}),r.current!==ie&&r.current!==ae||setTimeout((function(){a.connected||i({previous:"",current:re})}),1e4),r.current===ie&&(a.connected=!1,a.refreshed=!0,a.initializePusher(e,t,n,i))})),a.pusher.connection.bind(re,(function(){i({previous:"",current:re})})),a.pusher.connection.bind(se,(function(o){a.authorized||i({previous:"",current:ce}),a.pusher.send_event("checkin:authorize",a.token),a.connected=!0,a.socketId=o.socket_id,a.pusher.bind("authorizeSuccess",(function(r){i({previous:ce,current:se}),a.authorized||Object.keys(a.connectedChannels).forEach((function(e){var t=a.pusher.subscribe(e);a.connectedChannels[e]=t})),a.authorized=!0,Object.keys(a.channelTypeEvents).forEach((function(e){a.bindChannelTypeEvent(e,a.channelTypeEvents[e].event,a.channelTypeEvents[e].action)})),a.refreshed&&(Object.keys(a.addedEvents).forEach((function(e){a.pusher.bind(e,a.addedEvents[e])})),a.refreshed=!1),a.pusher.bind("itemReserved",(function(t){e(t);var n=a.itemReserveHistory.get("".concat(t.type,"-").concat(t.id));n&&n.responses.push(Object(C.a)({},t))})),a.pusher.bind(Hi,(function(e){t(e)})),a.pusher.bind("itemReservedException",(function(e){n(e)})),a.hasFreedItems||(a.pusher.send_event("checkin:freeItems",{eventId:Number(document.event_id)}),a.hasFreedItems=!0);var c=Je();c.invitations&&(a.pusher.bind("eventInviteSuccess",(function(e){if(a.connectedChannels["".concat(e.type.toLowerCase(),"-").concat(e.id[0])]){var t=a.pusher.subscribe("".concat(e.type.toLowerCase(),"-").concat(e.id[0]));t.subcriptionPending=!1,t.subscribe(),a.connectedChannels["".concat(e.type.toLowerCase(),"-").concat(e.id[0])]=t}})),a.pusher.bind("eventInviteException",(function(e){console.error("Something went wrong")})),a.pusher.send_event("checkin:VerifyEventInvite",{type:"ticket",inviteId:c.invitations[0].id,invitePassphrase:c.invitations[0].passphrase,eventId:c.id})),s()})),a.pusher.bind("sessionExpiredException",r),a.pusher.bind("keepRegistrationAliveException",r),a.pusher.bind("authorizeException",(function(e){c()}))}))}))},this.bindEvent=function(e,t){a.addedEvents[e]=t,a.pusher.bind(e,t)},this.sendEvent=function(e,t,n){a.pusher.send_event(e,t,n)},this.disconnect=function(){a.pusher.disconnect()},this.keepRegistrationAlive=function(){a.pusher.send_event("checkin:keepRegistrationAlive",{eventId:Number(document.event_id)})},this.addToSocketEventQueue=function(e){a.socketEventQueue.push({completed:!1,type:e.type,identifier:e.identifier,queueNumber:a.socketEventQueue.length+1})},this.token=t}return Object(S.a)(e,[{key:"findOrCreate",value:function(e){if(this.authorized){if(!this.connectedChannels[e]){var t=this.pusher.subscribe(e);this.connectedChannels[e]=t}return this.connectedChannels[e]}return null}},{key:"bindChannelTypeEvent",value:function(e,t,n){var a=this;this.channelTypeEvents[e]={event:t,action:n},Object.keys(this.connectedChannels).forEach((function(i){i.includes(e)&&a.connectedChannels[i].bind(t,n)}))}},{key:"bindChannelEvent",value:function(e,t,n){this.connectedChannels[e]?this.connectedChannels[e].bind(t,n):console.error("Channel does not exist")}},{key:"reserveItem",value:function(e){this.pusher.send_event("checkin:".concat(Ui),e,"".concat(e.type,"-").concat(e.id));var t=this.itemReserveHistory.get("".concat(e.type,"-").concat(e.id));t?t.events.push(Object(C.a)({},e)):this.itemReserveHistory.set("".concat(e.type,"-").concat(e.id),{events:[Object(C.a)({},e)],responses:[]}),this.addToSocketEventQueue({type:Ui,identifier:e.id})}},{key:"freeItems",value:function(){this.pusher.send_event("checkin:freeItems",{eventId:Number(document.event_id)})}},{key:"eventCompleted",value:function(e){for(var t=this.socketEventQueue.length,n=0;n<t;n++){var a=this.socketEventQueue[n];a.identifier===e&&(a.completed=!0)}}},{key:"isQueueComplete",value:function(e){for(var t=this.socketEventQueue.filter((function(t){return t.type===e})),n=0;n<t.length;n++){if(!t[n].completed)return!1}return!0}}]),e}(),Ki=function e(){Object(E.a)(this,e)};Ki.props={event:{settings:{discounts:[]}}},Ki.getInitialState=function(){var e;return{allTicketsAreFree:!1,eventIsFree:!1,itemsAvailabilityData:{},showDebugger:!1,coupon:{code:"",addedCoupon:!1,loading:!1,error:{}},notEnoughItemsModal:{isOpen:!1,hasBeenOpen:!1,allowWaitingList:!1,itemReserved:{},noTicketsLeft:!1},reservedEventHappened:!1,seats:[],hasLockedTicketForm:!1,countryByIP:"",eventCountry:"NO",users:{},errors:{},showVat:!1,settings:{},totalQuantity:0,sumTicketFee:0,sumTicketFeeWaiting:0,holdBackInvoice:!1,forceWaitinglist:!1,orderHasWaitingItems:!1,userIsWaiting:!1,customerId:0,convertedAdditionals:{},additionals:{},checkedSameAsTickets:[],userIsPassive:!1,reservationTimer:{didReserve:!1,timerStart:0},initializedUsers:!1,components:(e={},Object(T.a)(e,he,{isTouched:!1,expanded:!0}),Object(T.a)(e,be,{isTouched:!1,expanded:!1}),Object(T.a)(e,Oe,{isTouched:!1,expanded:!1}),Object(T.a)(e,fe,{isTouched:!1,expanded:!1}),Object(T.a)(e,ve,{isTouched:!1,expanded:!0}),Object(T.a)(e,je,{isTouched:!1,expanded:!1}),Object(T.a)(e,ge,{isTouched:!1,expanded:!1}),e),orderInfo:{name:"",firstName:"",lastName:"",email:"",countryCode:"",dialCode:"",phone:"",formattedPhone:"",address:"",zipcode:"",city:"",payer:J,companyName:"",orgNo:"",reference:"",ticketBuyerAlsoAttending:!1,companyCountry:"NO",fromCountry:"NO"},validOrgNo:!1,timerStart:0,didReserve:!1,didReserveAdditional:!1,temporaryCategories:[],temporaryAdditionals:[],additionalChangedKey:0,ticketAdditionalChangedId:0,paymentSuccessful:!1,websocketConnectionState:{current:se,previous:ce},paymentInfo:{invoiceEmail:"",paymentOption:G},showErrors:!1,touchedAdditionalCheckboxes:[],eventIsActive:!0,itemsReserved:[],itemsToReserve:[],waitingAdditionals:{},itemReserveQueueComplete:!0,expired:!1,hasAvailability:!1}},Ki.state=Ki.getInitialState(),Ki.orderProcessor=function(e){var t=Ki;e&&(t=e);var n=t.props.event.settings.discounts,a=t.state,i=a.coupon,r=a.users,s=a.additionals,c={coupon:Object(C.a)({},i),users:Object(C.a)({},r),additionals:Object(C.a)({},s)},o=0,d={};Object.keys(c.users).forEach((function(e){var t=c.users[e],n={category_id:t.ticket.id,tickets:0,price:0,additionals:0,sum:0},a=t.ticket,i=yi.a.chain(t.number).multiply(t.price).done();if(o+=t.number,n.price=i,a.discount&&(c.users[e].discount=0,i,i,n.tickets+=t.number,n.sum=yi.a.chain(n.sum).add(t.number).multiply(yi.a.chain(t.price).add(t.seat?Number(t.seat.price):0).round(2).done(2)).done()),"object"===typeof t.additionals){var r=a.additionals;Object.keys(t.additionals).forEach((function(e){var a=t.additionals[e],i=e;"child"===a.type&&(i=a.parent_id);var s=r[i];if("select"!==s.type&&"text"!==s.type&&("radio"!==s.type||null!=a.child_id)&&("radio"===s.type&&(s=s.children[a.child_id]),s.discount)){var c=yi.a.chain(a.price).multiply(a.number).done();c,n.additionals+=c,n.sum+=c}}))}d[e]=n}));var l=function(e,n){var a=0,i=(e.times_total?e.times_total:1e6)-(e.times_used?e.times_used:0),r=function(t){return Object.keys(t).forEach((function(n){var i=t[n];e.categories.length>0&&e.categories.indexOf(Number(i.category_id))<0?delete t[n]:a+=e.category_only?Number(i.price):Number(i.sum)})),t}(Object(C.a)({},d));"total"!==e.affects||e.category_only||"object"===typeof c.additionals&&Object.keys(c.additionals).forEach((function(e){var n=c.additionals[e],i=t.state.convertedAdditionals[e];if("select"!==i.type&&"text"!==i.type&&("radio"!==i.type||null!=c.additionals[e].child_id)&&("radio"===i.type&&(i=i.children[n.child_id]),c.additionals[e].discount=0,i.discount)){var r=yi.a.chain(n.price).multiply(n.number).done();a+=r}}));var s=new Date(e.start).getTime(),l=new Date(e.stop).getTime(),u=(new Date).getTime(),m=!((null===e.start||s<u)&&(null===e.stop||l>u)),p=!("coupon"===e.trigger&&e.trigger_value.toUpperCase()===c.coupon.code.toUpperCase()||"tickets"===e.trigger&&e.trigger_value<=o||"mode"===e.trigger&&(e.trigger_value===t.props.apolloState.activeMode||1===t.state.totalQuantity&&e.trigger_value===z)||"sum"===e.trigger&&e.trigger_value<=a);if(m||!(0===e.modes.length||e.modes.includes(t.props.apolloState.activeMode)||1===t.state.totalQuantity&&e.modes.includes(z))||p)return 0;var h=function(t){var n=e.value;return"max"===e.type&&t>n?t-n:"amount"===e.type?t-Math.max(0,t-n):"percent"===e.type?yi.a.chain(t).multiply(n/100).round(2).done():0},b=function(e,t,n,a){var r=0,s=t,c=yi.a.chain(e.price).add(e.seat?Number(e.seat.price):0).multiply(n).done();return!a.category_only&&i>0&&("percent"===a.type||s>c)&&Object.keys(e.additionals).forEach((function(t){var n,i=e.additionals[t],c=null!==(n=e.ticket.additionals[i.id])&&void 0!==n?n:e.ticket.additionals[t];if("radio"===c.type&&(c=c.children[i.child_id]),s>0&&c.discount){var o=yi.a.chain(i.price).multiply(i.number).done(),d="percent"===a.type?yi.a.chain(o).multiply(a.value/100).done():Math.min(o,s);e.additionals[t].discount=d,r+=d,s-=d}})),e.discount="percent"===a.type?yi.a.chain(c).multiply(a.value/100).done():Math.min(c,s),r+=e.discount},f=0,v=e.affects_value;if("total"===e.affects){if(f=h(a),!n){var j=f;Object.keys(r).forEach((function(t){if(!(i<=0)){var n=r[t];j-=b(c.users[t],j,Math.min(i,n.tickets),e),i-=Math.min(i,n.tickets)}})),e.category_only||"object"!==typeof c.additionals||Object.keys(c.additionals).forEach((function(e){var t=c.additionals[e];j>0&&"discount"in t&&(t.discount=Math.min(yi.a.chain(t.price).multiply(t.number).done(),j),c.additionals[e].discount=t.discount,j-=t.discount)}))}}else if("every"===e.affects){var g=0;Object.keys(r).forEach((function(t){for(var a=r[t],s=0,o=0,d=0;d<a.tickets;d++)++g%v===0&&i>0&&(s+=h(yi.a.chain(e.category_only?a.price:a.sum).divide(a.tickets).done()),o++,i--);f+=s,n||b(c.users[t],s,o,e)}))}else if("first"===e.affects){var O=0;Object.keys(r).forEach((function(t){for(var a=r[t],s=0,o=0,d=v-O,l=0;l<Math.min(d,i,a.tickets);l++)s+=h(yi.a.chain(e.category_only?a.price:a.sum).divide(a.tickets).done()),o++,i--,O++;f+=s,n||b(c.users[t],s,o,e)}))}else if("from"===e.affects){var y=0;Object.keys(r).forEach((function(t){for(var a=r[t],s=0,o=0,d=0;d<a.tickets;d++)++y>=v&&i>0&&(s+=h(yi.a.chain(e.category_only?a.price:a.sum).divide(a.tickets).done()),o++,i--);f+=s,n||b(c.users[t],s,o,e)}))}return f},u=null,m=0;return n.forEach((function(e){var t=l(e,!0);if(t>m){m=t,u=e;var n=Object(C.a)({},e);n.category_only=!0,l(n,!0)}})),m>0&&"object"===typeof u&&l(u,!1),c};var Qi,Gi,$i=n(106),Yi=["step"];!function(e){e.CHOOSE_TICKETS="CHOOSE_TICKETS",e.ORDER_CONTACT="ORDER_CONTACT",e.PARTICIPANT_INFORMATION="PARTICIPANT_INFORMATION",e.SEATMAP="SEATMAP",e.ORDER_ADDITIONALS="ORDER_ADDITIONALS",e.CHECKOUT="CHECKOUT"}(Qi||(Qi={})),function(e){e.REGISTRATION_STARTED="registration-started",e.CHOOSE_TICKETS_STEP_VISITED="step-visited-choose-tickets",e.CHOOSE_TICKETS_STEP_COMPLETED="step-completed-choose-tickets",e.ORDER_CONTACT_STEP_VISITED="step-visited-order-contact",e.ORDER_CONTACT_STEP_COMPLETED="step-completed-order-contact",e.PARTICIPANT_INFORMATION_STEP_VISITED="step-visited-participant-information",e.PARTICIPANT_INFORMATION_STEP_COMPLETED="step-completed-participant-information",e.ORDER_ADDITIONALS_STEP_VISITED="step-visited-order-additional",e.ORDER_ADDITIONALS_STEP_COMPLETED="step-completed-order-additional",e.SEATMAP_STEP_VISITED="step-visited-seatmap",e.SEATMAP_STEP_COMPLETED="step-completed-seatmap",e.CHECKOUT_STEP_VISITED="step-visited-checkout",e.CHECKOUT_INITIATED="checkout-initiated",e.REGISTRATION_COMPLETED="registration-completed",e.PROGRESS="progress",e.ADD_TO_CART="add-to-cart"}(Gi||(Gi={}));var Xi=[Gi.REGISTRATION_STARTED,Gi.ADD_TO_CART,Gi.CHOOSE_TICKETS_STEP_VISITED,Gi.CHOOSE_TICKETS_STEP_COMPLETED,Gi.ORDER_CONTACT_STEP_VISITED,Gi.ORDER_CONTACT_STEP_COMPLETED,Gi.PARTICIPANT_INFORMATION_STEP_VISITED,Gi.PARTICIPANT_INFORMATION_STEP_COMPLETED,Gi.ORDER_ADDITIONALS_STEP_VISITED,Gi.ORDER_ADDITIONALS_STEP_COMPLETED,Gi.CHECKOUT_STEP_VISITED,Gi.CHECKOUT_INITIATED,Gi.REGISTRATION_COMPLETED],Ji={"step-visited":[Gi.CHOOSE_TICKETS_STEP_VISITED,Gi.ORDER_CONTACT_STEP_VISITED,Gi.PARTICIPANT_INFORMATION_STEP_VISITED,Gi.SEATMAP_STEP_VISITED,Gi.ORDER_ADDITIONALS_STEP_VISITED,Gi.CHECKOUT_STEP_VISITED],"step-completed":[Gi.CHOOSE_TICKETS_STEP_COMPLETED,Gi.ORDER_CONTACT_STEP_COMPLETED,Gi.PARTICIPANT_INFORMATION_STEP_COMPLETED,Gi.SEATMAP_STEP_COMPLETED,Gi.ORDER_ADDITIONALS_STEP_COMPLETED],"registration-started":[Gi.REGISTRATION_STARTED],"registration-completed":[Gi.REGISTRATION_COMPLETED],"checkout-initiated":[Gi.CHECKOUT_INITIATED],cart:[Gi.ADD_TO_CART]},Zi=new function e(){var t=this;Object(E.a)(this,e),this.listeners={},this.eventHistory=[],this.subscribeTo=function(e,n){t.listeners[e]?t.listeners[e].push({event:e,callback:n}):t.listeners[e]=[{event:e,callback:n}]},this.removeEventListener=function(e,n){t.listeners[e]&&(t.listeners[e]=t.listeners[e].filter((function(t){return t.event===e&&t.callback===n})))},this.dispatchEvent=function(e,n){var a;if((!Xi.includes(e)||!t.eventHistory.includes(e))&&(t.eventHistory.push(e),null===(a=t.listeners[e])||void 0===a||a.forEach((function(t){t.event===e&&t.callback({event:e,data:Object(C.a)(Object(C.a)({},n.data),{},{timestamp:(new Date).toISOString(),checkin_event_id:document.event_id,checkin_event_name:document.checkin_event_name})})})),e===Gi.PROGRESS&&n.data.step)){var i=n.data,r=i.step,s=Object($i.a)(i,Yi);t.dispatchEvent(r,{data:Object(C.a)(Object(C.a)({},s),{},{timestamp:(new Date).toISOString(),checkin_event_id:document.event_id,checkin_event_name:document.checkin_event_name})})}},this.reset=function(){t.listeners={},t.eventHistory=[]}},er=function(){function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shouldInitialize:!0};Object(E.a)(this,e),this.name="google",this.active=!0,this.shouldInitialize=!0,this.GTM="",this.config={},this.usingDataLayer=!1,this.eventTypes=["step-visited","step-completed","registration-started","registration-completed","checkout-initiated"],this.eventSubscriptions=[],this.initialize=function(){},this.processEvent=function(e,t,a){n.usingDataLayer?void 0!==a&&a.length>0?("ecommerce"===a&&window.dataLayer.push({ecommerce:null}),window.dataLayer.push(Object(T.a)({event:e},a,Object(C.a)({},t)))):window.dataLayer.push({event:e,eventRegistration:Object(C.a)({},t)}):window.gtag("event",e,t)},this.purchaseEvent=function(e){n.processEvent("purchase",n.getEcommerceData(e.orderData),"ecommerce")},this.beginCheckoutEvent=function(e){n.processEvent("begin_checkout",n.getEcommerceData(e.orderData),"ecommerce")},this.addToCart=function(e){n.processEvent("add_to_cart",{items:e.items.map((function(e){return{item_id:e.id.toString(),item_name:e.name,price:e.price?Number(e.price):0,quantity:1}}))},"ecommerce")},this.getEcommerceData=function(e){return{currency:"NOK",value:e.sum,coupon:e.coupon,items:Object(k.a)(e.items.map((function(e){return{item_id:e.id.toString(),item_name:e.name,price:e.price,currency:"NOK",discount:e.discount,quantity:e.quantity,item_variant:e.type}})))}},this.GTM=null!==t&&void 0!==t?t:"",void 0!==a.shouldInitialize&&(this.shouldInitialize=a.shouldInitialize),(null===a||void 0===a?void 0:a.eventTypes)&&(this.eventTypes=a.eventTypes),window.gtag||window.dataLayer?this.shouldInitialize=!1:window.gtag||window.dataLayer||a.shouldInitialize||(this.active=!1),window.gtag?this.usingDataLayer=!1:window.dataLayer&&(this.usingDataLayer=!0),this.processEvents=this.processEvents.bind(this)}return Object(S.a)(e,[{key:"processEvents",value:function(e){switch(e.event){case Gi.CHECKOUT_INITIATED:this.beginCheckoutEvent(e.data);break;case Gi.REGISTRATION_COMPLETED:this.purchaseEvent(e.data);break;case Gi.ADD_TO_CART:this.addToCart(e.data);break;default:this.processEvent(e.event,e.data)}}}]),e}(),tr=function(){function e(t){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shouldInitialize:!0};Object(E.a)(this,e),this.name="meta",this.active=!0,this.shouldInitialize=!0,this.pixel=void 0,this.eventTypes=["step-visited","step-completed","registration-started","registration-completed","checkout-initiated"],this.eventSubscriptions=[],this.config={shouldInitialize:!0},this.initialize=function(){},this.purchaseEvent=function(e){window.fbq("track","Purchase",n.getEcommerceData(e.orderData))},this.addToCart=function(e){window.fbq("track","AddToCart",{content_name:"Ticket",content_type:"Product",contents:e.items.map((function(e){return{id:e.id,name:e.name,quantity:1}})),currency:"NOK",value:e.items[0].price?Number(e.items[0].price):0})},this.completeRegistration=function(e){window.fbq("track","CompleteRegistration",{content_name:e.orderData.eventName,currency:"NOK",value:e.orderData.sum})},this.beginCheckoutEvent=function(e){var t=n.getEcommerceData(e.orderData),a=t.content_ids,i=t.contents,r=t.currency,s=t.value;window.fbq("track","InitiateCheckout",{content_ids:a,contents:i,currency:r,value:s,content_category:"Checkin Event Registration",num_items:a.length})},this.getEcommerceData=function(e){return{content_name:e.eventName,content_type:"product",currency:"NOK",value:e.sum,content_ids:e.items.map((function(e){return e.id})),contents:e.items.map((function(e){return{id:e.id,name:e.name,quantity:e.quantity}}))}},a&&(this.config=Object(C.a)(Object(C.a)({},this.config),a)),this.pixel=t,void 0!==a.shouldInitialize&&(this.shouldInitialize=a.shouldInitialize),(null===a||void 0===a?void 0:a.eventTypes)&&(this.eventTypes=a.eventTypes),window.fbq||(this.active=!1),this.processEvents=this.processEvents.bind(this)}return Object(S.a)(e,[{key:"processEvents",value:function(e){switch(e.event){case Gi.CHECKOUT_INITIATED:this.beginCheckoutEvent(e.data);break;case Gi.REGISTRATION_COMPLETED:this.purchaseEvent(e.data);break;case Gi.ADD_TO_CART:this.addToCart(e.data);break;default:window.fbq("trackCustom",e.event,e.data)}}}]),e}();var nr=function(){function e(t){var n,a=this;(Object(E.a)(this,e),this.providers=[],this.addAnalyticsProvider=function(e){e.active&&(e.shouldInitialize&&e.initialize(),(e.eventSubscriptions.length>0?e.eventSubscriptions:function(e){var t=[];return e.forEach((function(e){t.push.apply(t,Object(k.a)(Ji[e]))})),t}(e.eventTypes)).forEach((function(t){Zi.subscribeTo(t,e.processEvents)})))},t)&&((n=this.providers).push.apply(n,Object(k.a)(t)),this.providers.forEach((function(e){e.active&&a.addAnalyticsProvider(e)})))}return Object(S.a)(e,[{key:"activeProviders",get:function(){return this.providers.filter((function(e){return e.active}))}}]),e}();function ar(e){var t,n,a=["registration-started","step-visited","step-completed","registration-completed","checkout-initiated","cart"],i=[];return(null===(t=e.meta)||void 0===t?void 0:t.isActive)&&i.push(new tr("",{shouldInitialize:!1,eventTypes:a})),(null===(n=e.google)||void 0===n?void 0:n.isActive)&&i.push(new er("",{shouldInitialize:!1,eventTypes:a})),new nr(i)}var ir=n(550);function rr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&t!==H||e.current&&Object(ir.a)(e.current,{scrollMode:"always",block:"start",inline:"center"})}var sr,cr,or=n(46),dr=or.a.span(sr||(sr=Object(Ee.a)(["\n  visibility: hidden;\n  width: 120px;\n  background-color: #555;\n  color: #fff;\n  text-align: center;\n  border-radius: 6px;\n  padding: 5px 0;\n  position: absolute;\n  left: 100%;\n  opacity: 0;\n  transition: opacity 0.3s;\n  margin-left: 10px;\n  &:after {\n    content: '';\n    position: absolute;\n    top: 0%;\n    left: 0%;\n    margin-left: -10px;\n    border: 15px solid;\n    border-color: #555 transparent transparent transparent;\n  }\n"]))),lr=(or.a.div(cr||(cr=Object(Ee.a)(["\n  position: relative;\n  font-size: 1em;\n  margin: 1em 0;\n  cursor: pointer;\n  position: fixed;\n  bottom: 30px;\n  left: 20px;\n  display: grid;\n  button {\n    padding: 3px !important;\n    > div {\n      font-size: 30px;\n    }\n    margin: 5px 0;\n    padding: 10px;\n    color: #fff;\n    cursor: pointer;\n    &:hover {\n      "," {\n        opacity: 1;\n        visibility: visible;\n      }\n    }\n    &:first-child {\n      background: #2cc843 !important;\n    }\n    &:nth-child(2) {\n      border: 1px solid #cecece !important;\n      background: #0099d8 !important;\n    }\n    &:nth-child(3) {\n      border: 1px solid #cecece !important;\n      color: #000;\n      background: rgb(253, 251, 131) !important;\n    }\n    &:nth-child(4) {\n      border: 1px solid #cecece !important;\n      color: #fff;\n      background: #f99b1c !important;\n    }\n    &:last-child {\n      background: rgb(248, 70, 70) !important;\n    }\n  }\n"])),dr),n(41)),ur=n.n(lr),mr=function(e){return function(t){return function(n){var a=Object(b.useContext)(ls);return Object(vt.jsx)(t,Object(C.a)(Object(C.a)({},n),e(a)))}}},pr=f.a.forwardRef((function(e,t){return"checkbox"===e.type?Object(vt.jsxs)("div",{role:e.type,"aria-checked":e.checked,onClick:e.onClick||e.onChange,children:[Object(vt.jsx)("input",Object(C.a)(Object(C.a)({},e),{},{ref:t})),Object(vt.jsx)("span",{className:"input-frame checkbox-frame ".concat(e.checked?"checkbox-checked":"")})]}):"radio"===e.type?Object(vt.jsxs)("div",{role:e.type,"aria-checked":e.checked,onClick:e.disabled?function(){}:e.onClick||e.onChange,children:[Object(vt.jsx)("input",Object(C.a)(Object(C.a)({},e),{},{ref:t})),Object(vt.jsx)("span",{className:"input-frame radio-frame ".concat(e.checked?"radio-checked":"")})]}):Object(vt.jsx)("input",Object(C.a)(Object(C.a)({},e),{},{ref:t}))}));pr.defaultProps={required:!1,className:"",type:"text",value:"",onChange:function(){}};var hr=pr,br=["labelName","white","large","medium","mediumLarge","required","srOnly"],fr=function(e){var t=e.labelName,n=e.white,a=e.large,i=e.medium,r=e.mediumLarge,s=e.required,c=e.srOnly,o=Object($i.a)(e,br),d=["label"];return n&&d.push("label--white"),a&&d.push("label--large"),r&&d.push("label--medium large"),i&&d.push("label--medium"),s&&d.push("label--required"),c&&d.push("sr-only"),Object(vt.jsxs)("label",Object(C.a)(Object(C.a)({className:d.join(" ")},o),{},{children:[t," ",!s&&Object(vt.jsx)("span",{className:"optional",children:Da})]}))},vr=function(e,t){return e&&e.hasError?Object(vt.jsx)("span",{role:"alert",id:t,className:"errorMessageBlock",children:e.message}):""},jr=function(e){return e&&e.hasError?"form-control errorInput":"form-control"},gr=function(e){return e&&e.hasError},Or={scale:[1.2,1],transition:{duration:.3}},yr=n(143),xr=f.a.memo((function(e){e.left;var t=e.additional,n=e.displayAdditionalAvailability,a=Object(yr.b)();return Object(b.useEffect)((function(){a.start(Or)})),Object(vt.jsxs)(yr.a.div,{animate:a,children:[n(t)," "]})})),kr=f.a.memo((function(e){var t=e.onWaiting,n=e.additionalType,a=Object(yr.b)();return Object(b.useEffect)((function(){a.start(Or)})),Object(vt.jsx)(yr.a.div,{animate:a,children:Object(vt.jsx)("p",{className:"availableTickets additional ml20 error",style:{fontWeight:600},children:"number"===n?Object(vt.jsxs)(vt.Fragment,{children:[t," ",qa]}):Va})})})),Cr=function(e,t){var n=t.id||t.key;return e?"".concat(e.id,"-").concat(n):"".concat(n)},Tr=function(e){var t=e.saveAdditionalToCrm,n=e.setAdditionalChangedKey,a=e.setTicketAdditionalChangedId,i=e.setDidReserveAdditional,r=e.setTimerStart,s=e.removeAdditionalFromCrm,c=(e.temporaryAdditionals,e.ticket),o=e.additional,d=e.users,l=e.showVat,u=e.showErrors,m=e.stateAdditionals,p=e.orderErrors,h=e.saveTouchedAdditionalCheckboxes,f=e.touchedAdditionalCheckboxes,v=e.getUserTranslatedText,j=e.displayAdditionalAvailability,g=function(){if(o.waiting_list)return!1;var e=!c?m:d[c.id].additionals;return!!(null!==o.left&&o.left<=0&&Object(Li.isNullOrUndefined)(e[o.id]))},O=function(){return c?!!d[c.id].additionals[o.id]:!!m[o.id]},k=function(){g()||O()?s(c,o):(0===o.left?t(c,o,null,!0):t(c,o),c&&(n(c.id),a(c.category_id)),i(!1),r(Date.now()))},C=c?c.additionals:m,T=Cr(c,o);Object(b.useEffect)((function(){function e(){return(e=Object(x.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.checked||void 0!==C[o.id]){e.next=4;break}return e.next=3,h(T);case 3:f.includes(T)||setTimeout((function(){k()}),300);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var E=c?c.errors[o.id]:p[o.id];return Object(vt.jsxs)("div",{className:"singleTicket--additional mb20 p10 ".concat(gr(E)&&u?"errorBackground":""),children:[Object(vt.jsxs)("div",{className:"df jcsb aib",children:[Object(vt.jsx)(hr,{className:o.type,name:"additional",checked:O(),disabled:g(),type:o.type,id:T,onChange:k}),Object(vt.jsxs)("div",{className:"df aib w100p jcsb",children:[Object(vt.jsx)(fr,{medium:!0,labelName:v(o,"name"),htmlFor:T,required:o.required}),Object(vt.jsx)("div",{className:"".concat(0!==+o.price&&"price"," ml20"),children:o.price_ex_vat&&0!==+o.price?Object(vt.jsx)(ur.a,{value:$e(l,o),displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}}):null})]})]}),Object(vt.jsxs)("div",{className:"df aib ".concat(o.description?"jcsb":"jcfe"),children:[o.description&&Object(vt.jsx)("div",{className:"singleTicket--additional--description checkboxAndRadio",dangerouslySetInnerHTML:{__html:v(o,"description")}}),ot(c,o,d,m)?Object(vt.jsx)(kr,{onWaiting:1}):Object(vt.jsx)(xr,{left:o.left,additional:o,displayAdditionalAvailability:j})]}),vr(E)]})},Er=mr((function(e){return{removeAdditionalFromCrm:e.funcs.removeAdditionalFromCrm,saveAdditionalToCrm:e.funcs.saveAdditionalToCrm,showVat:e.showVat,temporaryAdditionals:e.temporaryAdditionals,setDidReserveAdditional:e.funcs.setDidReserveAdditional,setTimerStart:e.funcs.setTimerStart,setAdditionalChangedKey:e.funcs.setAdditionalChangedKey,setTicketAdditionalChangedId:e.funcs.setTicketAdditionalChangedId,users:e.users,showErrors:e.showErrors,stateAdditionals:e.additionals,orderErrors:e.errors,saveTouchedAdditionalCheckboxes:e.funcs.saveTouchedAdditionalCheckboxes,touchedAdditionalCheckboxes:e.touchedAdditionalCheckboxes,displayAdditionalAvailability:e.funcs.displayAdditionalAvailability,getUserTranslatedText:function(t,n){return pt(t,n,e.language)}}}))(Object(b.memo)(Tr)),Sr=function(e){var t=e.ticket,n=e.additional,a=e.saveAdditionalTextToCrm,i=e.handleCrmValidation,r=e.removeAdditionalFromCrm,s=e.showErrors,c=e.stateAdditionals,o=e.orderErrors,d=e.getUserTranslatedText,l=Cr(t,n),u=t?t.errors[n.id]:o[n.id],m=gr(u)&&s,p=t?t.additionals[n.id]:c[n.id];return Object(vt.jsxs)("div",{className:"singleTicket--additional mb30 p10 ".concat(m?"errorBackground":""),children:[Object(vt.jsx)(fr,{htmlFor:l,labelName:d(n,"name"),medium:!0,required:n.required}),n.description&&Object(vt.jsx)("div",{className:"singleTicket--additional--description",dangerouslySetInnerHTML:{__html:d(n,"description")}}),Object(vt.jsx)(hr,{id:l,className:"".concat(jr(u)),value:p?p.text:"",type:"text",required:n.required,"aria-required":n.required,"aria-invalid":m,"aria-describedby":m?"".concat(l,"-err"):null,name:n.id.toString(),onChange:function(e){e.target.value.match(/[<>]/)||a(t,n,e.target.value)},onBlur:function(e){n.required?i(e,t,n):""===e.target.value&&r(t,n)}}),vr(u,"".concat(l,"-err"))]})},Nr=mr((function(e){return{saveAdditionalTextToCrm:e.funcs.saveAdditionalTextToCrm,handleCrmValidation:e.funcs.handleCrmValidation,removeAdditionalFromCrm:e.funcs.removeAdditionalFromCrm,showErrors:e.showErrors,stateAdditionals:e.additionals,orderErrors:e.errors,getUserTranslatedText:function(t,n){return pt(t,n,e.language)}}}))(Object(b.memo)(Sr)),_r=function(e){var t=e.ticket,n=e.additional,a=e.showVat,i=e.users,r=e.saveAdditionalToCrm,s=e.removeAdditionalFromCrm,c=e.setDidReserveAdditional,o=e.setTimerStart,d=e.setAdditionalChangedKey,l=e.setTicketAdditionalChangedId,u=e.showErrors,m=e.stateAdditionals,p=e.orderErrors,h=e.orderAdditionals,b=e.getUserTranslatedText,f=e.displayAdditionalAvailability,v=e.itemsAvailabilityData,j=function(e,n){var a=v[e.id]?v[e.id].left:e.left,r=!t?m:i[t.id].additionals;return!e.waiting_list&&(null!==e.available&&!(e&&!(null!==a&&a<=0&&Object(Li.isNullOrUndefined)(r[e.id]))))},g=function(e){var a=t?i[t.id].additionals[n.id]:m[n.id];return!(!a||a.child_id!==e.id)},O=Cr(t,n),y=t?t.errors[n.id]:p[n.id],x=t?t.additionals[n.id]:m[n.id];return Object(vt.jsxs)("div",{role:"radiogroup",className:"mb30 p10 prelative ".concat(gr(y)&&u?"errorBackground":""),children:[Object(vt.jsxs)("div",{className:"mb10",children:[Object(vt.jsxs)("div",{className:"df jcsb",children:[Object(vt.jsx)(fr,{labelName:b(n,"name"),mediumLarge:!0,required:n.required}),x&&Object(vt.jsx)("div",{children:Object(vt.jsx)("button",{type:"button",onClick:function(){s(t,n)},className:"btn-remove-radio",children:Aa})})]}),n.description&&Object(vt.jsx)("div",{className:"singleTicket--additional--radioDescription w80p mt10",dangerouslySetInnerHTML:{__html:b(n,"description")}})]}),(t?rt(n,t)?rt(n,t).children:[]:h.find((function(e){return e.id===n.id}))?h.find((function(e){return e.id===n.id})).children:[]).map((function(e){var s="".concat(O,"-").concat(e.id);Object(C.a)(Object(C.a)({},e),{},{parent_id:n.id});return Object(vt.jsxs)("div",{className:"singleTicket--additional",children:[Object(vt.jsxs)("div",{className:"df aic jcsb",children:[Object(vt.jsx)(hr,{className:"checkbox",name:O,checked:g(e),value:e.id,type:"radio",disabled:j(e),id:s,onChange:function(){return function(e){r(t,n,e),t&&(d(t.id),l(t.category_id)),c(!1),o(Date.now())}(e)}}),Object(vt.jsxs)("div",{className:"df aib w100p jcsb",children:[Object(vt.jsx)(fr,{medium:!0,labelName:b(e,"name"),htmlFor:s,required:"not required"}),Object(vt.jsx)("div",{className:"".concat(0!==+e.price&&"price"," ml20"),children:e.price_ex_vat&&0!==+e.price?Object(vt.jsx)(ur.a,{value:$e(a,n,e),displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}}):null})]})]}),Object(vt.jsxs)("div",{className:"df aib ".concat(e.description?"jcsb":"jcfe"),children:[e.description&&Object(vt.jsx)("div",{className:"singleTicket--additional--description checkboxAndRadio",dangerouslySetInnerHTML:{__html:b(e,"description")}}),null!==e.left&&ot(t,e,i,m)?Object(vt.jsx)("p",{className:"availableTickets additional ml20",children:qa}):f(e)]})]},e.id)})),vr(y)]})},Ir=mr((function(e){return{saveAdditionalToCrm:e.funcs.saveAdditionalToCrm,removeAdditionalFromCrm:e.funcs.removeAdditionalFromCrm,displayAdditionalAvailability:e.funcs.displayAdditionalAvailability,itemsAvailabilityData:e.itemsAvailabilityData,showVat:e.showVat,setDidReserveAdditional:e.funcs.setDidReserveAdditional,setTimerStart:e.funcs.setTimerStart,setAdditionalChangedKey:e.funcs.setAdditionalChangedKey,setTicketAdditionalChangedId:e.funcs.setTicketAdditionalChangedId,ticketAdditionalChangedId:e.ticketAdditionalChangedId,temporaryAdditionals:e.temporaryAdditionals,users:e.users,showErrors:e.showErrors,stateAdditionals:e.additionals,orderErrors:e.errors,orderAdditionals:e.event.additionals,getUserTranslatedText:function(t,n){return pt(t,n,e.language)}}}))(Object(b.memo)(_r)),wr=mr((function(e){return{showVat:e.showVat,saveAdditionalNumberToCrm:e.funcs.saveAdditionalNumberToCrm,displayAdditionalAvailability:e.funcs.displayAdditionalAvailability,temporaryAdditionals:e.temporaryAdditionals,setDidReserveAdditional:e.funcs.setDidReserveAdditional,setTimerStart:e.funcs.setTimerStart,setAdditionalChangedKey:e.funcs.setAdditionalChangedKey,setTicketAdditionalChangedId:e.funcs.setTicketAdditionalChangedId,handleCrmValidation:e.funcs.handleCrmValidation,removeAdditionalFromCrm:e.funcs.removeAdditionalFromCrm,users:e.users,showErrors:e.showErrors,stateAdditionals:e.additionals,orderErrors:e.errors,getUserTranslatedText:function(t,n){return pt(t,n,e.language)}}}))((function(e){var t=e.ticket,n=e.additional,a=e.showVat,i=e.saveAdditionalNumberToCrm,r=(e.temporaryAdditionals,e.setDidReserveAdditional),s=e.setTimerStart,c=e.setAdditionalChangedKey,o=e.setTicketAdditionalChangedId,d=e.handleCrmValidation,l=e.removeAdditionalFromCrm,u=e.users,m=e.showErrors,p=e.stateAdditionals,h=e.orderErrors,f=e.getUserTranslatedText,v=e.displayAdditionalAvailability,j=Object(b.useState)(),g=Object(U.a)(j,2),O=g[0],y=g[1],x=function(e){i(t,n,e),r(!1),s(Date.now()),t&&(c(t.id),o(t.category_id))};Object(b.useEffect)((function(){y(ot(t,n,u,p))}),[t,p]);var k=Cr(t,n),C=t?t.errors[n.id]:h[n.id],T=gr(C)&&m,E=t?u[t.id].additionals[n.id]?u[t.id].additionals[n.id].number:"":p[n.id]?p[n.id].number:"";return Object(vt.jsxs)("div",{className:"singleTicket--additional mb30 p10 ".concat(T?"errorBackground":""),children:[Object(vt.jsxs)("div",{className:"df aib jcsb",children:[Object(vt.jsx)(fr,{medium:!0,labelName:f(n,"name"),htmlFor:k,required:n.required}),Object(vt.jsx)("div",{className:"".concat(0!==+n.price&&"price"," ml20"),children:n.price_ex_vat&&0!==+n.price?Object(vt.jsx)(ur.a,{value:$e(a,n),displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}}):null})]}),Object(vt.jsxs)("div",{className:"df aib ".concat(n.description?"jcsb":"jcfe"),children:[n.description&&Object(vt.jsx)("div",{className:"singleTicket--additional--description",dangerouslySetInnerHTML:{__html:f(n,"description")}}),O>0?Object(vt.jsx)(kr,{onWaiting:O,additionalType:"number"}):Object(vt.jsx)(xr,{left:n.left,additional:n,displayAdditionalAvailability:v})]}),Object(vt.jsx)("div",{className:"singleTicket--additional--number",children:Object(vt.jsx)(hr,{id:k,className:"form-control",name:n.id.toString(),value:E,placeholder:0,type:"number","aria-invalid":T,"aria-describedby":T?"".concat(k,"-err"):null,inputMode:"numeric",disabled:function(){if(n.waiting_list)return!1;var e=!t?p:u[t.id].additionals;return!!(null!==n.left&&n.left<=0&&Object(Li.isNullOrUndefined)(e[n.id]))}(),onChange:function(e){var t=parseInt(e.target.value.toString().replace("+","").replace("-","").replace("","0"));(null===n.left||n.waiting_list||e.target.value<=n.left&&e.target.value>=0)&&x(t)},onBlur:function(e){n.required?d(e,t,n):0===+e.target.value&&l(t,n)}})}),vr(C,"".concat(k,"-err"))]})})),Ar=["onChange","value","createSelectList","size","extraClasses"],Rr=function(e){var t=e.onChange,n=e.value,a=e.createSelectList,i=e.size,r=e.extraClasses,s=Object($i.a)(e,Ar);return Object(vt.jsxs)("div",{className:"selectBox-default selectBox-default--".concat(i," ").concat(r),children:[Object(vt.jsx)("i",{className:"icons8-expand-arrow"}),Object(vt.jsx)("select",Object(C.a)(Object(C.a)({onChange:t,value:n},s),{},{children:a(n)}))]})};Rr.defaultProps={className:"",size:"small",extraClasses:""};var Pr=Object(b.memo)(Rr),Dr=function(e){var t=e.ticket,n=e.additional,a=e.saveAdditionalToCrm,i=e.removeAdditionalFromCrm,r=e.showErrors,s=e.stateAdditionals,c=e.orderErrors,o=e.getUserTranslatedText,d=e.orderAdditionals,l=Cr(t,n),u=t?t.errors[n.id]:c[n.id],m=gr(u)&&r;return Object(vt.jsxs)("div",{className:"singleTicket--additional mb30 p10 ".concat(m?"errorBackground errorInput":""),children:[Object(vt.jsx)(fr,{htmlFor:l,labelName:o(n,"name"),medium:!0,required:n.required}),n.description&&Object(vt.jsx)("div",{className:"singleTicket--additional--description",dangerouslySetInnerHTML:{__html:o(n,"description")}}),Object(vt.jsx)(Pr,{id:l,className:"".concat(jr(u)),required:n.required,"aria-required":n.required,"aria-invalid":m,"aria-describedby":m?"".concat(l,"-err"):null,onChange:function(e){Object.values(n.children).forEach((function(i){i.name===e.target.value&&a(t,n,i)})),""===e.target.value&&i(t,n)},value:function(){var e=t?t.additionals[n.id]:s[n.id];return e?n.children[e.child_id].name:""}(),name:n.id.toString(),size:"large",createSelectList:function(e){var a=[Object(vt.jsx)("option",{value:""},"empty")];return(t?rt(n,t)?rt(n,t).children:[]:d.find((function(e){return e.id===n.id}))?d.find((function(e){return e.id===n.id})).children:[]).forEach((function(t){a.push(Object(vt.jsx)("option",{"aria-selected":t.name===e,value:t.name,children:o(t,"name")},t.name))})),a}}),vr(u,"".concat(l,"-err"))]})},Mr=mr((function(e){return{saveAdditionalToCrm:e.funcs.saveAdditionalToCrm,removeAdditionalFromCrm:e.funcs.removeAdditionalFromCrm,showErrors:e.showErrors,stateAdditionals:e.additionals,orderErrors:e.errors,orderAdditionals:e.event.additionals,getUserTranslatedText:function(t,n){return pt(t,n,e.language)}}}))(Object(b.memo)(Dr)),Fr=function(e){var t=e.ticket,n=e.additional,a=e.showVat,i=e.users,r=e.saveAdditionalToCrm,s=e.removeAdditionalFromCrm,c=e.setDidReserveAdditional,o=e.setTimerStart,d=e.setAdditionalChangedKey,l=e.setTicketAdditionalChangedId,u=e.showErrors,m=e.stateAdditionals,p=e.orderErrors,h=e.orderAdditionals,b=e.getUserTranslatedText,f=e.displayAdditionalAvailability,v=e.itemsAvailabilityData,j=function(e){return t?!!i[t.id].additionals[e.id]:!!m[e.id]},g=function(e){if(n.maxSelectableChoices&&function(){var e=0;if(t){var a=i[t.id];Object.values(n.children).forEach((function(t){a.additionals[t.id]&&e++}))}else Object.values(n.children).forEach((function(t){m[t.id]&&e++}));return e}()>=n.maxSelectableChoices&&!j(e))return!0;var a=v[e.id]?v[e.id].left:e.left,r=!t?m:i[t.id].additionals;return!e.waiting_list&&(null!==e.available&&!(e&&!(null!==a&&a<=0&&Object(Li.isNullOrUndefined)(r[e.id]))))},O=function(){return t?rt(n,t)?rt(n,t).children:[]:h.find((function(e){return e.id===n.id}))?h.find((function(e){return e.id===n.id})).children:[]},y=Cr(t,n),x=t?t.errors[n.id]:p[n.id],k=t?t.additionals[n.id]:m[n.id];return Object(vt.jsxs)("div",{role:"radiogroup",className:"mb30 p10 prelative ".concat(gr(x)&&u?"errorBackground":""),children:[Object(vt.jsxs)("div",{className:"mb10",children:[Object(vt.jsxs)("div",{className:"df jcsb",children:[Object(vt.jsx)(fr,{labelName:b(n,"name"),mediumLarge:!0,required:n.required}),k&&Object(vt.jsx)("div",{children:Object(vt.jsx)("button",{type:"button",onClick:function(){s(t,n)},className:"btn-remove-radio",children:Aa})})]}),n.description&&Object(vt.jsx)("div",{className:"singleTicket--additional--radioDescription w80p mt10",dangerouslySetInnerHTML:{__html:b(n,"description")}})]}),O().map((function(e){var u="".concat(y,"-").concat(e.id);Object(C.a)(Object(C.a)({},e),{},{parent_id:n.id});return Object(vt.jsxs)("div",{className:"singleTicket--additional",children:[Object(vt.jsxs)("div",{className:"df aic jcsb",children:[Object(vt.jsx)(hr,{className:"checkbox",name:y,checked:j(e),value:e.id,type:"checkbox",disabled:g(e),id:u,onChange:function(){return function(e){g(e)||(j(e)?s(t,e):(r(t,n,e),t&&(d(t.id),l(t.category_id)),c(!1),o(Date.now())))}(e)}}),Object(vt.jsxs)("div",{className:"df aib w100p jcsb",children:[Object(vt.jsx)(fr,{medium:!0,labelName:b(e,"name"),htmlFor:u,required:"not required"}),Object(vt.jsx)("div",{className:"".concat(0!==+e.price&&"price"," ml20"),children:e.price_ex_vat&&0!==+e.price?Object(vt.jsx)(ur.a,{value:$e(a,n,e),displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}}):null})]})]}),Object(vt.jsxs)("div",{className:"df aib ".concat(e.description?"jcsb":"jcfe"),children:[e.description&&Object(vt.jsx)("div",{className:"singleTicket--additional--description checkboxAndRadio",dangerouslySetInnerHTML:{__html:b(e,"description")}}),null!==e.left&&ot(t,e,i,m)?Object(vt.jsx)("p",{className:"availableTickets additional ml20",children:qa}):f(e)]})]},e.id)})),Object(vt.jsx)("p",{className:"checkin-additional-multicheckbox-rules",children:function(){var e,t,a,i,r=O();if(n.minSelectableChoices&&n.maxSelectableChoices){if(n.maxSelectableChoices===n.minSelectableChoices)return i=n.maxSelectableChoices,Object(vt.jsx)(Ot,{dictionary:{nb:"Velg eksakt ".concat(i," alternativ"),en:"Select exactly ".concat(i," option(s)")}});if(n.maxSelectableChoices<r.length)return t=n.minSelectableChoices,a=n.maxSelectableChoices,Object(vt.jsx)(Ot,{dictionary:{nb:"Velg mellom ".concat(t," og ").concat(a," alternativ"),en:"Select between ".concat(t," and ").concat(a," options")}})}else{if(n.maxSelectableChoices&&n.maxSelectableChoices<r.length)return e=n.maxSelectableChoices,Object(vt.jsx)(Ot,{dictionary:{nb:"Velg opp til ".concat(e," alternativ"),en:"Select a maximum of ".concat(e," option(s)")}});if(n.minSelectableChoices&&n.minSelectableChoices>1)return function(e){return Object(vt.jsx)(Ot,{dictionary:{nb:"Velg minimum ".concat(e," alternativ"),en:"Select a minimum of ".concat(e," options")}})}(n.minSelectableChoices)}}()}),vr(x)]})},Lr=mr((function(e){return{saveAdditionalToCrm:e.funcs.saveAdditionalToCrm,removeAdditionalFromCrm:e.funcs.removeAdditionalFromCrm,displayAdditionalAvailability:e.funcs.displayAdditionalAvailability,itemsAvailabilityData:e.itemsAvailabilityData,showVat:e.showVat,setDidReserveAdditional:e.funcs.setDidReserveAdditional,setTimerStart:e.funcs.setTimerStart,setAdditionalChangedKey:e.funcs.setAdditionalChangedKey,setTicketAdditionalChangedId:e.funcs.setTicketAdditionalChangedId,ticketAdditionalChangedId:e.ticketAdditionalChangedId,temporaryAdditionals:e.temporaryAdditionals,users:e.users,showErrors:e.showErrors,stateAdditionals:e.additionals,orderErrors:e.errors,orderAdditionals:e.event.additionals,getUserTranslatedText:function(t,n){return pt(t,n,e.language)}}}))(Object(b.memo)(Fr)),Wr=function(e,t,n){var a=e.filter((function(e){return!n[e.id].triggered_by.length})).map((function(e){return e.id})),i=[];for(var r in t)if(t.hasOwnProperty(r)){var s=t[r];i.push.apply(i,Object(k.a)(s.descendants))}return e.filter((function(e){return i.includes(e.id)||a.includes(e.id)}))},qr=function(e){var t=e.ticket,n=e.orderAdditionals,a=e.stateAdditionals,i=e.convertedAdditionals,r=n?Wr(n,a,i):function(e){var t=it(e),n=t.additionals.filter((function(t){return!e.ticket.additionals[t.id].triggered_by.length})).map((function(e){return e.id})),a=[];for(var i in e.additionals)if(e.additionals.hasOwnProperty(i)){var r=e.additionals[i];(null===r||void 0===r?void 0:r.descendants)&&a.push.apply(a,Object(k.a)(r.descendants))}return t.additionals.filter((function(e){return a.includes(e.id)||n.includes(e.id)}))}(t);return r.length>0&&Object(vt.jsxs)("div",{className:"form-group mt50 mb30",role:"group","aria-labelledby":n?"order-additional":"ticket_additional",children:[!n&&Object(vt.jsx)("h3",{id:"ticket_additional",children:Rn}),r.map((function(e){var a=n?i[e.id]:t.ticket.additionals[e.id],r={key:a.id,ticket:t,additional:a};return"checkbox"===a.type?Object(vt.jsx)(Er,Object(C.a)({},r)):"text"===a.type?Object(vt.jsx)(Nr,Object(C.a)({},r)):"radio"===a.type?Object(vt.jsx)(Ir,Object(C.a)({},r)):"select"===a.type?Object(vt.jsx)(Mr,Object(C.a)({},r)):"number"===a.type?Object(vt.jsx)(wr,Object(C.a)({},r)):"multicheckbox"===a.type?Object(vt.jsx)(Lr,Object(C.a)({},r)):null}))]})},Vr=Object(b.memo)(qr),Br=function(e){var t=e.event;if(t){var n=t.opens,a=t.close,i=new Date(n),r=new Date(a),s=new Date,c=s.getTime()<i.getTime()?i:r,o="The registration ".concat(s<i?"opens":"closed"," at ").concat(ui()(c).format("MMM Do YYYY HH:mm"));return Object(vt.jsx)("div",{role:"alert",className:"registration mt60 tcenter",children:Object(vt.jsx)("h3",{children:o})})}return null},Ur=["error"],Hr=["error"],zr=["error"],Kr=function(e){var t=e.error,n=Object($i.a)(e,Ur);return t.error?Object(vt.jsx)("p",Object(C.a)(Object(C.a)({},n),{},{children:t.error})):Object(vt.jsx)("p",Object(C.a)(Object(C.a)({},n),{},{children:t.message?t.message:t}))},Qr=function(e){var t=e.error,n=Object($i.a)(e,Hr);return t.message.includes("Unexpected token")?Object(vt.jsx)("p",Object(C.a)(Object(C.a)({role:"alert"},n),{},{children:Nn})):Object(vt.jsx)("p",Object(C.a)(Object(C.a)({role:"alert"},n),{},{children:t.message.replace("GraphQL error: ","")}))},Gr=function(e){var t=e.error,n=Object($i.a)(e,zr);return Object(vt.jsx)("p",Object(C.a)(Object(C.a)({role:"alert",className:"errorMessages"},n),{},{children:t}))},$r=function(e){var t=e.handleChange,n=e.validateCoupon,a=e.coupon,i=a.code,r=a.loading,s=a.error,c=a.addedCoupon,o=e.client,d=Object(b.useState)(!1),l=Object(U.a)(d,2),u=l[0],m=l[1],p=f.a.useRef(),h=f.a.useRef();f.a.useLayoutEffect((function(){c&&p.current&&p.current.focus()}),[c]),f.a.useLayoutEffect((function(){u&&h.current&&h.current.focus()}),[u]);var v=function(){var e=Object(x.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!i.length){e.next=4;break}return e.next=4,o.query({query:Re,variables:{id:Number(document.event_id),coupon:i}});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return Object(vt.jsx)("div",{className:"form-group df mt20 coupon--section",children:c?Object(vt.jsxs)("div",{role:"alert",tabIndex:-1,ref:p,children:[" ",Object(vt.jsxs)("p",{className:"green",children:[on," ",i," ",Tn,"!"]})]}):u?c?Object(vt.jsx)("div",{}):Object(vt.jsxs)("form",{tabIndex:-1,role:"group","aria-label":"Discount form",onSubmit:function(e){e.preventDefault(),i.length&&n(e)},children:[Object(vt.jsx)(fr,{htmlFor:"coupon",srOnly:!0,labelName:on}),Object(vt.jsxs)("div",{className:"jcc coupon--section--field",children:[Object(vt.jsx)(hr,{ref:h,value:i,id:"coupon",name:"coupon",autoComplete:"off",required:!0,"aria-invalid":!!s.message,"aria-describedby":s.message?"coupon-err":null,className:s.message?"form-control errorInput":"form-control",type:"text",onChange:t,autoFocus:!0}),Object(vt.jsx)("button",{onMouseOver:v,className:"btn-validate btn-success",type:"submit",children:r?kn:Cn})]}),s.message&&Object(vt.jsx)(Gr,{error:Zt(s.message),id:"coupon-err"})]}):Object(vt.jsx)("button",{type:"button",className:"coupon--section--activate",onClick:function(){return m(!0)},children:Jt})})},Yr=mr((function(e){return{handleChange:e.funcs.handleChange,validateCoupon:e.funcs.validateCoupon,coupon:e.coupon}}))(Object(b.memo)($r)),Xr=Object(g.f)(Yr);function Jr(e){var t=function(e){var t=[];return e.forEach((function(e){if(e.required){var n,a=null!==(n=e.minSelectableChoices)&&void 0!==n?n:1;if("radio"===e.type||"multicheckbox"===e.type){var i=function(e,t){var n=JSON.parse(JSON.stringify(e)),a=n.filter((function(e){return null!==e.available})).sort((function(e,t){var n,a;return(null!==(n=t.available)&&void 0!==n?n:0)-(null!==(a=e.available)&&void 0!==a?a:0)})),i=n.length-a.length-t<0,r=0;if(!i)return null;for(var s=n.filter((function(e){return null===e.available})),c=t-s.length;a.length>=c;){var o=[].concat(Object(k.a)(s.slice(0,t)),Object(k.a)(a.slice(0,t-s.length)));if(o.length<t)break;r++,o.forEach((function(e){null!==e.available&&e.available--})),a=a.filter((function(e){return e.available})).sort((function(e,t){var n,a;return(null!==(n=t.available)&&void 0!==n?n:0)-(null!==(a=e.available)&&void 0!==a?a:0)}))}return r}(e.children.map((function(e){return{id:e.id,available:e.left}})),a),r=null;i?r=e.left&&e.left<i?e.left:i:e.left&&(r=e.left),t.push(Object(C.a)(Object(C.a)({},e),{},{left:r,requiredAmount:a}))}else t.push(Object(C.a)(Object(C.a)({},e),{},{requiredAmount:a}))}})),t}(e.additionals),n=null;return t.forEach((function(e){if(e.left){var t=e.left;n||(n=t),t<n&&(n=t)}})),e.left&&n&&e.left<n&&(n=e.left),n}var Zr;var es,ts=function(e){var t=e.event,n=e.settings,a=e.incomingCategory,i=e.categories,r=e.addTicket,s=e.removeTicket,c=e.setOrderModeUnspecified,o=e.users,d=e.totalQuantity,l=e.hasLockedTicketForm,u=e.showVat,m=e.getTicketAvailability,p=e.getUserTranslatedText,h=e.setReservationTimer,f=e.activeMode,v=e.websocketConnectionState,j=e.priceMode,g=(e.setItemAvailability,e.allTicketsAreFree),O=Object(b.useState)(a),y=Object(U.a)(O,2),x=y[0],k=y[1],T=Object(b.useState)(!1),E=Object(U.a)(T,2),S=E[0],N=E[1],_=Object(b.useState)(null),I=Object(U.a)(_,2),w=I[0],A=I[1],R=t?t.total_left:null,P=x.id in o?o[x.id].number:0,M=l?lt(o,x.id):P;Object(b.useEffect)((function(){if(x.min_tickets){var e=!!o[x.id]&&o[x.id].number<x.min_tickets;N(e)}}),[x.min_tickets,P]),Object(b.useEffect)((function(){i.length>0&&A(x.left)}),[i,x.left]);var L=function(e){null===x.available&&null===x.left||(e>0?z(B-e):!o[x.id]&&x.min_tickets?z(B-x.min_tickets):z(B-1)),r(x,n,e);try{Zi.dispatchEvent(Gi.REGISTRATION_STARTED,{event:Gi.REGISTRATION_STARTED,data:null}),Zi.dispatchEvent(Gi.PROGRESS,{event:Gi.PROGRESS,data:{step:Gi.CHOOSE_TICKETS_STEP_VISITED}})}catch(t){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:Gi.CHOOSE_TICKETS_STEP_VISITED}})}},W=function(e){if(x.onWaiting=!0,t.settings.ticket_limit){var n=d;e>0?n+=e:!o[x.id]&&x.min_tickets?n+=x.min_tickets:n+=1,n<=t.settings.ticket_limit&&L(e)}else L(e)},q=Object(b.useState)(x.left),V=Object(U.a)(q,2),B=V[0],z=V[1];Object(b.useEffect)((function(){x.setLeft=z}),[]),Object(b.useEffect)((function(){if(v.current==se&&(null!==x.available||t.seatmap||null!==x.left)){var e=window.socketHandler.findOrCreate("ticket-".concat(x.id));e&&e.bind(Hi,(function(e){z(e.left)}))}}),[v]),Object(b.useEffect)((function(){o[x.id]?k(Object(C.a)(Object(C.a)({},x),{},{left:B-o[x.id].onWaiting})):k(Object(C.a)(Object(C.a)({},x),{},{left:B}))}),[B]),Object(b.useEffect)((function(){k(Object(C.a)(Object(C.a)({},x),{},{left:a.left}))}),[a]);var K=function(e,t,n,a,i){if(c(d+t.min_tickets,"add"),i||(i=0),null!==e)if(a)o[t.id]?d+t.min_tickets+i<=Number(e)&&i<=t.left?L(i):t.waiting_list&&f===H&&W(i):d+t.min_tickets+i<=Number(e)?L(i):t.waiting_list&&f===H&&W(i);else if(!a&&o[t.id]){(i>0?i:1)<=Number(e)?L(i):t.waiting_list&&f===H&&W(i)}else i<=Number(e)?L(i):t.waiting_list&&f===H&&W(i);else L(i)},Q=function(e,n){var a=null,i=!1,r=t.settings.ticket_limit;R?(a=t.settings.ticket_limit&&t.settings.ticket_limit<R?t.settings.ticket_limit:R)-d>x.left?r=x.left:i=!0:t.settings.ticket_limit&&t.settings.ticket_limit-d<=x.left?(a=t.settings.ticket_limit,i=!0):x.left&&(r=x.left),o[x.id]?a&&a-d+o[x.id].number<=x.left&&(r=a,i=!0):a&&a-d<=x.left?(r=a,i=!0):r=x.left?x.left:t.settings.ticket_limit,x&&x.digital&&!x.available&&(r=t.settings.ticket_limit?t.settings.ticket_limit:null);var s=Jr(x);null===r&&s&&(r=s),r&&s&&s<r&&(r=s),null!==x&&(null!==w&&x.left>0||null===x.left||x.digital&&!x.available?n?K(r,x,0,i,n):K(r,x,0,i):x.waiting_list&&K(r,x,0,i)),h(Date.now(),!1)};var G,$=![11238].includes(t.customer.id),Y=l||!!t.settings.ticket_limit&&Number(d)===Number(t.settings.ticket_limit);return Object(vt.jsxs)("div",{role:"listitem",className:"df jcsb acc ticket","aria-label":"Ticket","data-testid":"ticket",children:[Object(vt.jsxs)("div",{className:"w50p",children:[Object(vt.jsx)("h4",{children:p(x,"name")}),Object(vt.jsx)("div",{className:"ticket--description",dangerouslySetInnerHTML:{__html:p(x,"description")}}),(x.private||!x.published)&&Object(vt.jsxs)("div",{className:"df ticket--invitation",role:"list",children:[x.private&&Object(vt.jsx)("p",{role:"listitem",children:Pa}),!x.published&&Object(vt.jsx)("p",{role:"listitem",children:Ra})]})]}),Object(vt.jsx)("div",{className:"df jcsb acc w40p aib",children:Object(vt.jsxs)("div",{className:"df jcfe flex-wrap-wrap",children:[!g&&Object(vt.jsxs)("span",{className:"tright",children:[Object(vt.jsx)("h4",{className:"asc price light","aria-label":"Price",children:Object(vt.jsx)(ur.a,{value:Ge(x,u),displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}})}),Object(vt.jsx)("p",{className:"price-vat","aria-label":"VAT",children:"ex_vat"===j?sn:cn})]}),Object(vt.jsxs)("div",{className:"ticket--amount",children:[Object(vt.jsx)("button",{className:"ticket--amount--button minus ".concat(l?"btn-disabled":""),type:"button","data-testid":"ticket-decrease","aria-label":"Remove one ticket","aria-disabled":l,disabled:l,onClick:function(){x.id in o&&o[x.id].number>0&&(h(Date.now(),!1),null===x.left||o[x.id].onWaiting||z(B+1),s(x))},children:Object(vt.jsx)("i",{className:"icon icons8-minus-math"})}),Object(vt.jsx)("input",{"data-testid":"ticket-quantity",role:"spinbutton",onChange:function(e){var t=0;x.id in o&&o[x.id]&&(t=o[x.id].number);var n=e.target.value.trim();0===n.length&&(n=0);var a=n-t;/^\d+$/.test(n)&&0!=a&&n<=999&&(n>t?Q(0,a):(s(x,null,Math.abs(a)),z(B+Math.abs(a))))},className:"ticket-number-input".concat(S?" errorInput":""),type:"number","aria-valuemin":M?x.min_tickets:null,"aria-valuenow":M,step:1,autoComplete:"off",inputMode:"numeric","aria-label":"Number of tickets","aria-invalid":S,"aria-describedby":S?"ticket-".concat(x.id,"-err"):null,value:M}),Object(vt.jsx)("button",{type:"button","data-testid":"ticket-increase","aria-label":"Add one more ticket","aria-disabled":Y,disabled:Y,className:"ticket--amount--button plus ".concat(Y?"btn-disabled":""),onClick:Q,children:Object(vt.jsx)("i",{className:"icons8-plus-math-3 icon"})})]}),$&&m(x,w)&&Object(vt.jsx)("div",{className:"availableTickets pl15",children:o[x.id]&&o[x.id].onWaiting>0?Object(vt.jsx)(ns,{onWaiting:o[x.id].onWaiting}):Object(vt.jsx)(as,{category:x,availableTickets:w,getTicketAvailability:m})}),S&&Object(vt.jsx)(is,{id:"ticket-".concat(x.id,"-err"),role:"alert",className:"errorMessages",children:(G=x.min_tickets,Object(vt.jsx)(Ot,{dictionary:{nb:"Minst ".concat(G," billetter"),en:"Minimum ".concat(G," tickets")}}))})]})})]})},ns=f.a.memo((function(e){var t=e.onWaiting,n=Object(yr.b)();return Object(b.useEffect)((function(){n.start(Or)})),Object(vt.jsx)(yr.a.div,{animate:n,children:Object(vt.jsxs)("p",{className:"error",style:{fontWeight:600},children:["(".concat(t,")")," ",qa]})})})),as=f.a.memo((function(e){var t=e.category,n=e.availableTickets,a=e.getTicketAvailability,i=(e.children,Object(yr.b)());return Object(b.useEffect)((function(){i.start(Or)})),Object(vt.jsxs)(yr.a.div,{animate:i,children:[a(t,n)," "]})})),is=or.a.span(Zr||(Zr=Object(Ee.a)(["\n\ttext-align: right;\n\tdisplay: block;\n\tfont-size: 0.8em;\n\twidth: 100%;\n"]))),rs=mr((function(e){return{event:e.event,websocketConnectionState:e.websocketConnectionState,addTicket:e.funcs.addTicket,setReservationTimer:e.funcs.setReservationTimer,setOrderModeUnspecified:e.funcs.setOrderModeUnspecified,removeTicket:e.funcs.removeTicket,setTimerStart:e.funcs.setTimerStart,setDidReserve:e.funcs.setDidReserve,setItemAvailability:e.funcs.setItemAvailability,users:e.users,totalQuantity:e.totalQuantity,hasLockedTicketForm:e.hasLockedTicketForm,showVat:e.showVat,temporaryCategories:e.temporaryCategories,getTicketAvailability:e.funcs.getTicketAvailability,addItemToReserve:e.funcs.addItemToReserve,allTicketsAreFree:e.allTicketsAreFree,getUserTranslatedText:function(t,n){return pt(t,n,e.language)}}}))(Object(b.memo)(ts)),ss="default",cs="reservation",os=Object(Se.a)(es||(es=Object(Ee.a)(["\n  mutation setOrderMode($mode: String!) {\n    setOrderMode(mode: $mode) @client\n  }\n"]))),ds=mr((function(e){return{orderProcessor:e.funcs.orderProcessor,hasLockedTicketForm:e.hasLockedTicketForm,activeMode:e.apolloState.activeMode,getSumDiscount:wi(e.users,{},e.showVat,!0),userIsPassive:e.userIsPassive,removeAllTicketsFromWaitingList:e.funcs.removeAllTicketsFromWaitingList,removeSeatingTickets:e.funcs.removeSeatingTickets}}))((function(e){var t=e.event,n=e.orderProcessor,a=e.hasLockedTicketForm,i=e.activeMode,r=e.getSumDiscount,s=(e.userIsPassive,e.removeAllTicketsFromWaitingList),c=e.removeSeatingTickets,o=t&&t.settings&&t.settings.modes?t.settings.modes.filter((function(e){return"family"!==e&&"group"!==e})):[];return Object(b.useEffect)((function(){i===cs&&(c(),s())}),[i]),Object(vt.jsxs)(b.Fragment,{children:[t&&t.settings.coupons&&Object(vt.jsx)(Xr,{}),!a&&o.length>1&&Object(vt.jsxs)("div",{className:"mb30",children:[Object(vt.jsx)("div",{className:"button-group jcsb",role:"radiogroup","aria-label":"Order mode",children:Object(vt.jsx)(g.b,{mutation:os,children:function(e){return o.map((function(t){return Object(vt.jsxs)("button",{type:"button",name:"activeMode",role:"radio","aria-checked":t===i,"aria-describedby":t===cs?"reservation_desc":null,value:t,className:"btn orderMode btn-default ".concat(i===t?"btn--active":""),onClick:function(){e({variables:{mode:t}}).then((function(){n()}))},children:[t===ss&&xt,t===cs&&kt,"family"===t&&Ct,"group"===t&&Tt]},t)}))}})}),Object(vt.jsx)("div",{role:"alert",id:"reservation_desc",className:"df reservation",children:Object(vt.jsxs)("p",{className:"reservation--text",children:[Object(vt.jsx)("b",{children:ca}),Object(vt.jsx)("br",{}),sa]})})]}),Object(vt.jsxs)("div",{className:"registration--start",role:"list","aria-label":"Tickets list",children:[t&&t.categories.map((function(e){if(i===cs&&(!e.seating||e.seating===de)||i===ss)return Object(vt.jsx)(rs,{incomingCategory:e,settings:t.settings,priceMode:t.customer.price_mode,categories:t.categories,activeMode:i},e.id)})),r>0&&Object(vt.jsxs)("div",{className:"df jcsb acc ticket",role:"listitem","aria-label":"Discount",children:[Object(vt.jsx)("div",{className:"w50p",children:Object(vt.jsx)("h4",{children:Mt})}),Object(vt.jsxs)("div",{className:"df jcsb acc w40p",children:[Object(vt.jsx)("span",{className:"tright",children:Object(vt.jsx)("h4",{className:"asc price light",children:Object(vt.jsx)(ur.a,{value:r,displayType:"text",thousandSeparator:" ",renderText:function(e){return"0"===e?Object(vt.jsx)("span",{children:e}):Object(vt.jsxs)("span",{children:["- ",e]})}})})}),Object(vt.jsx)("div",{className:"ticket--amount"})]})]})]})]})}));var ls=f.a.createContext(),us=function(e){Object(_.a)(n,e);var t=Object(I.a)(n);function n(e){var a;return Object(E.a)(this,n),(a=t.call(this,e)).getInitialState=function(){var e;return{allTicketsAreFree:!1,eventIsFree:!1,eventName:"",itemsAvailabilityData:{},showDebugger:!1,coupon:{code:"",addedCoupon:!1,loading:!1,error:{}},notEnoughItemsModal:{isOpen:!1,hasBeenOpen:!1,allowWaitingList:!1,itemReserved:{},noTicketsLeft:!1},reservedEventHappened:!1,seats:[],hasLockedTicketForm:!1,countryByIP:"",eventCountry:"NO",users:{},seatUsers:[],errors:{},showVat:!1,settings:{},totalQuantity:0,sumTicketFee:0,sumTicketFeeWaiting:0,holdBackInvoice:!1,forceWaitinglist:!1,orderHasWaitingItems:!1,userIsWaiting:!1,customerId:0,convertedAdditionals:{},additionals:{},checkedSameAsTickets:[],userIsPassive:!1,reservationTimer:{didReserve:!1,timerStart:0},initializedUsers:!1,components:(e={},Object(T.a)(e,he,{isTouched:!1,expanded:!0}),Object(T.a)(e,be,{isTouched:!1,expanded:!1}),Object(T.a)(e,Oe,{isTouched:!1,expanded:!1}),Object(T.a)(e,fe,{isTouched:!1,expanded:!1}),Object(T.a)(e,ve,{isTouched:!1,expanded:!0}),Object(T.a)(e,je,{isTouched:!1,expanded:!1}),Object(T.a)(e,ge,{isTouched:!1,expanded:!1}),e),orderInfo:{name:"",firstName:"",lastName:"",email:"",countryCode:"",dialCode:"",phone:"",formattedPhone:"",address:"",zipcode:"",city:"",payer:J,companyName:"",orgNo:"",reference:"",ticketBuyerAlsoAttending:!1,companyCountry:"NO",fromCountry:"NO"},validOrgNo:!1,timerStart:0,didReserve:!1,didReserveAdditional:!1,temporaryCategories:[],temporaryAdditionals:[],additionalChangedKey:0,ticketAdditionalChangedId:0,paymentSuccessful:!1,websocketConnectionState:{current:se,previous:ce},paymentInfo:{invoiceEmail:"",paymentOption:G},showErrors:!1,touchedAdditionalCheckboxes:[],eventIsActive:!0,itemsReserved:[],itemsToReserve:[],waitingAdditionals:{},itemReserveQueueComplete:!0,expired:!1,hasAvailability:!1,funcs:{resetItemsToReserve:a.resetItemsToReserve,addItemToReserve:a.addItemToReserve,validateAdditionalItemReserve:a.validateAdditionalItemReserve,handleValidation:a.handleValidation,handleCompanyChange:a.handleCompanyChange,handleCompanyInfo:a.handleCompanyInfo,handlePhoneChange:a.handlePhoneChange,handleSplitName:a.handleSplitName,handleChange:a.handleChange,addTicket:a.addTicket,removeTicket:a.removeTicket,saveAdditionalsQuantity:a.saveAdditionalsQuantity,handleSubmit:a.handleSubmit,setPaymentSuccessful:a.setPaymentSuccessful,handleNewSubmit:a.handleNewSubmit,validateCoupon:a.validateCoupon,handleCollapse:a.handleCollapse,handleCrmChange:a.handleCrmChange,usersExplode:a.usersExplode,handleCrmPhone:a.handleCrmPhone,orderProcessor:a.orderProcessor,saveAdditionalToCrm:a.saveAdditionalToCrm,saveAdditionalNumberToCrm:a.saveAdditionalNumberToCrm,removeAdditionalFromCrm:a.removeAdditionalFromCrm,saveAdditionalTextToCrm:a.saveAdditionalTextToCrm,handleCrmValidation:a.handleCrmValidation,setPaymentOption:a.setPaymentOption,saveError:a.saveError,saveTicketError:a.saveTicketError,orderIsFree:a.orderIsFree,handleCheckedSameAs:a.handleCheckedSameAs,setTimerStart:a.setTimerStart,setDidReserve:a.setDidReserve,setDidReserveAdditional:a.setDidReserveAdditional,setAdditionalChangedKey:a.setAdditionalChangedKey,setTicketAdditionalChangedId:a.setTicketAdditionalChangedId,runCalculateTicketFee:a.runCalculateTicketFee,resetState:a.resetState,addTicketAfter:a.addTicketAfter,fillTicketBuyer:a.fillTicketBuyer,setCustomerId:a.setCustomerId,showErrorHelper:a.showErrorHelper,validateTicketAmount:a.validateTicketAmount,returnAllTicketErrors:a.returnAllTicketErrors,getTicketAvailability:a.getTicketAvailability,getAmountOfCategory:a.getAmountOfCategory,setOrderModeUnspecified:a.setOrderModeUnspecified,saveTouchedAdditionalCheckboxes:a.saveTouchedAdditionalCheckboxes,validateAllFields:a.validateAllFields,validateOrgNo:a.validateOrgNo,eventIsOpen:a.eventIsOpen,setOrderInfoCountry:a.setOrderInfoCountry,isFromEventCountry:a.isFromEventCountry,ipCountrySameAsEventCountry:a.ipCountrySameAsEventCountry,setUserVatToZero:a.setUserVatToZero,resetUserVat:a.resetUserVat,setCountryByIp:a.setCountryByIp,setReservationTimer:a.setReservationTimer,removeAllTicketsFromWaitingList:a.removeAllTicketsFromWaitingList,displayAdditionalAvailability:a.displayAdditionalAvailability,setSeats:a.setSeats,setSeatUsers:a.setSeatUsers,fillAllTickets:a.fillAllTickets,getTotalQuantityWithSeating:a.getTotalQuantityWithSeating,shouldSkipSeatmap:a.shouldSkipSeatmap,hasDifferentSeatPriceGroups:a.hasDifferentSeatPriceGroups,getTicketSeatPriceGroupPrice:a.getTicketSeatPriceGroupPrice,removeSeatingTickets:a.removeSeatingTickets,getFields:a.getFields,getPriceGroups:a.getPriceGroups,getOrderDataForAnalytics:a.getOrderDataForAnalytics}}},a.setSeats=function(e){a.setState({seats:e});var t=Object.values(a.state.users).filter((function(e){return"RESERVED"===e.seating}));a.props.event.seatmap.options.forceSeatAllocation&&a.hasDifferentSeatPriceGroups(t.map((function(t,n){return Object(C.a)(Object(C.a)({},e[n]),{},{ticketId:t.category_id})})))||a.allocateSeatsToTicket(e)},a.setSeatUsers=function(e){var t=Object(C.a)({},a.state.users);e.forEach((function(e){var n=e.userId;n&&(t[n].seat=e)})),a.setState({users:t,seatUsers:e})},a.getTicketSeatPriceGroupPrice=function(e,t){var n,i=a.props.event.seatmap.priceGroups.find((function(e){return e.name===t.priceGroup})),r=i.tickets.find((function(t){return t.ticketId===e})),s={price:0,vat:0};r&&r.price?s={price:r.price,vat:r.vat}:s={price:Number(i.price),vat:null!==(n=i.vat)&&void 0!==n?n:0};return s},a.getPriceGroups=function(){return a.props.event.seatmap.priceGroups},a.allocateSeatsToTicket=function(e){var t=Object(C.a)({},a.state.users),n=Object(k.a)(e);n.length>0&&Object.values(t).forEach((function(e){if("RESERVED"===e.seating){var t=n[n.length-1];if(t){e.seat=t;var i=a.getTicketSeatPriceGroupPrice(e.category_id,t);e.seat.price=i.price,e.seat.vat=i.vat,n.pop()}}})),a.setState({users:t})},a.hasDifferentSeatPriceGroups=function(e){return function(e,t){var n,a=e.map((function(e){return e.priceGroup})),i=e.map((function(e){return e.ticketId})),r=t.filter((function(e){return a.includes(e.name)})).map((function(e){var t=e.tickets.filter((function(e){return i.includes(e.ticketId)}));return Object(C.a)(Object(C.a)({},e),{},{tickets:t})})),s=r.map((function(e){return e.tickets.map((function(e){return e.ticketId}))})).join().split(","),c=Object(B.a)(i);try{for(c.s();!(n=c.n()).done;){var o=n.value;if(!s.includes(o))return!0}}catch(v){c.e(v)}finally{c.f()}var d,l=Object(B.a)(r);try{for(l.s();!(d=l.n()).done;){var u,m=d.value,p=null,h=null,b=Object(B.a)(m.tickets);try{for(b.s();!(u=b.n()).done;){var f=u.value;if(null===p)p=f.price;else if(f.price!==p)return!0;if(null===h)h=f.vat;else if(f.vat!==h)return!0}}catch(v){b.e(v)}finally{b.f()}}}catch(v){l.e(v)}finally{l.f()}return!1}(e,a.props.event.seatmap.priceGroups)},a.handleSocketConnectionEvents=function(e){a.setState({websocketConnectionState:e})},a.setReservationTimer=function(e,t){var n=0,i=!1;n=null!==e?e:a.state.reservationTimer.timerStart,i=null!==t?t:a.state.reservationTimer.didReserve,a.setState({reservationTimer:{timerStart:n,didReserve:i}})},a.resetItemsToReserve=function(){a.setDidReserve(!1),a.setState({itemsToReserve:[]})},a.addItemToReserve=function(e){a.setReservationTimer(Date.now(),!1);for(var t=Object(k.a)(a.state.itemsToReserve),n=t.length,i=!1,r=0;r<n;r++){var s=t[r];s.id===e.id&&s.type===e.type&&("ticket"===s.type||s.key===e.key)&&(i=!0,t[r]=Object(C.a)({},e))}i||t.push(e),a.setState({itemsToReserve:t})},a.itemReserved=function(e){a.setState({reservedEventHappened:!0});var t=new Fi(e);a.props.apolloState.activeMode===H&&window.socketHandler.eventCompleted(t.id),t.waiting>0&&H?a.handleItemReserveWithWaiting(t):a.handleItemReserveWithoutWaiting(t)},a.handleItemReserveWithWaiting=function(e){a.putItemOnWaitingList(e.id,e.type,e.waiting,e.key),a.checkOrderForWaitingItems();var t=a.getWaitingAdditionalsCopy(e);a.setState({itemsReserved:[].concat(Object(k.a)(a.state.itemsReserved),[Object(C.a)(Object(C.a)({},e),{},{name:"ticket"===e.type?a.props.event.categories.find((function(t){return t.id===e.id})).name:""})]),orderHasWaitingItems:!0,waitingAdditionals:t},(function(){a.runCalculateTicketFee()})),a.state.notEnoughItemsModal.isOpen||(window.socketHandler.isQueueComplete(Ui)?a.setState({notEnoughItemsModal:{isOpen:!a.state.notEnoughItemsModal.hasBeenOpen,modalType:"WAITING",hasBeenOpen:!0,allowWaitingList:!0},itemReserveQueueComplete:!0}):a.setState({itemReserveQueueComplete:!1}))},a.handleItemReserveWithoutWaiting=function(e){e.requested>e.reserved?a.handleTooManyItemsRequested(e):"additional"===e.type&&"0"!==e.key&&a.state.users[e.key].onWaiting||a.removeWaitingFromItem(e),"additional"===e.type&&a.removeWaitingAdditionalKey(e),a.checkOrderForWaitingItems()},a.validateAdditionalItemReserve=function(e,t){return function(e,t,n){Object.values(e).forEach((function(e){var a=window.socketHandler.itemReserveHistory.get("additional-".concat(e.id));if(a&&e.available){var i,r=a.events[a.events.length-1],s=a.responses[a.responses.length-1],c=null!==(i=e.number)&&void 0!==i?i:1;s&&s.reserved!==c&&"order"===t?(n(Object(C.a)(Object(C.a)({},r),{},{number:c})),D.b("Websocket event ItemReserve number does not match with state",{level:F.a.Critical,extra:{websocketEvents:JSON.stringify(a.events),websocketResponses:JSON.stringify(a.responses),state:JSON.stringify(e)}})):0===a.responses.length&&D.b("Websocket event ItemReserve did not receive a response",{level:F.a.Critical,extra:{websocketEvents:JSON.stringify(a.events),websocketResponses:JSON.stringify(a.responses),lastReserveEvent:JSON.stringify(r),state:JSON.stringify(e)}})}}))}(e,t,a.addItemToReserve)},a.getWaitingAdditionalsCopy=function(e){var t=Object(C.a)({},a.state.waitingAdditionals);return"additional"===e.type&&0!=e.key&&(t[e.id]?t[e.id].includes(e.key)||(t[e.id]=[].concat(Object(k.a)(t[e.id]),[e.key])):t[e.id]=[e.key]),t},a.handleTooManyItemsRequested=function(e){a.setState({itemsReserved:[].concat(Object(k.a)(a.state.itemsReserved),[Object(C.a)(Object(C.a)({},e),{},{name:"ticket"===e.type?a.props.event.categories.find((function(t){return t.id===e.id})).name:""})])}),window.socketHandler.isQueueComplete(Ui)&&a.setState({notEnoughItemsModal:{isOpen:!0,hasBeenOpen:!1,allowWaitingList:!1,noTicketsLeft:!1,modalType:"NOT_ENOUGH_ITEMS"},itemReserveQueueComplete:!0}),a.setItemAvailability({type:e.type,left:0,id:e.id}),Wi(e.id,e.requested-e.reserved,{removeAdditionalFromCrm:a.removeAdditionalFromCrm,saveAdditionalsQuantity:a.saveAdditionalsQuantity,ticket:"additional"===e.type?a.state.users[e.key]:null,removeTicket:a.removeTicket,users:a.state.users,additionalChangedKey:a.state.additionalChangedKey,ticketAdditionalChangedId:a.state.ticketAdditionalChangedId,activeMode:a.props.apolloState.activeMode,additionals:a.state.additionals},e.type,e.key)},a.removeWaitingFromItem=function(e){var t={};if("ticket"===e.type){if(a.state.users[e.id])if("boolean"===a.state.users[e.id])a.removeWaitingFromLastTicket(e,t);else{var n=Object(C.a)(Object(C.a)({},a.state.users),{},Object(T.a)({},e.id,Object(C.a)(Object(C.a)({},a.state.users[e.id]),{},{onWaiting:0})));t.users=n}}else a.removeWaitingFromAdditional(e,t);t.itemReserveQueueComplete=!0,a.setState(t)},a.removeWaitingFromLastTicket=function(e,t){var n=Object(C.a)({},a.state.users);a.state.hasLockedTicketForm&&(Object.values(n).forEach((function(t){t.category_id===e.id&&t.onWaiting&&(t.onWaiting=!1)})),t.users=n)},a.removeWaitingFromAdditional=function(e,t){var n="0"==e.key,i=n?a.state.additionals:a.state.users[e.key].additionals;a.setItemWaitingStateTo(0,e.id,i),n||Object(C.a)(Object(C.a)({},a.state.users),{},Object(T.a)({},e.key,Object(C.a)(Object(C.a)({},a.state.users[e.key]),{},{additionals:i})))},a.removeWaitingAdditionalKey=function(e){var t=[];a.state.waitingAdditionals[e.id]&&(t=a.state.waitingAdditionals[e.id].filter((function(t){return t!==e.key})),a.setState({waitingAdditionals:Object(C.a)(Object(C.a)({},a.state.waitingAdditionals),{},Object(T.a)({},e.id,t))}))},a.checkOrderForWaitingItems=function(){var e=!1;for(var t in a.state.users)a.state.users[t].onWaiting?(e=!0,a.setState({userIsWaiting:!0,orderHasWaitingItems:!0})):a.state.users[t].additionals&&Object.values(a.state.users[t].additionals).forEach((function(t){t.onWaiting&&(e=!0,a.setState({orderHasWaitingItems:!0}))}));e||Object.values(a.state.additionals).forEach((function(t){t.onWaiting&&(e=!0,a.setState({orderHasWaitingItems:!0}))})),e||a.setState({orderHasWaitingItems:!1},(function(){a.runCalculateTicketFee()}))},a.itemReservedException=function(e){a.setState({itemsReserved:[].concat(Object(k.a)(a.state.itemsReserved),[Object(C.a)(Object(C.a)({},e),{},{modalType:"NONE_LEFT",name:"ticket"===e.type?a.props.event.categories.find((function(t){return t.id===e.id})).name:""})])}),a.setState({notEnoughItemsModal:{isOpen:!0,hasBeenOpen:!1,allowWaitingList:!1,noTicketsLeft:!0}}),Wi(e.id,e.requested-e.reserved,{removeAdditionalFromCrm:a.removeAdditionalFromCrm,saveAdditionalsQuantity:a.saveAdditionalsQuantity,ticket:"additional"===e.type?a.state.users[e.key]:null,removeTicket:a.removeTicket,users:a.state.users,additionalChangedKey:a.state.additionalChangedKey,ticketAdditionalChangedId:a.state.ticketAdditionalChangedId,activeMode:a.props.apolloState.activeMode,additionals:a.state.additionals},e.type,e.key)},a.putItemOnWaitingList=function(e,t,n,i){a.props.apolloState.activeMode===H?"ticket"===t?a.putTicketOnWaitingList(e,n):a.putAdditionalOnWaitingList(e,n,i):a.props.apolloState.activeMode},a.putTicketOnWaitingList=function(e,t){var n=Object(C.a)({},a.state.users),i=0;for(var r in n){var s=n[r];s.category_id===e&&a.state.hasLockedTicketForm&&(n[s.id].onWaiting=!1),i<t&&s.category_id===e&&(a.state.hasLockedTicketForm?n[s.id].onWaiting=!0:n[s.id].onWaiting=t,i++)}a.setState({users:n},(function(){a.orderProcessor()}))},a.putAdditionalOnWaitingList=function(e,t,n){var i,r=n,s="0"==n;i=s?a.state.additionals:a.state.users[n].additionals,a.setItemWaitingStateTo(t,e,i),s?a.setState({additionals:i},(function(){a.orderProcessor()})):a.setState({users:Object(C.a)(Object(C.a)({},a.state.users),{},Object(T.a)({},r,Object(C.a)(Object(C.a)({},a.state.users[r]),{},{additionals:i})))},(function(){a.orderProcessor()}))},a.setItemWaitingStateTo=function(e,t,n){Object.values(n).forEach((function(n){n.children?Object.values(n.children).forEach((function(n){n.id===t&&(n.onWaiting=e>0)})):(n.child_id?n.child_id:n.id)===t&&("number"===n.type?n.onWaiting=e:n.onWaiting=e>0)}))},a.setItemAvailability=function(e){a.props.event.total_left;if("ticket"===e.type){var t=a.props.event.categories.find((function(t){return t.id===e.id}));t.setLeft&&(t.setLeft(e.left),a.setTicketLeft(e.id,e.left))}else a.setAdditionalLeft(e)},a.setTotalleft=function(e){a.props.event.categories.forEach((function(t){null===t.available||a.state.itemsAvailabilityData[t.id]&&a.state.itemsAvailabilityData[t.id].left>e.left?t.setLeft(e.left):a.state.itemsAvailabilityData[t.id]||D.b("Could not find ticket in items availability object",{tags:{event:"SET_TOTAL_LEFT",tota_left:e.left,ticket_id:t.id,left:t.left}})}))},a.removeAllTicketsFromWaitingList=function(){var e=Object(C.a)({},a.state.users);for(var t in e){var n=e[t];n.onWaiting>0&&(n.number-=n.onWaiting,n.onWaiting=0)}a.setState({users:e})},a.setCountryByIp=function(e){"NO"===a.state.orderInfo.fromCountry&&(a.setState({countryByIP:e}),a.setState({orderInfo:Object(C.a)(Object(C.a)({},a.state.orderInfo),{},{fromCountry:e})}))},a.isFromEventCountry=function(){var e=a.state.orderInfo.payer;return e===Z?a.state.eventCountry===a.state.orderInfo.fromCountry:e===J?a.state.eventCountry===a.state.orderInfo.companyCountry:void 0},a.ipCountrySameAsEventCountry=function(){return a.state.eventCountry===a.state.countryByIP},a.setOrderInfoCountry=function(e,t){t===Z?a.setState({orderInfo:Object(C.a)(Object(C.a)({},a.state.orderInfo),{},{fromCountry:e})}):t===J&&a.setState({orderInfo:Object(C.a)(Object(C.a)({},a.state.orderInfo),{},{companyCountry:e})})},a.getStateFromLocalStorage=function(){return Object(C.a)({},JSON.parse(localStorage.getItem("checkin_state")))},a.hydrateState=function(){var e=a.getStateFromLocalStorage();a.setState(e)},a.eventIsOpen=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.state.event;if(e){var t=e.opens,n=e.close,i=new Date(t).getTime(),r=new Date(n).getTime(),s=(new Date).getTime();return s>i&&s<r}return!1},a.setTicketLeft=function(e,t){var n=Object(C.a)({},a.state.itemsAvailabilityData);n[e]?n[e].left=t:n[e]={left:t},a.setState({itemsAvailabilityData:n})},a.setAdditionalLeft=function(e){var t=Object(C.a)({},a.state.itemsAvailabilityData);t[e.id].left=e.left,a.setState({itemsAvailabilityData:t})},a.componentDidMount=Object(x.a)(y.a.mark((function e(){var t,n,i,r,s,c,o,d,l,u,m,p,h,b,f,v,j;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Zi.listeners=[],window.checkinEventRegistrationEvents=Zi;try{M.a({dsn:"https://bfb80251ba89481cb6b45fcc52c08cce@logging.checkin.no/3",integrations:[new L.a.BrowserTracing],tracesSampleRate:1}),D.c("event_id",document.event_id)}catch(g){console.error("Can't connect to Checkin error tracking service")}return window.socketHandler&&(window.socketHandler=null),e.next=6,a.props.client.query({query:Ae,variables:Je()});case 6:if(n=e.sent,i=n.data,r=i.event,s=i.token,document.checkin_event_name=r.name,(null===(t=r.settings.analytics)||void 0===t?void 0:t.registration)&&ar(null===(c=r.settings.analytics)||void 0===c?void 0:c.registration),o=!0,d=!0,qe(s),a.setState({eventName:r.name}),l=!1,u={},!r){e.next=35;break}if(m=r.categories,p=r.additionals,h=r.total_left,l=m.some((function(e){return null!==e.available||e.additionals.some((function(e){return null!==e.available||e.children.some((function(e){return null!==e.available}))}))}))||p.some((function(e){return null!==e.available||e.children.some((function(e){return null!==e.available}))}))||null!==h||r.seatmap,a.setState({hasAvailability:l}),window.hasAvailability=l,window.socketHandler){e.next=31;break}if(window.socketHandler=new zi(s.token),!l){e.next=31;break}return e.next=28,window.socketHandler.init(a.itemReserved,a.setItemAvailability,a.itemReservedException,a.handleSocketConnectionEvents,a.sessionExpired);case 28:window.socketHandler.bindEvent("totalLeft",a.setTotalleft),window.socketHandler.findOrCreate("event-".concat(document.event_id)),window.socketHandler.bindChannelEvent("event-".concat(document.event_id),"totalLeft",a.setTotalleft);case 31:m.forEach((function(e,t){e.price>0&&(o=!1,d=!1),a.addItemToAvailabilityData(e,u),e.additionals.forEach((function(e){e.price>0&&(d=!1),"radio"!==e.type&&"multicheckbox"!==e.type||e.children.forEach((function(e){e.available&&(window.socketHandler.findOrCreate("additional-".concat(e.id)),a.addItemToAvailabilityData(e,u)),e.price>0&&(d=!1)})),e.available&&(window.socketHandler.findOrCreate("additional-".concat(e.id)),a.addItemToAvailabilityData(e,u))}))})),p.forEach((function(e){e.available&&(window.socketHandler.findOrCreate("additional-".concat(e.id)),a.addItemToAvailabilityData(e,u)),e.price>0&&(d=!1),"radio"!==e.type&&"multicheckbox"!==e.type||e.children.forEach((function(e){e.available&&(window.socketHandler.findOrCreate("additional-".concat(e.id)),a.addItemToAvailabilityData(e,u)),e.price>0&&(d=!1)}))})),window.socketHandler.bindChannelTypeEvent("additional",Hi,(function(e){if(a.setAdditionalLeft(e),a.props.apolloState.activeMode!==z&&e.left>0&&a.state.waitingAdditionals[e.id])for(var t=a.state.waitingAdditionals[e.id],n=t.length,i=0;i<n;i++){var r=a.state.users[t[i]].additionals[e.id];a.state.users[t[i]].onWaiting||r.onWaiting>0&&a.addItemToReserve({id:r.id,type:"additional",additionalType:r.type,hasWaitingList:!0,number:r.number,key:t[i],orderMode:a.props.apolloState.activeMode===H?"DEFAULT":"UNSPECIFIED"})}})),a.inactivityTimer(l);case 35:r&&!a.eventIsOpen(r)||r&&!r.categories.length?a.setState({eventIsActive:!1}):(b={},f=a.setPriceModeAndPayer(r),v=mt(r.additionals),j=Object(C.a)(Object(C.a)(Object(C.a)({},f),b),{},{convertedAdditionals:v,holdBackInvoice:!!r.settings.waiting_list&&r.settings.waiting_list.holdBackInvoice,forceWaitinglist:!!r.settings.waiting_list&&r.settings.waiting_list.forceWaitinglist,itemsAvailabilityData:u,hasAvailability:l,allTicketsAreFree:o,eventIsFree:d}),d&&(j.orderInfo=Object(C.a)(Object(C.a)({},a.state.orderInfo),{},{payer:Z})),Object.keys(j).length&&a.setState(j)),document.checkinRegistrationData&&a.autoFillRegistration(r);case 37:case"end":return e.stop()}}),e)}))),a.autoFillRegistration=function(e){var t=!1,n=document.checkinRegistrationData,i={},r=function(e,t){if(e){var n,a=Object(q.a)(e,"NO"),i=null!==(n=null!==t&&void 0!==t?t:a.countryCallingCode)&&void 0!==n?n:"47",r=ji(a.number,{dialCode:i});return{formattedPhone:r,dialCode:i,phone:"+".concat(i).concat(r)}}return{formattedPhone:"",dialCode:"47",phone:"+47"}},s=function(){var e,t=r(n.ticketBuyer.phone,n.ticketBuyer.dialCode),a=n.ticketBuyer.name.split(" ");return{name:n.ticketBuyer.name,firstName:a[0],lastName:a[1],email:n.ticketBuyer.email,phone:t.phone,formattedPhone:t.formattedPhone,dialCode:t.dialCode,payer:null!==(e=n.ticketBuyer.payer)&&void 0!==e?e:"Private"}};if(n&&n.ticketBuyer&&n.tickets){var c=s();if(n.tickets.forEach((function(n,s){var c,o=e.categories.find((function(e){return e.id===n.ticketId}));if(o){if(a.addTicket(o,e.settings,1),n.crm){var d,l,u,m,p,h=r(n.crm.phone,n.crm.dialCode);i["".concat(s,"#").concat(n.ticketId)]={crm:{name:n.crm.name,phone:h.phone,dialCode:h.dialCode,prefix:h.dialCode,countryCode:null!==(d=n.crm.countryCode)&&void 0!==d?d:"NO",email:n.crm.email,address:(null!==(l=n.crm.address)&&void 0!==l?l:(c="address",a.props.event.settings.fields.find((function(e){return e.key===c}))))?{address:"",zipcode:"",city:"",country:"NO"}:null,born:null!==(u=n.crm.born)&&void 0!==u?u:null,first_name:"",last_name:"",sex:null!==(m=n.crm.sex)&&void 0!==m?m:null},properties:null!==(p=n.crm.properties)&&void 0!==p?p:null}}}else t=!0})),!t){a.handleCollapse(ee,he,be),a.usersExplode();var o={},d={},l={WORK_TITLE:"work_title",COMPANY_NAME:"company"};Object.keys(a.state.users).forEach((function(e){if(d[e]=Object(C.a)({},a.state.users[e]),i[e]){d[e].crm=Object(C.a)({},i[e].crm);var t={};i[e].properties&&i[e].properties.forEach((function(e){var n=l[e.type.toUpperCase()];t[n]={key:n,value:e.value}})),d[e].fields=t}})),o.users=d,o.orderInfo=Object(C.a)(Object(C.a)({},a.state.orderInfo),c),a.setState(o),a.handleCollapse(ee,be,fe),n.tickets.forEach((function(t,n){var i=e.categories.find((function(e){return e.id===t.ticketId}));i&&i.additionals&&i.additionals.length>0&&t.additionals.forEach((function(e){var t=i.additionals.find((function(t){return t.id===e.id}));e&&t&&("text"===t.type?a.saveAdditionalTextToCrm(a.state.users["".concat(n,"#").concat(i.id)],t,e.text):"number"===t.type?a.saveAdditionalNumberToCrm(a.state.users["".concat(n,"#").concat(i.id)],t,e.amount):a.saveAdditionalToCrm(a.state.users["".concat(n,"#").concat(i.id)],t))}))}))}}else if(n&&n.ticketBuyer){var u=s(),m={};m.orderInfo=Object(C.a)(Object(C.a)({},a.state.orderInfo),u),a.setState(m)}},a.sessionExpired=function(){window.socketHandler.disconnect(),a.setState({expired:!0})},a.addItemToAvailabilityData=function(e,t){var n;t[e.id]||(t[e.id]={available:e.available,waiting_list:e.waiting_list,left:e.left,campaignQuotaLeft:null===(n=e.campaign)||void 0===n?void 0:n.quotaLeft})},a.inactivityTimer=function(e){var t;if(e){var n=function(){this.state.userIsPassive||this.setPassiveState(!0)},i=function(){this.state.userIsPassive&&this.setPassiveState(!1),clearTimeout(t),t=setTimeout(n.bind(this),12e4)};["mousemove","touchstart","keypress","scroll"].forEach((function(e){document.addEventListener(e,i.bind(Object(N.a)(a)),!0)})),i.bind(Object(N.a)(a))()}},a.setPassiveState=function(e){a.setState({userIsPassive:e})},a.saveTouchedAdditionalCheckboxes=function(){var e=Object(x.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.state.touchedAdditionalCheckboxes.includes(t)){e.next=3;break}return e.next=3,a.setState({touchedAdditionalCheckboxes:[].concat(Object(k.a)(a.state.touchedAdditionalCheckboxes),[t])});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.showErrorHelper=function(){a.setState({showErrors:!0}),setTimeout((function(){a.setState({showErrors:!1})}),500)},a.setPaymentSuccessful=function(e){a.setState({paymentSuccessful:e},(function(){a.state.paymentSuccessful&&a.props.event&&a.props.event.settings.texts.thankyou_url&&(window.onbeforeunload=null,window.location!==window.parent.location?window.open(a.props.event.settings.texts.thankyou_url,"_parent"):window.location.href=a.props.event.settings.texts.thankyou_url)}))},a.setCustomerId=function(e){a.setState({customerId:e})},a.setTimerStart=function(e){a.setState({timerStart:e})},a.setDidReserve=function(e){a.setState({didReserve:e})},a.setDidReserveAdditional=function(e){a.setState({didReserveAdditional:e})},a.setAdditionalChangedKey=function(e){a.setState({additionalChangedKey:e})},a.setTicketAdditionalChangedId=function(e){a.setState({ticketAdditionalChangedId:e})},a.setUserVatToZero=function(e){if(a.props.apolloState.activeMode===z){var t=Object(C.a)({},a.state.users[e]);t.vat=0,a.setState({users:Object(T.a)({},e,t)})}else if(a.props.apolloState.activeMode===H){var n=Object(C.a)({},a.state.users);for(var i in a.state.users){a.state.users[i].id===e&&(n[i].vat=0)}a.setState({users:n})}},a.resetUserVat=function(e){if(a.props.apolloState.activeMode===z){var t=Object(C.a)({},a.state.users[e]);t.vat=t.ticket.vat,a.setState({users:Object(T.a)({},e,t)})}else if(a.props.apolloState.activeMode===H){var n=Object(C.a)({},a.state.users);for(var i in a.state.users){var r=a.state.users[i];r.id===e&&(n[i].vat=r.ticket.vat)}a.setState({users:n})}},a.resetState=function(){var e=a.setPriceModeAndPayer(a.props.event);a.setState(Object(C.a)(Object(C.a)({},a.getInitialState()),{},{convertedAdditionals:a.state.convertedAdditionals,itemsAvailabilityData:a.state.itemsAvailabilityData,allTicketsAreFree:a.state.allTicketsAreFree,eventIsFree:a.state.eventIsFree,hasAvailability:a.state.hasAvailability,holdBackInvoice:a.state.holdBackInvoice,forceWaitinglist:a.state.forceWaitinglist},e))},a.orderProcessor=function(){var e=Ki.orderProcessor(Object(N.a)(a));a.setState({users:e.users,additionals:e.additionals},(function(){a.runCalculateTicketFee()}))},a.setPaymentOption=function(e){var t=a.state.paymentInfo.paymentOption;e.includes(t)||a.setState({paymentInfo:Object(C.a)(Object(C.a)({},a.state.paymentInfo),{},{paymentOption:e[0]})})},a.validateCoupon=function(){var e=Object(x.a)(y.a.mark((function e(t){var n,i,r,s,c,o,d;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state,i=n.coupon,r=n.settings,s=i.code.trim(),a.setState({coupon:Object(C.a)(Object(C.a)({},i),{},{code:s,loading:!0})}),e.prev=3,e.next=6,a.props.client.query({query:Re,variables:{id:Number(document.event_id),coupon:s}});case 6:c=e.sent,Object.keys(r).length<1?((o=Object(C.a)({},a.props.event.settings)).discounts.push(c.data.eventCouponValidate),a.setState({coupon:Object(C.a)(Object(C.a)({},i),{},{code:s,error:{},addedCoupon:!0,loading:!1}),settings:o}),a.orderProcessor()):((d=Object(C.a)({},a.state.settings)).discounts.push(c.data.eventCouponValidate),a.setState({coupon:Object(C.a)(Object(C.a)({},i),{},{code:s,error:{},addedCoupon:!0,loading:!1}),settings:d}),a.orderProcessor()),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),a.setState({coupon:{code:"",error:e.t0,loading:!1}});case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}(),a.validateAllFields=function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=a.state,i=n.orderInfo.payer,r=n.paymentInfo,s=r.paymentOption,c=r.invoiceEmail,o=a.props.event.type,d={},l=!0,u=new si,m=Object(C.a)({},a.state.users),p=Object(C.a)({},a.state.additionals),h=function(e){d[e]&&d[e].hasError?l=!1:delete d[e]};if(a.props.apolloState.activeMode!==z&&"TICKETS"!==o&&Object.values(m).forEach((function(e){var t=ci(a.saveTicketError,e,!0);Object.keys(t).length&&(l=!1,m[e.id]=Object(C.a)(Object(C.a)({},a.state.users[e.id]),{},{errors:t}))})),t){var b=[],f=Object.values(a.state.convertedAdditionals).filter((function(e){return e.required}));oi(f,p,b),b.forEach((function(e){if(!isNaN(e)){var t=p[e]?p[e]:null;if(!t){var n=f.find((function(t){return t.id===e}));if("multicheckbox"===n.type)for(var a=0,i=Object.values(n.children);a<i.length;a++){var r=i[a];if(p[r.id]){t=p[r.id];break}}}var s=u.required(t);d[e]=s,h(e)}}));var v=Object(C.a)(Object(C.a)({},a.state.orderInfo),a.state.paymentInfo),j=["name","email","phone"];j.forEach((function(e){d[e]=u[e](v[e]),h(e)}));var g=a.getFields();if(i===J){var O=["companyName","address","zipcode","city"],y=g.find((function(e){return"orgnr"===e.key}));if(y&&y.required&&O.push("orgNo"),O.forEach((function(e){d[e]=u[e](v[e]),h(e)})),s===K){var x=u.invoiceEmail(c);x&&x.hasError&&(l=!1,d.invoiceEmail=x)}else d.invoiceEmail=null}}return Object.values(a.state.users).forEach((function(t){t.min_tickets&&t.min_tickets>a.getAmountOfCategory(t)&&(l=!1,d[(e=t).category_id]=fa(e))})),a.setState({errors:d,users:m,additionals:p}),l},a.saveError=function(e){a.setState({errors:e})},a.saveTicketError=function(e,t){a.setState({users:Object(C.a)(Object(C.a)({},a.state.users),{},Object(T.a)({},t.id,Object(C.a)(Object(C.a)({},a.state.users[t.id]),{},{errors:e})))})},a.getAmountOfCategory=function(e){var t=a.state,n=t.users,i=t.hasLockedTicketForm,r=Object.values(n).filter((function(t){return function(t){return t.category_id===e.category_id}}));return i?r.length>0?r.length:0:e.id in n?n[e.id].number:0},a.getAmountOfAdditional=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=0,r=0;if(n){var s=Object.values(a.state.additionals).filter((function(t){return t.child_id?t.child_id===e:t.id===e}));s[0]&&(i=s[0].number,r=s[0].onWaiting)}else Object.values(a.state.users).forEach((function(n){Object.values(n.additionals).filter((function(a){return t?a.id===e&&n.id===t:a.child_id?a.child_id===e:a.id===e})).forEach((function(e){i+=e.number,e.onWaiting&&("boolean"===e.onWaiting?r++:r+=e.onWaiting)}))}));return{amount:i,onWaiting:r}},a.validateTicketAmount=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.state,t=!0;return Object.values(e.users).forEach((function(e){e.min_tickets&&e.min_tickets>a.getAmountOfCategory(e)&&(t=!1)})),!!window.socketHandler.isQueueComplete(Ui)&&t},a.validateOrgNo=function(){var e=Object(x.a)(y.a.mark((function e(t){var n,i,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.state.settings.payment_methods.includes(Q)){e.next=11;break}if(!(t.length<6)){e.next=5;break}a.setState({validOrgNo:!1}),e.next=11;break;case 5:return e.next=7,a.props.client.query({query:Me,variables:{orgNr:t}});case 7:n=e.sent,i=n.data.ehfLookup,r=null!==i&&(!![!0,!1].includes(i.invoice)&&i.invoice),a.setState({validOrgNo:r});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleValidation=function(e){var t=e.target,n=Object(C.a)({},a.state.errors),i=a.state.orderInfo,r=(new si)[t.name](t.value),s=a.getFields();r&&r.hasError?(n[t.name]=r,"orgNo"!==t.name||s.map((function(e){return e.key})).includes("orgnr")&&(!s.map((function(e){return e.key})).includes("orgnr")||s.find((function(e){return"orgnr"===e.key})).required)||delete n.orgNo):(delete n[t.name],i.address&&i.address.length&&delete n.address,i.orgNo&&i.orgNo.length&&delete n.orgNo,i.zipcode&&i.zipcode.length&&delete n.zipcode,i.city&&i.city.length&&delete n.city,"email"!==t.name&&"invoiceEmail"!==t.name||delete n.invoiceEmail),Object(W.a)(n,a.state.errors)||a.setState({errors:n})},a.getOrderDataForAnalytics=function(){return function(e){var t,n,a={sum:Ii(e.sumTicketFee,e.users,!0,!0,e.additionals),coupon:e.coupon.code,items:[],eventName:e.eventName},i={},r={};return Object.values(e.users).forEach((function(e){i[e.ticket.id]={id:e.ticket.id,name:e.ticket.name,price:e.ticket.price,quantity:i[e.ticket.id]?i[e.ticket.id].quantity+1:1,type:"ticket"},e&&void 0!==e.additionals&&Object.keys(e.additionals).length>0&&Object.values(e.additionals).forEach((function(e){console.log("Additional: ",e),e&&(r[e.id]={id:e.id,name:e.name,price:e.price,quantity:r[e.id]?r[e.id].quantity+e.number:e.number,type:"ticket_additional"})}))})),(t=a.items).push.apply(t,Object(k.a)(Object.values(i).map((function(e){return e})))),(n=a.items).push.apply(n,Object(k.a)(Object.values(r).map((function(e){return e})))),a}(a.state)},a.handleNewSubmit=function(e){a.validateAllFields()&&e()},a.handleSubmit=function(e,t){try{Zi.dispatchEvent(Gi.CHECKOUT_INITIATED,{event:Gi.CHECKOUT_INITIATED,data:{orderType:a.orderIsFree()?"free":"paid",orderData:a.getOrderDataForAnalytics(),paymentMethod:a.state.paymentInfo.paymentOption}})}catch(I){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:Gi.CHECKOUT_INITIATED,data:{orderType:a.orderIsFree()?"free":"paid",paymentMethod:a.state.paymentInfo.paymentOption}}})}e.preventDefault();var n=a.props.apolloState.activeMode,i=a.state,r=i.coupon.code,s=i.orderInfo,c=s.firstName,o=s.lastName,d=s.formattedPhone,l=s.email,u=s.payer,m=s.address,p=s.city,h=s.companyName,b=(s.countryCode,s.companyCountry),f=s.dialCode,v=s.orgNo,j=s.zipcode,g=s.reference,O=s.name,y=i.paymentInfo,x=y.paymentOption,k=y.invoiceEmail,T=i.additionals;if(a.validateAllFields()){var E={variables:Object(C.a)({language:a.context.language,payment_form:a.orderIsFree()?null:x,event_id:Number(document.event_id),contact_crm:{first_name:c,last_name:o,email:l,tlf:Number(d),prefix:Number(f)},coupon:r.toUpperCase(),reference:g.trim(),users:n===H?hi(Object(C.a)(Object(C.a)({},a.state),{},{eventType:a.props.event.type})):pi(Object(C.a)({},a.state)),billing_crm:u===Z?null:{name:h.trim(),org_nr:v.replace(/\s/g,""),ehf:x===Q,email_invoice:k.trim(),address:{types:"WORK",address:m.trim(),zip:di(j)?j.trim():"1",city:p.trim(),country:b.toUpperCase().trim()}},mode:n,additionals:bi(T)},mi())};if(!E.variables.contact_crm.first_name&&!E.variables.contact_crm.last_name){D.b("First name and lastname are null",{level:F.a.Critical,tags:{name:O}});var S=fi(O),N=S.first_name,_=S.last_name;E.variables.contact_crm.first_name=N,E.variables.contact_crm.last_name=_}Ke["Idempotency-Key"]=Ve,t(E)}},a.handleCompanyChange=function(e,t){var n=t.newValue,i=a.state.orderInfo;e.preventDefault(),a.setState({orderInfo:Object(C.a)(Object(C.a)({},i),{},{companyName:n})})},a.handleCompanyInfo=A()((function(e){a.validateOrgNo(e.organisasjonsnummer);var t=a.state.orderInfo;a.setOrderInfoCountry(e.forretningsadresse.landkode,J);var n={companyName:e.navn,orgNo:e.organisasjonsnummer,address:e.postadresse?e.postadresse.adresse.join(", "):e.forretningsadresse.adresse.join(", "),zipcode:e.postadresse?e.postadresse.postnummer:e.forretningsadresse.postnummer?e.forretningsadresse.postnummer:"0",city:e.postadresse?e.postadresse.poststed:e.forretningsadresse.poststed};a.setState({orderInfo:Object(C.a)(Object(C.a)({},t),n)},(function(){a.setState({orderInfo:Object(C.a)(Object(C.a)({},t),n)})}))}),1e3),a.handlePhoneChange=function(e,t){var n=a.state.orderInfo,i=Object(C.a)({},a.state.errors),r=ji(e.target.value,t),s=(new si)[e.target.name](e.target.value);s&&s.hasError?i.phone=s:delete i.phone;var c={orderInfo:Object(C.a)(Object(C.a)({},n),{},{phone:e.target.value,formattedPhone:r,countryCode:t.countryCode,dialCode:t.dialCode})};Object(W.a)(i,a.state.errors)||(c.errors=i),a.setState(Object(C.a)({},c))},a.handleSplitName=function(e){var t=e.target,n=a.state.orderInfo,i=Object(C.a)({},a.state.errors),r=(new si).name(t.value),s=fi(t.value),c=s.first_name,o=s.last_name;r&&r.hasError?(i.name=r,Object(W.a)(i,a.state.errors)||a.setState({errors:i})):(delete i.name,a.setState({orderInfo:Object(C.a)(Object(C.a)({},n),{},{name:t.value,firstName:c,lastName:o}),errors:i}))},a.handleChange=function(e){var t=e.target,n=a.state,i=n.orderInfo,r=n.paymentInfo,s=n.coupon;if("ticketBuyerAlsoAttending"===t.name)a.setState({orderInfo:Object(C.a)(Object(C.a)({},i),{},{ticketBuyerAlsoAttending:!i.ticketBuyerAlsoAttending})});else if("email"===t.name)a.setState({paymentInfo:Object(C.a)(Object(C.a)({},r),{},{invoiceEmail:t.value}),orderInfo:Object(C.a)(Object(C.a)({},i),{},Object(T.a)({},t.name,t.value))});else if("invoiceEmail"===t.name)a.setState({paymentInfo:Object(C.a)(Object(C.a)({},r),{},{invoiceEmail:t.value})});else if("paymentOption"===t.name){a.setState({paymentInfo:Object(C.a)(Object(C.a)({},r),{},{paymentOption:t.value})});try{Zi.dispatchEvent(Gi.PROGRESS,{data:{step:Gi.CHECKOUT_STEP_VISITED,orderData:a.getOrderDataForAnalytics()}})}catch(c){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:Gi.CHECKOUT_STEP_VISITED}})}}else"coupon"===t.name?a.setState({coupon:Object(C.a)(Object(C.a)({},s),{},{code:t.value})}):"reference"===t.name?t.value.length<=30&&a.setState({orderInfo:Object(C.a)(Object(C.a)({},i),{},Object(T.a)({},t.name,t.value))}):a.setState({orderInfo:Object(C.a)(Object(C.a)({},i),{},Object(T.a)({},t.name,t.value))})},a.handleCrmChange=function(e,t){var n=e.target,i=a.state.users,r=Object(C.a)(Object(C.a)({},i[t.id]),{},{crm:Object(C.a)(Object(C.a)({},i[t.id].crm),{},{address:i[t.id].crm.address?Object(C.a)({},i[t.id].crm.address):null})});if(n.name.includes("sexGroup")){r.errors=Object(C.a)({},i[t.id].errors);var s=(new si).sex(n.value);null===s?delete r.errors.sex:r.errors.sex=s,r.crm.sex=n.value}if("name"===n.name){var c=fi(n.value),o=c.first_name,d=c.last_name;r.crm=Object(C.a)(Object(C.a)({},r.crm),{},{first_name:o,last_name:d})}var l=a.getFields();if(["address","zipcode","city","country"].includes(n.name))r.crm.address[n.name]=n.value;else{var u=a.getFields().filter((function(e){return!["email","orgnr"].includes(e.key)})).map((function(e){return e.key})),m={};if(u.includes(n.name)&&!n.name.includes("sexGroup")&&"born"!==n.name){var p=l.find((function(e){return e.key===n.name}));m[n.name]={key:n.name,value:n.value,id:p?p.id:null},r.fields=Object(C.a)(Object(C.a)({},r.fields),m)}else n.name.includes("sexGroup")||(r.crm[n.name]=n.value)}var h={users:Object(C.a)(Object(C.a)({},a.state.users),{},Object(T.a)({},t.id,r))};try{Zi.dispatchEvent(Gi.PROGRESS,{data:{step:Gi.PARTICIPANT_INFORMATION_STEP_VISITED}})}catch(f){D.b("Could not dispatch registration events",{level:F.a.Critical,tags:{step:Gi.PARTICIPANT_INFORMATION_STEP_VISITED}})}if(r.checkedSameAs&&("name"===n.name||"email"===n.name)){var b=a.state.checkedSameAsTickets.filter((function(e){return e!==t.category_id}));h.users[t.id]=Object(C.a)(Object(C.a)({},r),{},{checkedSameAs:!1}),h.checkedSameAsTickets=b}a.setState(h)},a.returnAllTicketErrors=function(){var e=a.state.users,t=Object.values(e).filter((function(e){return e&&e.errors?Object.values(e.errors).filter((function(e){return null!==e})).length:e})).map((function(e){return e.id})),n={};a.props.apolloState.activeMode!==z&&t.forEach((function(t){var a;n[t]={hasError:!0,message:(a=Object.keys(e).indexOf(t)+1,Object(vt.jsx)(Ot,{dictionary:{nb:"Billett #".concat(a," inneholder feil"),en:"Ticket #".concat(a," has errors")}}))}}));var i=Object(C.a)({},a.state.errors);return delete i.invoiceEmail,Object(C.a)(Object(C.a)({},i),n)},a.saveAdditionalToCrm=function(){var e=Object(x.a)(y.a.mark((function e(t,n,i){var r,s,c,o,d,l,u,m,p,h,b,f,v=arguments;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=v.length>3&&void 0!==v[3]&&v[3],!i||"radio"!==n.type){e.next=4;break}return e.next=4,a.removeAdditionalFromCrm(t,n);case 4:t&&V(t.ticket,i||n).forEach((function(e){e.preChecked&&a.saveAdditionalToCrm(t,e)})),s=a.state.users,c=t?s[t.id].additionals:a.state.additionals,o=Object(C.a)({},a.state.errors),d=t?Object(C.a)(Object(C.a)({},s[t.id]),{},{errors:Object(C.a)({},s[t.id].errors)}):{errors:o},["checkbox","radio","select","multicheckbox"].includes(n.type)&&n.required&&(l=new si,u=l.required(n.id),d.errors[n.id]=u,d.errors[n.id]||delete d.errors[n.id]),m="multicheckbox"===n.type?i.id:n.id,p=Object(C.a)(Object(C.a)({},c),{},Object(T.a)({},m,{id:n.id,available:i?i.available:n.available,left:i?i.left:n.left,name:n.name,number:1,discount:0,price:i?i.price_ex_vat:n.price_ex_vat,vat:i?i.vat:n.vat,type:i&&"multicheckbox"===n.type?"child":n.type,triggered_by:n.triggered_by,descendants:n.descendants,onWaiting:r})),"multicheckbox"===n.type&&n.minSelectableChoices&&Object.values(p).filter((function(e){return e.parentId===n.parentId})).length>=n.minSelectableChoices&&delete d.errors[n.id],h=!t,n.available&&a.addItemToReserve({id:n.id,type:"additional",additionalType:n.type,waiting:a.getAdditionalReserveWaitingEnum(t,n,h),number:1,key:h?null:t.id,orderMode:a.props.apolloState.activeMode===H?"DEFAULT":"UNSPECIFIED"}),i&&(b=t?t.ticket.additionals[n.id].children[i.id]:a.state.convertedAdditionals[n.id].children[i.id],p[m].descendants=Object(k.a)(b.descendants),p[m].parent_id=n.id,p[m].child_id=i.id,p[m].name="".concat(n.name," - ").concat(i.name),i.available&&a.addItemToReserve({id:i.id,type:"additional",additionalType:"child",waiting:a.getAdditionalReserveWaitingEnum(t,i,h),number:1,key:h?null:t.id,orderMode:a.props.apolloState.activeMode===H?"DEFAULT":"UNSPECIFIED"})),f=t?{users:Object(C.a)(Object(C.a)({},s),{},Object(T.a)({},t.id,Object(C.a)(Object(C.a)({},d),{},{additionals:p})))}:{additionals:p,errors:d.errors},a.setState(f,(function(){a.orderProcessor()})),a.additionalsTouched(t);case 19:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),a.getAdditionalReserveWaitingEnum=function(e,t,n){return n?t.waiting_list?ue:le:e.onWaiting?me:t.waiting_list?ue:le},a.saveAdditionalTextToCrm=function(e,t,n){var i=a.state.users,r=e?i[e.id].additionals:a.state.additionals,s=Object(C.a)(Object(C.a)({},r),{},Object(T.a)({},t.id,{id:t.id,name:t.name,text:n,triggered_by:t.triggered_by,descendants:t.descendants})),c=e?{users:Object(C.a)(Object(C.a)({},i),{},Object(T.a)({},e.id,Object(C.a)(Object(C.a)({},i[e.id]),{},{additionals:s})))}:{additionals:s};a.setState(c),a.additionalsTouched(e)},a.saveAdditionalNumberToCrm=function(e,t,n){var i,r,s=a.state.users,c=e?s[e.id].additionals:a.state.additionals,o=Object(C.a)(Object(C.a)({},c),{},Object(T.a)({},t.id,{available:t.available,discount:0,id:t.id,name:t.name,left:t.left,price:t.price_ex_vat,vat:t.vat,number:+n,onWaiting:e&&e.onWaiting?n:0,type:t.type,triggered_by:t.triggered_by,descendants:t.descendants})),d=!e;t.available&&(Number(null!==(i=null===(r=c[t.id])||void 0===r?void 0:r.number)&&void 0!==i?i:0)!==Number(n)&&a.addItemToReserve({id:t.id,type:"additional",additionalType:t.type,waiting:a.getAdditionalReserveWaitingEnum(e,t,d),number:n,key:d?null:e.id,orderMode:a.props.apolloState.activeMode===H?"DEFAULT":"UNSPECIFIED"}));var l=e?{users:Object(C.a)(Object(C.a)({},s),{},Object(T.a)({},e.id,Object(C.a)(Object(C.a)({},s[e.id]),{},{additionals:o})))}:{additionals:o};a.setState(l,(function(){a.orderProcessor()})),a.additionalsTouched(e)},a.additionalsTouched=function(e){try{e?Zi.dispatchEvent(Gi.PROGRESS,{data:{step:Gi.PARTICIPANT_INFORMATION_STEP_VISITED}}):Zi.dispatchEvent(Gi.PROGRESS,{data:{step:Gi.ORDER_ADDITIONALS_STEP_VISITED}})}catch(t){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:"Participant or order additionals"}})}},a.removeAdditionalFromCrm=function(e,t){var n=a.state.users,i=Object(C.a)({},a.state.errors),r=e?Object(C.a)({},n[e.id]):{errors:i};if(["checkbox","select","number"].includes(t.type)&&t.required){var s=(new si).required(null);r.errors[t.id]=s}var c=e?Object(C.a)({},n[e.id].additionals):Object(C.a)({},a.state.additionals),o=e?it(e).additionals:a.props.event.additionals,d=[];ct(t,c,d),delete c[t.id],d.forEach((function(e){e.triggered_by.filter((function(e){return e!==t.id})).every((function(e){var t=st(e,o),n=t?t.id:e;return t&&c[n]?e!==c[n].child_id:n in c===!1}))&&delete c[e.id]}));var l=!e;if("radio"===t.type&&t.children)Object.values(t.children).forEach((function(t){t.available&&a.addItemToReserve({id:t.id,type:"additional",additionalType:"child",waiting:a.getAdditionalReserveWaitingEnum(e,t,l),number:0,key:e?e.id:null,orderMode:a.props.apolloState.activeMode===H?"DEFAULT":"UNSPECIFIED"})}));else{var u=e?!!n[e.id].additionals:!!t[t.id];t.available&&u&&a.addItemToReserve({id:t.id,type:"additional",additionalType:t.type,waiting:a.getAdditionalReserveWaitingEnum(e,t,l),number:0,key:e?e.id:null,orderMode:a.props.apolloState.activeMode===H?"DEFAULT":"UNSPECIFIED"})}var m=e?{users:Object(C.a)(Object(C.a)({},n),{},Object(T.a)({},e.id,Object(C.a)(Object(C.a)({},r),{},{additionals:c})))}:{additionals:c,errors:r.errors};a.setState(m,(function(){a.orderProcessor()}))},a.handleCrmValidation=function(e,t,n){var i=e.target,r=a.state.users,s=t?Object(C.a)({},r[t.id].errors):Object(C.a)({},a.state.errors),c=new si,o=n?"required":i.name,d=n?t?t.additionals[n.id]:a.state.additionals[n.id]:i.value,l=c[o](d);s[i.name]=l;var u=a.getFields();l&&l.hasError?s.email&&0===i.value.length&&(!u.map((function(e){return e.key})).includes("email")||u.map((function(e){return e.key})).includes("email")&&!u.find((function(e){return"email"===e.key})).required)&&delete s.email:delete s[i.name];var m=t?{users:Object(C.a)(Object(C.a)({},r),{},Object(T.a)({},t.id,Object(C.a)(Object(C.a)({},r[t.id]),{},{errors:s})))}:{errors:s};a.setState(m,(function(){!n||""!==i.value&&0!==+i.value||a.removeAdditionalFromCrm(t,n)}))},a.getIdOfFirstTicket=function(){var e=a.state.users,t={id:0,position:1e3},n=[];return Object.values(e).forEach((function(e){if(!n.includes(e.category_id)){var i=a.props.event.categories.findIndex((function(t){return t.id===e.category_id}));i<t.position&&(t={id:e.category_id,position:i})}})),t.id},a.getFields=function(){return ii(a.props.event)},a.usersExplode=function(){var e=a.state.users,t={};if(!a.state.hasLockedTicketForm){var n=vi(e),i=!1,r=function(e){return a.getFields().find((function(t){return t.key===e}))};Object.keys(n).forEach((function(e){var s=n[e].ticket,c="".concat(e,"#").concat(s.id),o=a.getIdOfFirstTicket(),d={id:c,min_tickets:s.min_tickets,category_id:s.id,name:pt(s,"name",a.context.language),checkedSameAs:!1,available:s.available,hasWaitingList:s.waiting_list,onWaiting:!!n[e].onWaiting&&n[e].onWaiting,ticket:s,number:1,price:s.price_ex_vat,prices:s.prices,vat:s.vat,discount:0,isTouched:!i&&s.id===o,expanded:!i&&s.id===o,errors:{},fields:{},seating:s.seating,crm:{name:"",first_name:"",last_name:"",email:"",phone:"",formattedPhone:"",countryCode:null,address:r("address")?{address:"",zipcode:"",city:"",country:"NO"}:null,born:r("born")?"":null,sex:r("sex")?"":null},additionals:{}};s.id===o&&(i=!0),t[c]=d})),a.setState({users:t,hasLockedTicketForm:!0,initializedUsers:!0},(function(){a.orderProcessor()}))}},a.handleCrmPhone=function(e,t,n){var i=a.state.users,r=Object(C.a)({},n.errors),s=ji(e.target.value,t),c=(new si)[e.target.name](e.target.value);c&&c.hasError?r.phone=c:delete r.phone;var o=Object(C.a)(Object(C.a)({},i[n.id].crm),{},{phone:e.target.value,countryCode:t.countryCode.toUpperCase(),prefix:t.dialCode,formattedPhone:s}),d={users:Object(C.a)(Object(C.a)({},i),{},Object(T.a)({},n.id,Object(C.a)(Object(C.a)({},i[n.id]),{},{crm:o,errors:r})))};if(n.checkedSameAs&&a.state.orderInfo.phone!==e.target.value){var l=a.state.checkedSameAsTickets.filter((function(e){return e!==n.category_id}));d.users[n.id]=Object(C.a)(Object(C.a)({},d.users[n.id]),{},{checkedSameAs:!1}),d.checkedSameAsTickets=l}a.setState(d)},a.addTicket=function(e,t,n){var i=a.state,r=i.users,s=i.orderInfo,c=Object(C.a)(Object(C.a)({},e),{},{additionals:mt(e.additionals)}),o=Object(T.a)({},e.id,e.id in r?r[e.id]:{id:e.id,min_tickets:e.min_tickets,available:e.available,hasWaitingList:e.waiting_list,onWaiting:0,number:0,category_id:e.id,seating:e.seating,discount:0,price:Number(e.price_ex_vat),prices:e.prices,vat:e.vat,ticket:c,additionals:{}});e.onWaiting&&(o[e.id].onWaiting++,e.onWaiting=!1);var d=1;d=n&&n>0?n:e.min_tickets&&0===o[e.id].number?e.min_tickets:1,o[e.id].number+=d;var l=a.props.event.total_left;(o[e.id].available||a.props.event.seatmap||o[e.id].left||"number"===typeof l)&&(a.addItemToReserve(Object(C.a)(Object(C.a)({},o[e.id]),{},{type:"ticket",key:e.id,waiting:a.props.apolloState.activeMode===z?le:o[e.id].hasWaitingList?ue:le})),a.setState({itemReserveQueueComplete:!1}));var u=Object.keys(a.state.settings).length>0?Object(C.a)({},a.state.settings):t,m={users:Object(C.a)(Object(C.a)({},r),o),settings:u,totalQuantity:a.state.totalQuantity+d};!a.singleUnspecifiedOrder(m.users)&&s.ticketBuyerAlsoAttending&&(m.orderInfo=Object(C.a)(Object(C.a)({},s),{},{ticketBuyerAlsoAttending:!1})),a.setState(m,(function(){a.orderProcessor()}));try{Zi.dispatchEvent(Gi.ADD_TO_CART,{data:{items:[{type:"ticket",id:e.id,name:e.name,price:e.price}]}})}catch(p){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:Gi.ADD_TO_CART}})}},a.addTicketAfter=function(e,t){for(var n=a.state.users,i={},r=vi(n),s=function(e){return a.getFields().find((function(t){return t.key===e}))},c=Object(C.a)(Object(C.a)({},e),{},{additionals:mt(e.additionals)}),o=r.length,d="".concat(o,"#").concat(e.id);d in n;)o++,d="".concat(o,"#").concat(e.id);var l={id:d,min_tickets:e.min_tickets,category_id:e.id,name:pt(e,"name",a.context.language),checkedSameAs:!1,available:e.available,hasWaitingList:e.waiting_list,onWaiting:!1,ticket:c,number:1,price:e.price_ex_vat,seating:e.seating,vat:e.vat,discount:0,isTouched:!1,expanded:!1,errors:{},fields:{},crm:{name:"",first_name:"",last_name:"",email:"",phone:"",formattedPhone:"",countryCode:null,address:s("address")?{address:"",zipcode:"",city:"",country:"NO"}:null,born:s("born")?"":null,sex:s("sex")?"":null},additionals:{}};i[d]=l,(l.available||a.props.event.seatmap)&&(a.addItemToReserve({id:e.id,type:"ticket",key:d,waiting:e.waiting_list?ue:le,number:a.getAmountOfCategory({category_id:e.category_id})+1}),a.setState({itemReserveQueueComplete:!1})),a.setState({users:Object(C.a)(Object(C.a)({},n),i),hasLockedTicketForm:!0,totalQuantity:a.state.totalQuantity+l.number},(function(){a.orderProcessor()}))},a.setOrderModeUnspecified=function(e,t){var n=a.props.event.settings.modes;a.props.event.settings&&1===n.length&&n[0]===z&&("add"===t&&e>0&&a.props.apolloState.activeMode===H?Qe.mutate({mutation:os,variables:{mode:z}}).then((function(){a.orderProcessor()})):"remove"===t&&e-1<=1&&Qe.mutate({mutation:os,variables:{mode:"default"}}))},a.removeSeatingTickets=function(){var e=[];Object.keys(a.state.users).forEach((function(t){var n=a.state.users[t];n.seating&&n.seating!==de&&e.push(n)})),e.forEach((function(e){a.removeTicket(e,null,e.number,null)}))},a.removeTicket=function(e,t,n,i){var r,s=a.state,c=s.users,o=s.errors;if(a.setOrderModeUnspecified(a.state.totalQuantity,"remove"),t||i){var d=Object(C.a)({},a.state.users),l=1===Object.keys(d).length;if(n&&i){delete o[i];var u=0;if(a.state.hasLockedTicketForm)for(var m in c)u<n&&c[m].category_id===i&&(l=1===Object.keys(d).length,u++,delete d[m]);else d[i].number-=n;a.setState({users:d,totalQuantity:a.state.totalQuantity-n},(function(){a.updateStateAfterRemovingTickets(i,l)}))}else delete d[t],delete o[e.id],a.setState({users:d,totalQuantity:a.state.totalQuantity-1},(function(){a.updateStateAfterRemovingTickets(e.id,l)}))}else{var p=Object(T.a)({},e.id,e.id in c?c[e.id]:i in c?c[i]:{});n?p[e.id].number-=n:(p[e.id].number--,p[e.id].onWaiting>0&&p[e.id].onWaiting--),function(e){var t=a.props.event.total_left;return e.available||a.props.event.seatmap||e.left||"number"===typeof t}(r=p[e.id])&&(a.addItemToReserve(Object(C.a)(Object(C.a)({},p[e.id]),{},{type:"ticket",waiting:r.hasWaitingList?ue:le})),a.setState({itemReserveQueueComplete:!1})),c[e.id]&&Object.keys(c[e.id].additionals).forEach((function(t){var a=c[e.id].additionals[t];a.number>p[e.id].number&&(n?p[e.id].additionals[a.id].number-=n:p[e.id].additionals[a.id].number--)})),0===p[e.id].number&&delete c[e.id],delete o[e.id],a.setState({users:Object(C.a)(Object(C.a)({},c),p),totalQuantity:n?a.state.totalQuantity-n:a.state.totalQuantity-1,errors:o},(function(){a.orderProcessor()}))}},a.updateStateAfterRemovingTickets=function(e,t){var n=Object(C.a)({},a.state.users),i=a.props.event.categories.find((function(t){return t.id===e}));if(i.available||a.props.event.seatmap){var r=0;for(var s in n)n[s].ticket.id===e&&r++;a.addItemToReserve({id:Number(e),type:"ticket",waiting:i.waiting_list?ue:le,number:r})}a.orderProcessor(),t&&a.resetState();var c=Object.keys(n).filter((function(e){return n[e].isTouched})),o=n[c[c.length-1]]?Object(C.a)({},n[c[c.length-1]]):n[Object.keys(n)[0]];o&&(o.expanded=!0,o.isTouched=!0,a.setState({users:Object(C.a)(Object(C.a)({},n),{},Object(T.a)({},o.id,Object(C.a)(Object(C.a)({},n[o.id]),o)))}))},a.getTicketAvailability=function(e,t){var n=a.props.event.total_left;if(e.digital&&!e.available)return null;if("number"===typeof n&&n<=0)return e.waiting_list&&a.props.apolloState.activeMode===H?Object(vt.jsxs)("p",{children:[va,", ",Za]}):Object(vt.jsx)("p",{className:"w120px",children:va});e&&void 0===t&&(t=e.left);var i=a.state.users;if(e.id in i&&null!==e&&(t=e.left-i[e.id].number),null!==e&&null!==e.left){if(e.left<50&&e.left>0)return e.waiting_list&&a.state.forceWaitinglist?Object(vt.jsxs)("p",{children:[va,", ",Za]}):Object(vt.jsxs)("p",{className:"w120px",children:[e.left," ",e.left>1?In:_n," ",ba]});if(e.left<=0)return e.waiting_list&&a.props.apolloState.activeMode===H?Object(vt.jsxs)("p",{children:[va,", ",Za]}):Object(vt.jsx)("p",{className:"w120px",children:va})}return null},a.displayAdditionalAvailability=function(e){var t="availableTickets additional",n=a.state.itemsAvailabilityData[e.id]?a.state.itemsAvailabilityData[e.id].left:e.left;return null!==n&&n<50?n<=0?e.waiting_list&&a.props.apolloState.activeMode===H?Object(vt.jsx)("p",{className:t,children:Za}):Object(vt.jsx)("p",{className:t,children:va}):e.waiting_list&&a.state.forceWaitinglist&&a.props.apolloState.activeMode===H?Object(vt.jsx)("p",{className:t,children:Za}):Object(vt.jsxs)("p",{className:t,children:[n,"\xa0",ba]}):null},a.runCalculateTicketFee=function(){if(a.state.settings.ticket_fee){var e={sumTicketFee:xi(a.state)};a.state.orderHasWaitingItems&&(e.sumTicketFeeWaiting=xi(Object(C.a)(Object(C.a)({},a.state),{},{waitingList:!0}))),a.setState(e)}},a.setPriceModeAndPayer=function(e){if(e){var t={};return t.showVat="inc_vat"===e.customer.price_mode,a.state.eventIsFree?t.orderInfo=Object(C.a)(Object(C.a)({},a.state.orderInfo),{},{payer:Z}):(e.settings.payment_company||e.settings.modes.includes(z)||(t.orderInfo=Object(C.a)(Object(C.a)({},a.state.orderInfo),{},{payer:Z})),e.settings.paymentMethods.corporate.length<=1&&e.settings.paymentMethods.private.length>0&&(t.orderInfo=Object(C.a)(Object(C.a)({},a.state.orderInfo),{},{payer:Z}))),t}},a.orderIsFree=function(){return!(!a.state.holdBackInvoice||!a.state.userIsWaiting)||Ii(a.state.sumTicketFee,a.state.users,!0,!0,a.state.additionals)<=0},a.saveAdditionalsQuantity=function(e,t,n){var i=a.state.users,r=Object(C.a)(Object(C.a)({},i[n.ticket.id].additionals),{},Object(T.a)({},t.id,{id:t.id,name:t.name,available:t.available,discount:0,number:Number(e.target.value),price:t.price_ex_vat,vat:t.vat,onWaiting:0})),s=Object(C.a)(Object(C.a)({},i),{},Object(T.a)({},n.ticket.id,Object(C.a)(Object(C.a)({},i[n.ticket.id]),{},{additionals:r})));[t.id]in s[n.ticket.id].additionals&&0===Number(e.target.value)&&delete r[t.id],t.available&&a.addItemToReserve({id:t.id,type:"additional",waiting:le,key:n.id,number:Number(e.target.value),orderMode:"UNSPECIFIED"}),a.setState({users:s},(function(){a.orderProcessor()}))},a.handleCollapse=function(e,t,n,i){var r=a.state,s=r.components,c=r.users;if(t in c){var o=Object(T.a)({},t,Object(C.a)(Object(C.a)({},c[t]),{},{isTouched:!0,expanded:!c[t].expanded}));n&&e===ee&&(o[n]=Object(C.a)(Object(C.a)({},c[n]),{},{isTouched:!0,expanded:!0})),a.setState({users:Object(C.a)(Object(C.a)({},c),o)},(function(){i&&rr(i)}));try{Zi.dispatchEvent(Gi.PROGRESS,{data:{step:Gi.PARTICIPANT_INFORMATION_STEP_VISITED}})}catch(p){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:Gi.PARTICIPANT_INFORMATION_STEP_VISITED}})}}else{var d={};if(t===ne){var l=Object.keys(c).sort().map((function(e){return c[e]})),u=l[l.length-1].id,m=Object(T.a)({},u,Object(C.a)(Object(C.a)({},c[u]),{},{isTouched:!0,expanded:!1}));a.setState({users:Object(C.a)(Object(C.a)({},c),m)}),d[fe]=Object(C.a)(Object(C.a)({},d[fe]),{},{isTouched:!0,expanded:!1}),a.shouldSkipSeatmap()?Wr(a.props.event.additionals,a.state.additionals,a.state.convertedAdditionals).length>0?d[ve]=Object(C.a)(Object(C.a)({},d[ve]),{},{isTouched:!0,expanded:![ve].expanded}):d[je]=Object(C.a)(Object(C.a)({},d[je]),{},{isTouched:!0,expanded:![je].expanded}):d[Oe]=Object(C.a)(Object(C.a)({},d[Oe]),{},{isTouched:!0,expanded:![Oe].expanded})}else t in s&&(d[t]=Object(C.a)(Object(C.a)({},d[t]),{},{isTouched:!0,expanded:!s[t].expanded}),Object.keys(s).forEach((function(e){e!==t&&(d[e]=Object(C.a)(Object(C.a)({},s[e]),{},{expanded:!1}))})),n&&e===ee&&(d[n]=Object(C.a)(Object(C.a)({},d[n]),{},{isTouched:!0,expanded:!0})));a.setState({components:Object(C.a)(Object(C.a)({},s),d)})}},a.fillOrderDetails=function(e){var t=e.id,n=e.checkedSameAs,i=a.state,r=i.users,s=i.orderInfo,c=s.firstName,o=s.lastName,d=s.name,l=s.email,u=s.phone,m=s.formattedPhone,p=s.countryCode,h=s.dialCode,b={first_name:c,last_name:o};b.first_name||b.last_name||(b=fi(d));var f=Object(T.a)({},t,Object(C.a)(Object(C.a)({},r[t]),{},{errors:{},crm:Object(C.a)(Object(C.a)({},r[t].crm),{},{name:n?d:"",first_name:n?b.first_name:"",last_name:n?b.last_name:"",email:n?l:"",phone:n?u:"+".concat(h),formattedPhone:n?m:"",countryCode:n?p.toUpperCase():null,prefix:h})}));a.setState({users:Object(C.a)(Object(C.a)({},a.state.users),f)})},a.handleCheckedSameAs=function(e){var t=a.state.users,n=!e.checkedSameAs,i=n?[].concat(Object(k.a)(a.state.checkedSameAsTickets),[e.category_id]):a.state.checkedSameAsTickets.filter((function(t){return t!==e.category_id}));a.setState({users:Object(C.a)(Object(C.a)({},t),{},Object(T.a)({},e.id,Object(C.a)(Object(C.a)({},t[e.id]),{},{checkedSameAs:n}))),checkedSameAsTickets:i},(function(){a.fillOrderDetails(a.state.users[e.id])}))},a.fillAllTickets=function(){var e=a.state,t=e.users,n=e.orderInfo,i=n.firstName,r=n.lastName,s=n.name,c=n.email,o=n.phone,d=n.formattedPhone,l=n.countryCode,u=n.dialCode,m={};Object.keys(t).forEach((function(e){m[e]=Object(C.a)(Object(C.a)({},t[e]),{},{errors:{},crm:Object(C.a)(Object(C.a)({},t[e].crm),{},{name:s,first_name:i,last_name:r,email:c,phone:o,formattedPhone:d,countryCode:l.toUpperCase(),prefix:u})})})),a.setState({users:m})},a.fillTicketBuyer=Object(x.a)(y.a.mark((function e(){var t,n,i,r,s,c,o,d,l;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props,n=t.event,i=t.client,!(r=Xe())||!r.invite){e.next=19;break}return e.prev=3,s=r.invite.split("_"),e.next=7,i.query({query:Ne,variables:{customer_id:n.customer.id,id:Number(s[0]),hash:s[1]}});case 7:return c=e.sent,o=c.data.crm,e.next=11,tt(o,a.state.orderInfo);case 11:d=e.sent,(l=Object(C.a)({},a.state.paymentInfo)).paymentOption===K&&(l.invoiceEmail=d.email),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),console.error("err",e.t0);case 19:case"end":return e.stop()}}),e,null,[[3,16]])}))),a.singleUnspecifiedOrder=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.state.users;return a.props.apolloState.activeMode===z&&1===Object.keys(e).length&&1===Object.values(e)[0].number},a.getState=function(){return Object(C.a)(Object(C.a)({},a.state),{},{event:a.props.event,apolloState:a.props.apolloState,language:a.context.language})},a.showDebugger=function(){a.setState({showDebugger:!a.state.showDebugger})},a.closeNotEnoughItemsModal=function(e){a.setState({itemsReserved:[]}),a.setState({notEnoughItemsModal:Object(C.a)(Object(C.a)({},a.state.notEnoughItemsModal),{},{isOpen:!1,noTicketsLeft:!1})})},a.getTotalQuantityWithSeating=function(){return Object.values(a.state.users).filter((function(e){return"RESERVED"===e.seating})).length},a.shouldSkipSeatmap=function(){return!a.props.event.seatmap||a.getTotalQuantityWithSeating()<=0},a.state=a.getInitialState(),a}return Object(S.a)(n,[{key:"componentDidUpdate",value:function(e,t){Object.values(this.state.users).length>0&&!this.props.apolloState.hasOrdered?window.onbeforeunload=function(){return""}:window.onbeforeunload=null,this.orderContactInfoHasChanges(t.orderInfo)&&this.updateOrderContactInfo(this.state.orderInfo),t.websocketConnectionState.current!==this.state.websocketConnectionState.current&&this.state.websocketConnectionState.current===se&&Object.keys(this.state.itemsAvailabilityData).forEach((function(e){window.socketHandler.findOrCreate("additional-".concat(e))}))}},{key:"orderContactInfoHasChanges",value:function(e){var t=this.state.orderInfo;return e.phone!==t.phone||e.name!==t.name||e.email!==t.email}},{key:"updateOrderContactInfo",value:function(e){var t=Object(C.a)({},this.state.users);Object.values(t).forEach((function(t){t.checkedSameAs&&(t.crm.phone=e.phone,t.crm.formattedPhone=e.formattedPhone,t.crm.prefix=e.dialCode,t.crm.email=e.email,t.crm.firstName=e.firstName,t.crm.lastName=e.lastName,t.crm.name=e.name)})),this.setState({users:t})}},{key:"render",value:function(){return this.state.eventIsActive?Object(vt.jsxs)(ls.Provider,{value:this.getState(),children:[this.props.children,!1,Object(vt.jsx)(ps,{modalIsOpen:this.state.notEnoughItemsModal.isOpen,closeModal:this.closeNotEnoughItemsModal,allowWaitinglist:this.state.notEnoughItemsModal.allowWaitingList,itemsReserved:this.state.itemsReserved,noTicketsLeft:this.state.notEnoughItemsModal.noTicketsLeft,modalType:this.state.notEnoughItemsModal.modalType,activeMode:this.props.apolloState.activeMode})]}):Object(vt.jsx)(Br,{event:this.props.event})}}]),n}(b.Component);us.contextType=jt;var ms,ps=function(e){var t=e.modalIsOpen,n=e.closeModal,a=e.itemsReserved,i=e.modalType;return Object(vt.jsxs)(P.a,{ariaHideApp:!1,isOpen:t,shouldCloseOnOverlayClick:!1,onRequestClose:function(){n(a)},className:"Modal",overlayClassName:"Overlay",children:[Object(vt.jsx)("h2",{className:"df jcc",children:Ba}),"WAITING"===i&&Object(vt.jsx)("p",{children:Ua}),Object(vt.jsx)("div",{className:"checkin-modal-footer",children:Object(vt.jsx)("button",{type:"button",className:"checkin-text-button",onClick:function(){n(a)},children:Ha})}),Object(vt.jsx)("div",{className:"w60p mauto"})]})},hs=Object(g.d)(g.f,Object(g.e)(Ae,{props:function(e){return{event:e.data.event}},options:function(){return{variables:Je()}}}),Object(g.e)(De,{props:function(e){var t=e.data;return{apolloState:Object(C.a)({},t)}}}))(us),bs=n(80),fs=n(124),vs=n.n(fs),js=n(97),gs=function(e){var t=e.event,n=e.orderHasWaitingItems,a=e.language,i=Object(b.useRef)();return Object(b.useEffect)((function(){window.onbeforeunload=null,rr(i)}),[]),Object(vt.jsx)("div",{className:"registration--body",ref:i,children:Object(vt.jsxs)("div",{className:"registration--start mb60 mt60 confirmation",children:[Object(vt.jsx)("h1",{tabIndex:-1,className:"mb10 mt60",children:En}),Object(vt.jsx)("div",{className:"icons8-green-check-mark-2 green font90"}),Object(vt.jsx)("h3",{children:yn}),t&&t.settings.texts.thankyou?Object(vt.jsx)("div",{className:"mb60 confirmation--description",dangerouslySetInnerHTML:{__html:ht(a)}}):Object(vt.jsx)("p",{className:"mb60",children:xn}),t&&n&&t.settings.waiting_list&&t.settings.waiting_list.confirmationContent&&Object(vt.jsx)("div",{className:"mb60 confirmation--description",dangerouslySetInnerHTML:{__html:bt(a)}})]})})},Os=mr((function(e){return{event:e.event,orderHasWaitingItems:e.orderHasWaitingItems,language:e.language}}))(Object(b.memo)(gs)),ys=function(e){Object.assign({},e);return Object(vt.jsx)("div",{className:"tcenter",children:Object(vt.jsxs)("div",{className:"lds-roller",children:[Object(vt.jsx)("div",{}),Object(vt.jsx)("div",{}),Object(vt.jsx)("div",{}),Object(vt.jsx)("div",{}),Object(vt.jsx)("div",{}),Object(vt.jsx)("div",{}),Object(vt.jsx)("div",{}),Object(vt.jsx)("div",{})]})})},xs=(ms={},Object(T.a)(ms,he,Gi.CHOOSE_TICKETS_STEP_COMPLETED),Object(T.a)(ms,be,Gi.ORDER_CONTACT_STEP_COMPLETED),Object(T.a)(ms,ne,Gi.PARTICIPANT_INFORMATION_STEP_COMPLETED),Object(T.a)(ms,ve,Gi.ORDER_ADDITIONALS_STEP_COMPLETED),Object(T.a)(ms,Oe,Gi.SEATMAP_STEP_COMPLETED),ms),ks=Object(b.forwardRef)((function(e,t){var n=e.totalQuantity,a=e.handleCollapse,i=e.nextName,r=e.current,s=e.target,c=e.targetElement,o=e.usersExplode,d=e.handleValidation,l=e.showErrors,u=e.showErrorHelper,m=e.errors,p=e.fromTicket,h=e.itemReserveQueueComplete,f=e.testId,v=Object(b.useState)(!1),j=Object(U.a)(v,2),g=j[0],O=j[1],y="btn ".concat(p?"":"btn-success"," nextButton ").concat(0===n?"btn-disabled":""," ").concat(l?"errorWiggle":"","\n\t");return 0===n?null:Object(vt.jsxs)("div",{children:[Object(vt.jsx)("button",{"aria-label":"Go to the next step",disabled:0===n||!h,className:y,onClick:function(){if(window.socketHandler&&window.hasAvailability&&window.socketHandler.keepRegistrationAlive(),d()){if(a(ee,r,s,c),xs[r])try{Zi.dispatchEvent(Gi.PROGRESS,{data:{step:xs[r]}})}catch(e){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:xs[r]}})}o()}else O(!0),u(),t&&rr(t)},"data-testid":f,children:h?Object(vt.jsxs)(vt.Fragment,{children:[Object(vt.jsx)("span",{children:i})," ",p&&Object(vt.jsx)("i",{className:"icons8-forward"})]}):Object(vt.jsx)("span",{className:"btn-loader-spin",children:Object(vt.jsx)(vs.a,{type:"TailSpin",color:"white",height:"30",width:"30"})})}),Object.keys(m).length>0&&g&&Object(vt.jsx)("span",{role:"alert",className:"tright db errorMessages mt5",children:ia})]})}));ks.defaultProps={totalQuantity:1,usersExplode:function(){},handleValidation:function(){return!0},nextName:"",showErrors:!1,showErrorHelper:function(){},ref:null,errors:{},targetElement:null,itemReserveQueueComplete:!0};var Cs=Object(b.memo)(ks),Ts=function(e){return[{value:"en",label:"English"},{value:"nb",label:"Norwegian"}].map((function(t){return Object(vt.jsx)("option",{value:t.value,"aria-label":t.label,"aria-selected":t.value===e,children:"nb"===t.value?"NO":t.value.toUpperCase()},t.value)}))},Es=mr((function(e){return{itemsAvailabilityData:e.itemsAvailabilityData,totalQuantity:e.totalQuantity,components:e.components,hasLockedTicketForm:e.hasLockedTicketForm,usersExplode:e.funcs.usersExplode,handleCollapse:e.funcs.handleCollapse,showErrors:e.showErrors,showErrorHelper:e.funcs.showErrorHelper,validateTicketAmount:e.funcs.validateTicketAmount,getSum:Ii(e.sumTicketFee,e.users,e.showVat,!1),eventIsOpen:e.funcs.eventIsOpen,users:e.users,itemReserveQueueComplete:e.itemReserveQueueComplete,didReserve:e.didReserve,timerStart:e.timerStart,setTimerStart:e.funcs.setTimerStart,temporaryCategories:e.temporaryCategories,setDidReserve:e.funcs.setDidReserve,websocketConnectionState:e.websocketConnectionState,allTicketsAreFree:e.allTicketsAreFree}}))((function(e){var t=e.activeMode,n=e.totalQuantity,a=e.hasLockedTicketForm,i=e.usersExplode,r=e.handleCollapse,s=e.showErrors,c=e.showErrorHelper,o=e.validateTicketAmount,d=e.getSum,l=e.eventIsOpen,u=e.itemReserveQueueComplete,m=e.websocketConnectionState,p=e.itemsAvailabilityData,h=e.allTicketsAreFree,f=Object(b.useContext)(jt),v=f.language,j=f.setLanguage;return a?null:Object(vt.jsx)("div",{className:"registration--body",children:Object(vt.jsx)(g.c,{query:Ae,variables:Je(),children:function(e){var a=e.loading,f=e.error,g=e.data;return a||!a&&m.current!==se&&function(e){for(var t=e.length,n=0;n<t;n++)if(e[n].available)return!0;return p.length>0}(g.event.categories)||!window.socketHandler?Object(vt.jsx)(ys,{}):f?Object(vt.jsxs)("div",{children:[Object(vt.jsx)(Qr,{error:f}),Object(vt.jsx)("button",{type:"button",className:"btn btn-squared btn-default",onClick:function(){return window.location.reload()},children:Oa})]}):Object(vt.jsxs)(b.Fragment,{children:[!l(g.event)&&Object(vt.jsx)("div",{className:"registration mt30 mb30 tcenter admin-only-message",children:Object(vt.jsx)("p",{className:"mb0",children:La})}),Object(vt.jsxs)("div",{className:"df jcsb aic mb10",children:[Object(vt.jsx)("h2",{tabIndex:-1,className:"mb0",id:"choose-tickets",children:Object(vt.jsx)("span",{children:Rt})}),Object(vt.jsx)(Pr,{"data-testid":"language-selector",name:"language-select","aria-label":"Select your preferred language",onChange:j,value:v,createSelectList:Ts})]}),Object(vt.jsx)(ds,{event:g.event,activeMode:t}),Object(vt.jsx)("div",{className:"total-price jcsb df",children:!h&&Object(vt.jsxs)(vt.Fragment,{children:[Object(vt.jsx)("h4",{children:"ex_vat"===g.event.customer.price_mode?an:nn}),Object(vt.jsxs)("div",{className:"df jcfe",children:[Object(vt.jsx)("span",{className:"tright",children:Object(vt.jsx)(ur.a,{value:d,displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("h4",{className:"price","data-testid":"total-price",children:e})}})}),Object(vt.jsx)("h4",{"data-testid":"total-quantity",className:"total-amount",children:n})]})]})}),t===H&&Object(vt.jsx)("div",{className:"checkin-right",children:Object(vt.jsx)(Cs,{testId:"ticket-next",handleValidation:o,showErrors:s,showErrorHelper:c,totalQuantity:n,handleCollapse:r,usersExplode:i,current:he,target:be,nextName:Nt,itemReserveQueueComplete:u})})]})}})})})),Ss=n(999),Ns=function(e){var t=e.modalIsOpen,n=e.toggleModal,a=e.modalMessage,i=e.removeOrPutOnWaiting,r=e.itemTypeValidation;return Object(vt.jsx)(Ss.a,{enabled:t,children:Object(vt.jsxs)(P.a,{ariaHideApp:!1,isOpen:t,onRequestClose:n,className:"CheckinOrderModal",overlayClassName:"Overlay",shouldCloseOnOverlayClick:!1,shouldCloseOnEsc:!1,children:[Object(vt.jsx)("h2",{children:oa}),Object(vt.jsx)("div",{className:"mb20",children:a}),Object(vt.jsx)("div",{className:"checkin_registration",children:Object(vt.jsx)("div",{className:"center",children:Object(vt.jsx)("button",{type:"button",className:"btn-no-margin btn-success",onClick:Object(x.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n().then((function(){i(r)})).catch((function(e){return console.log(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),children:Nt})})})]})})},_s=function(e,t,n){var a=0;return Object.keys(n).forEach((function(i){var r=n[i];if(r.category_id!==t.category_id){var s=r.additionals[e.id];Object(Li.isNullOrUndefined)(s)||(a+=s.number)}})),a},Is=function(e,t,n){var a=[],i=0;i=t&&null!==t.left&&!Object(Li.isNullOrUndefined)(e)?t.left-_s(t,e,n)>e.number?e.number:t.left-_s(t,e,n):e.number;for(var r=0;r<=i;r++)a.push(Object(vt.jsx)("option",{value:r,children:r},r));return a},ws=function(e){Object(_.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(E.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={orderItemsList:[],modalMessage:[],modalIsOpen:!1,data:[]},e.toggleModal=Object(x.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({modalIsOpen:!e.state.modalIsOpen});case 1:case"end":return t.stop()}}),t)}))),e.removeOrPutOnWaiting=Object(x.a)(y.a.mark((function t(){var n,a,i,r;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=e.state.orderItemsList).length>0)for(a=n.length,i=0;i<a;i++)(r=n[i]).category_id,r.waiting,r.amount,r.hasWaitingList,e.props;case 2:case"end":return t.stop()}}),t)}))),e.componentDidUpdate=function(){},e.reservationReserveClickTimer=function(){setTimeout((function(){var t=e.props,n=t.setDidReserveAdditional,a=t.timerStart,i=t.totalQuantity,r=t.didReserveAdditional;if(!r&&i>0){var s=Date.now()-a;Math.floor(s/1e3)>=1?(e.validateAdditionals(),n(!0)):e.reservationReserveClickTimer(r)}}),1e3)},e.validateAdditionals=function(){e.setState({orderItemsList:[],modalMessage:[]}),(e.props,void e.state.data).then((function(t){e.setState({modalMessage:t.modalMessage,orderItemsList:t.orderItemsList,modalIsOpen:t.modalIsOpen}),e.forceUpdate()}))},e.shouldDisable=function(t,n){var a=e.props,i=a.ticket,r=a.users,s=a.temporaryAdditionals,c=s.length>0?s.find((function(e){return e.id===t.id})):null;return!n||null!==n.left&&(0===n.left||n.left<0)||!(null===n.available||!c)&&(n.left===_s(t,i,r)&&0===e.getAmountAdditional(t))},e.updateDataAndShowDropdowns=function(){var t=e.props,n=t.ticket,a=t.users,i=t.saveAdditionalsQuantity,r=t.showVat,s=t.setDidReserveAdditional,c=t.setTimerStart,o=t.setAdditionalChangedKey,d=t.setTicketAdditionalChangedId,l=t.getUserTranslatedText,u=n.ticket.additionals;return dt(n).map((function(t){var m=u[t],p=e.props.data.event.categories.find((function(e){return e.id===a[n.ticket.id].category_id})).additionals.find((function(e){return e.id===m.id}));return m.price&&m.price>0?Object(vt.jsxs)("div",{className:"ticket--additionals--single",children:[Object(vt.jsxs)("div",{className:"df aic",children:[Object(vt.jsx)("h5",{className:"ticket--additionals--title",children:l(m,"name")}),Object(vt.jsx)("p",{className:"price tright light ticket--additionals--price",children:m.price_ex_vat?Object(vt.jsx)(ur.a,{value:$e(r,m),displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}}):null})]}),m.description&&Object(vt.jsx)("small",{className:"dangerousDescription",dangerouslySetInnerHTML:{__html:l(m,"description")}}),Object(vt.jsx)("div",{className:"df jcfe",children:Object(vt.jsx)(Pr,{disabled:e.shouldDisable(m,p),onChange:function(e){i(e,m,n),d(n.category_id),o(m.id),s(!1),c(Date.now())},name:"additionalsQuantity",value:e.getAmountAdditional(m),createSelectList:function(){return Is(n,p,a)}})})]},m.id):null}))},e}return Object(S.a)(n,[{key:"getAmountAdditional",value:function(e){var t=this.props,n=t.ticket,a=t.users[n.ticket.id].additionals;return e.id in a?a[e.id].number:0}},{key:"render",value:function(){var e=this.props,t=e.ticket,n=(e.userIsPassive,e.getUserTranslatedText);return Object(vt.jsxs)("div",{className:"ticket--additionals",children:[Object(vt.jsxs)("div",{className:"ticket--additionals--header df jcsb mb30",children:[Object(vt.jsx)("div",{className:"df flex-wrap-wrap ticket--additionals--header--title",children:Object(vt.jsx)("h3",{className:"mb0 pr10",children:n(t.ticket,"name")})}),Object(vt.jsxs)("p",{className:"light ticket--additionals--header--amount",children:["(",t.number," ",t.number>1?In:_n,")"]})]}),this.updateDataAndShowDropdowns(),this.state.modalIsOpen&&Object(vt.jsx)(Ns,{modalIsOpen:this.state.modalIsOpen,toggleModal:this.toggleModal,modalMessage:this.state.modalMessage,removeOrPutOnWaiting:this.removeOrPutOnWaiting})]})}}]),n}(f.a.Component),As=Object(g.d)(mr((function(e){return{didReserveAdditional:e.didReserveAdditional,setTicketAdditionalChangedId:e.funcs.setTicketAdditionalChangedId,ticketAdditionalChangedId:e.ticketAdditionalChangedId,setAdditionalChangedKey:e.funcs.setAdditionalChangedKey,setTimerStart:e.funcs.setTimerStart,users:e.users,setDidReserveAdditional:e.funcs.setDidReserveAdditional,timerStart:e.timerStart,totalQuantity:e.totalQuantity,temporaryAdditionals:e.temporaryAdditionals,activeMode:e.apolloState.activeMode,removeAdditionalFromCrm:e.funcs.removeAdditionalFromCrm,additionalChangedKey:e.additionalChangedKey,saveAdditionalsQuantity:e.funcs.saveAdditionalsQuantity,showVat:e.showVat,userIsPassive:e.userIsPassive,getUserTranslatedText:function(t,n){return pt(t,n,e.language)}}})),Object(g.e)(Ae,{props:function(e){return{data:e.data}},options:function(){return{variables:Je()}}}))(ws),Rs=function(e){var t=e.users;return function(e){return Object.keys(e).map((function(t){return Object.keys(e[t].ticket.additionals).filter((function(n){return"checkbox"===e[t].ticket.additionals[n].type&&e[t].ticket.additionals[n].price>0}))})).some((function(e){return e.length}))}(t)&&Object(vt.jsxs)("section",{className:"registration--body",role:"group","aria-labelledby":"unspecified_additional",children:[Object(vt.jsx)("h2",{id:"unspecified_additional",children:Rn}),Object.keys(t).map((function(e){return dt(t[e]).length>0&&Object(vt.jsx)(As,{ticket:t[e]},e)}))]})},Ps=mr((function(e){return{users:e.users}}))(Object(b.memo)(Rs)),Ds=Object(b.memo)((function(e){var t,n=e.name,a=e.handleChange,i=e.handleSplitName,r=e.nameError,s=gr(r);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"full-name",labelName:qt,required:!0}),Object(vt.jsx)(hr,(t={id:"full-name",value:n,name:"name",className:jr(r),type:"text","aria-required":!0,"aria-invalid":s,"aria-describedby":s?"full-name-err":null},Object(T.a)(t,"className",jr(r)),Object(T.a)(t,"onChange",a),Object(T.a)(t,"onBlur",i),Object(T.a)(t,"required",!0),t)),vr(r,"full-name-err")]})})),Ms=mr((function(e){return{name:e.orderInfo.name,handleChange:e.funcs.handleChange,handleSplitName:e.funcs.handleSplitName,nameError:e.errors.name}}))(Ds),Fs=function(e){var t=e.email,n=e.handleChange,a=e.handleValidation,i=e.emailError,r=gr(i);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"input-email",labelName:Vt,required:!0}),Object(vt.jsx)(hr,{id:"input-email",value:t,name:"email",className:jr(i),type:"email","aria-required":!0,"aria-invalid":r,"aria-describedby":r?"input-email-err":null,onChange:n,onBlur:a,required:!0}),vr(i,"input-email-err")]})},Ls=mr((function(e){return{email:e.orderInfo.email,handleChange:e.funcs.handleChange,handleValidation:e.funcs.handleValidation,emailError:e.errors.email}}))(Object(b.memo)(Fs)),Ws=n(233),qs=n.n(Ws),Vs=function(e){var t=e.handlePhoneChange,n=e.phoneError,a=e.phone,i=Object(b.useState)("47"),r=Object(U.a)(i,2),s=r[0],c=r[1],o=gr(n);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"contact_phone",labelName:Bt,required:!0}),Object(vt.jsx)(qs.a,{disableAreaCodes:!0,inputProps:{id:"contact_phone",name:"phone",required:!0,autoComplete:"off","aria-required":!0,"aria-invalid":o,"aria-describedby":o?"contact_phone-err":null,onPaste:function(e){var n=e.clipboardData.getData("Text");if("0"==n[0]&&"0"==n[1]&&0===e.target.selectionStart&&(n=n.replace("00","+")),n.includes("+")){var a=Object(q.a)(n,"NO");if(a){var i={countryCode:a.country,dialCode:a.countryCallingCode};e.target.value=a.number,t({target:{value:a.number,name:e.target.name}},i)}}else if(e.target.selectionStart<=1)try{var r="+".concat(s).concat(n),c=Object(q.a)(r);if(c){var o={countryCode:c.country,dialCode:c.countryCallingCode};t({target:{value:c.number,name:e.target.name}},o)}}catch(d){}}},onChange:function(e,n){c(n.dialCode);var a={countryCode:n.countryCode,dialCode:n.dialCode};t({target:{value:"+".concat(e),name:"phone"}},a)},enableTerritories:!0,specialLabel:null,inputClass:jr(n),enableSearch:!0,country:"no",countryCodeEditable:!1,enableSearchField:!0,value:a,onBlur:t}),vr(n,"contact_phone-err")]})},Bs=mr((function(e){return{handlePhoneChange:e.funcs.handlePhoneChange,phoneError:e.errors.phone,phone:e.orderInfo.phone}}))(Object(b.memo)(Vs)),Us=function(){return Object(vt.jsxs)(b.Fragment,{children:[Object(vt.jsx)(Ms,{}),Object(vt.jsx)(Ls,{}),Object(vt.jsx)(Bs,{})]})},Hs=function(e){var t=e.handleChange,n=e.handleValidation,a=e.orgNo,i=e.validateOrgNo,r=e.requireOrgNo,s=e.orgNoError,c=gr(s);return Object(vt.jsxs)("div",{className:"form-group orgNo",children:[Object(vt.jsx)(fr,{htmlFor:"organization-number",labelName:Kt,required:r}),Object(vt.jsx)(hr,{id:"organization-number",required:r,value:a,name:"orgNo",className:jr(s),type:"text","aria-required":r,"aria-invalid":c,"aria-describedby":c?"organization-number-err":null,autoComplete:"off",onChange:function(e){var n={target:{name:e.target.name,value:e.target.value}};t(n)},onBlur:function(e){n(e),i(e.target.value)}}),vr(s,"organization-number-err")]})},zs=mr((function(e){return{orgNo:e.orderInfo.orgNo,handleChange:e.funcs.handleChange,validateOrgNo:e.funcs.validateOrgNo,requireOrgNo:e.event.settings.fields.map((function(e){return e.key})).includes("orgnr")&&e.event.settings.fields.find((function(e){return"orgnr"===e.key})).required,handleValidation:e.funcs.handleValidation,orgNoError:e.errors.orgNo}}))(Object(b.memo)(Hs)),Ks=function(e){var t=e.handleChange,n=e.handleValidation,a=e.errors,i=e.address,r=gr(a.address);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"input-address",labelName:It,required:!0}),Object(vt.jsx)(hr,{id:"input-address",value:i,name:"address",className:jr(a.address),type:"address","aria-required":!0,"aria-invalid":r,"aria-describedby":r?"input-address-err":null,onChange:t,onBlur:n,required:!0}),vr(a.address,"input-address-err")]})},Qs=mr((function(e){return{handleChange:e.funcs.handleChange,handleValidation:e.funcs.handleValidation,errors:e.errors,address:e.orderInfo.address}}))(Object(b.memo)(Ks)),Gs=function(e){var t=e.handleChange,n=e.handleValidation,a=e.zipcodeError,i=e.zipcode,r=gr(a);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"zip-code",labelName:Qt,required:!0}),Object(vt.jsx)(hr,{id:"zip-code",value:i,name:"zipcode",className:jr(a),type:"text","aria-required":!0,"aria-invalid":r,"aria-describedby":r?"zip-code-err":null,onChange:t,onBlur:n,required:!0}),vr(a,"zip-code-err")]})},$s=mr((function(e){return{handleChange:e.funcs.handleChange,handleValidation:e.funcs.handleValidation,zipcodeError:e.errors.zipcode,zipcode:e.orderInfo.zipcode}}))(Object(b.memo)(Gs)),Ys=function(e){var t=e.handleChange,n=e.handleValidation,a=e.cityError,i=e.city,r=gr(a);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"input-city",labelName:wt,required:!0}),Object(vt.jsx)(hr,{id:"input-city",value:i,name:"city",className:jr(a),type:"text","aria-required":!0,"aria-invalid":r,"aria-describedby":r?"input-city-err":null,onChange:t,onBlur:n,required:!0}),vr(a,"input-city-err")]})},Xs=mr((function(e){return{handleChange:e.funcs.handleChange,handleValidation:e.funcs.handleValidation,cityError:e.errors.city,city:e.orderInfo.city}}))(Object(b.memo)(Ys)),Js=function(e){var t=e.handleChange,n=e.reference;return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"input-reference",labelName:Gt}),Object(vt.jsx)(hr,{id:"input-reference",value:n,name:"reference",className:"form-control",type:"text",onChange:t})]})},Zs=mr((function(e){return{handleChange:e.funcs.handleChange,reference:e.orderInfo.reference}}))(Object(b.memo)(Js)),ec=n(512),tc=n.n(ec),nc=n(513),ac=n.n(nc),ic=n(514),rc=n.n(ic),sc=function(e){var t=e.errors,n=e.companyName,a=e.handleValidation,i=e.handleCompanyInfo,r=e.handleCompanyChange,s=Object(b.useState)([]),c=Object(U.a)(s,2),o=c[0],d=c[1],l=A()((function(e){var t=e.value;d(function(e){return e&&e.length>2?u():[]}(t))}),150),u=function(){var e=Object(x.a)(y.a.mark((function e(){var t,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://data.brreg.no/enhetsregisteret/api/enheter?navn=%27".concat(n,"%27&konkurs=false"));case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,d(a._embedded?a._embedded.enheter:[]),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("error:",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),m=gr(t.companyName),p={id:"company-name",name:"companyName",value:n,"aria-required":!0,"aria-invalid":m,"aria-describedby":m?"company-name-err":null,onBlur:a,onChange:r,className:jr(t.companyName),autoComplete:"off",onKeyPress:function(e){13===e.which&&o.length&&i(o[0])}};return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"company-name",labelName:At,required:!0}),Object(vt.jsx)(tc.a,{inputProps:p,suggestions:Array.isArray(o)?o:[],renderSuggestion:function(e,t){var n=t.query,a=ac()(e.navn,n),i=rc()(e.navn,a);return Object(vt.jsxs)("span",{children:[i.map((function(e,t){var n=e.highlight?"react-autosuggest__suggestion-match":"";return Object(vt.jsx)("span",{className:n,children:e.text},t)})),Object(vt.jsx)("br",{}),Object(vt.jsx)("p",{children:e.organisasjonsnummer})]})},getSuggestionValue:function(e){return i(e),e.navn},onSuggestionsFetchRequested:l,onSuggestionsClearRequested:function(){d([])}}),vr(t.companyName,"company-name-err")]})},cc=mr((function(e){return{handleValidation:e.funcs.handleValidation,handleCompanyInfo:e.funcs.handleCompanyInfo,handleCompanyChange:e.funcs.handleCompanyChange,errors:e.errors,companyName:e.orderInfo.companyName}}))(Object(b.memo)(sc)),oc=n(317),dc=n.n(oc),lc=function(e){return dc()().getData().map((function(t){var n=t.value,a=t.label;return Object(vt.jsx)("option",{"aria-selected":n===e,value:n,children:a},n)}))},uc=function(e){var t=e.value,n=e.setOrderInfoCountry,a=e.payer,i=e.identifier;return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:i,labelName:pa,required:!0}),Object(vt.jsx)(Pr,{id:i,name:"country-select",size:"large",onChange:function(e){n(e.target.value,a)},value:t,createSelectList:lc})]})},mc=mr((function(e){return{setOrderInfoCountry:e.funcs.setOrderInfoCountry,orderInfo:e.orderInfo}}))(Object(b.memo)(uc)),pc=function(e){var t=e.orderInfo;return Object(vt.jsxs)(b.Fragment,{children:[Object(vt.jsx)(cc,{}),Object(vt.jsx)(zs,{}),Object(vt.jsx)(Qs,{}),Object(vt.jsxs)("div",{className:"form-col-2--zipcity",children:[Object(vt.jsx)($s,{}),Object(vt.jsx)(Xs,{})]}),Object(vt.jsx)(mc,{value:t.companyCountry,payer:J,identifier:"payer-country"}),Object(vt.jsx)(Zs,{})]})},hc=function(e){var t=e.isTouched,n=e.expanded,a=e.handleCollapse,i=e.current,r=e.withText,s=e.hidden,c=e.ariaLabel,o=e.ariaLabelledBy;return Object(vt.jsx)(bs.AccordionItemTitle,{onClick:function(){a(te,i)},onKeyPress:function(e){[32,13].includes(e.which)&&a(te,i)},style:s?{display:"none"}:null,"aria-hidden":s,"aria-label":c,"aria-labelledby":o,className:"editButton".concat(r?"":" accordion__arrow mlauto"),children:t&&(r?n?Et:St:null)})};hc.defaultProps={isTouched:!1,expanded:!0,withText:!0,hidden:!1};var bc=Object(b.memo)(hc),fc=function(e){Object(_.a)(n,e);var t=Object(I.a)(n);function n(e){var a;return Object(E.a)(this,n),(a=t.call(this,e)).state={modalIsOpen:!1,modalContent:"",modalMessage:[],hasIdentifiedUser:!1,orderItemsList:[],waitingTotal:0,hasClickedNext:!1,hasDigitalTickets:!1},a.toggleModal=Object(x.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({modalIsOpen:!a.state.modalIsOpen});case 1:case"end":return e.stop()}}),e)}))),a.componentDidMount=Object(x.a)(y.a.mark((function e(){var t,n,i,r,s,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.props,n=t.activeMode,i=t.setCustomerId,r=t.users,s=t.setCountryByIp,rr(a.ref,n),"reservation"===n&&a.props.fillTicketBuyer();try{i(a.props.data.event.customer.id)}catch(o){console.error(o)}e.t0=y.a.keys(r);case 5:if((e.t1=e.t0()).done){e.next=14;break}if(c=e.t1.value,!r[c].ticket.digital){e.next=12;break}return a.setState({hasDigitalTickets:!0}),e.next=12,Qe.query({query:we}).then((function(e){e.data.ipLookup&&s(e.data.ipLookup.country)})).catch((function(e){console.error(e)}));case 12:e.next=5;break;case 14:case"end":return e.stop()}}),e)}))),a.componentDidUpdate=function(e){var t=a.props,n=t.orderInfo,i=t.users;t.countryByIP;i==e.users&&n.fromCountry==e.orderInfo.fromCountry&&n.companyCountry==e.orderInfo.companyCountry&&n.payer==e.orderInfo.payer||a.checkIfCountryIsNeeded();var r=e.orderInfo,s=r.name,c=r.email,o=new si;if(["name","email"].map((function(e){var t=o[e](n[e]);return!(t&&t.hasError)})).every((function(e){return e}))&&(!a.state.hasIdentifiedUser||s!==n.name||c!==n.email)){try{Zi.dispatchEvent(Gi.PROGRESS,{data:{step:Gi.ORDER_CONTACT_STEP_VISITED}})}catch(d){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:Gi.ORDER_CONTACT_STEP_VISITED}})}a.setState({hasIdentifiedUser:!0})}},a.checkIfCountryIsNeeded=function(){var e=a.props,t=e.users,n=e.isFromEventCountry,i=e.setUserVatToZero,r=e.resetUserVat,s=!1;for(var c in t){var o=t[c];o.ticket.digital&&(s=!0,n()?n()&&o.vat!=o.ticket.vat&&r(o.id):0!=o.vat&&i(o.id))}a.setState({hasDigitalTickets:s})},a.handleValidation=function(e){var t=a.props,n=t.orderInfo,i=t.saveError,r=t.fillAllTickets,s=t.data,c=!0,o=new si,d=["name","email","phone"],l=["companyName","address","zipcode","city"],u=a.props.data.event.settings.fields.find((function(e){return"orgnr"===e.key}));u&&u.required&&l.push("orgNo");var m={},p=[];p=n.payer===J?[].concat(d,l):d;return p.forEach((function(e){var t;m[e]=o[e](n[e]),m[t=e]&&m[t].hasError?c=!1:delete m[t]})),"payer"===e&&p.forEach((function(e){return!a.props.errors[e]||l.includes(e)?delete m[e]:null})),i(m),a.setState({hasClickedNext:!0}),c&&"TICKETS"===s.event.type&&r(),c},a.renderPayer=function(){var e=a.props,t=e.data,n=e.eventIsFree,i=t.event&&t.event.settings.paymentMethods.corporate.length>1;return!n&&i&&t.event&&t.event.settings.payment_company||t.event&&t.event.settings.modes.includes(z)},a.renderPayerOption=function(){var e=a.props.data;return e.event&&e.event.settings.paymentMethods.private.length>0&&a.renderPayer()},a.ref=f.a.createRef(),a}return Object(S.a)(n,[{key:"getTarget",value:function(){var e=this.props,t=e.data,n=e.shouldSkipSeatmap;return"TICKETS"===t.event.type?n()?t.event.additionals.length>0?ve:je:Oe:fe}},{key:"render",value:function(){var e=this,t=this.props,n=t.activeMode,a=t.orderInfo,i=t.components,r=t.handleChange,s=t.handleCollapse,c=t.showErrors,o=t.showErrorHelper,d=a.payer,l=i[be];return n!==H^!i[be].isTouched?null:Object(vt.jsxs)("div",{className:"registration--body",ref:this.ref,children:[Object(vt.jsxs)(bs.AccordionItem,{expanded:n!==H||i[be].expanded,children:[Object(vt.jsxs)("div",{className:"df jcsb aic",children:[Object(vt.jsx)("h2",{tabIndex:-1,className:"mb0",id:"ticket-buyer",children:Object(vt.jsx)("span",{children:Lt})}),Object(vt.jsx)(bc,{hidden:n!==H,ariaLabelledBy:"ticket-buyer",isTouched:l.isTouched,expanded:l.expanded,handleCollapse:s,current:be})]}),Object(vt.jsxs)(bs.AccordionItemBody,{children:[Object(vt.jsxs)("div",{className:"registration--order",children:[Object(vt.jsx)(Us,{}),this.state.hasDigitalTickets?Object(vt.jsx)("div",{className:"checkin-digital-countryselect",children:Object(vt.jsx)(mc,{value:a.fromCountry,payer:Z,identifier:"ticket-country"})}):null,this.renderPayer()&&Object(vt.jsxs)(b.Fragment,{children:[this.renderPayerOption()&&Object(vt.jsxs)("div",{className:"form-group mt50 mb30",children:[Object(vt.jsx)("h3",{id:"who_pays",children:Ut}),Object(vt.jsxs)("div",{className:"button-group",role:"radiogroup","aria-labelledby":"who_pays",children:[Object(vt.jsx)("button",{type:"button",value:J,name:"payer",role:"radio","aria-checked":d===J,onClick:r,className:"btn btn-default ".concat(d===J?"btn--active":""),children:Ht}),Object(vt.jsx)("button",{type:"button",value:"Private",name:"payer",role:"radio","aria-checked":d===Z,onClick:function(t){r(t),e.handleValidation(t.target.name)},className:"btn btn-default ".concat(d===Z?"btn--active":""),children:zt})]})]}),d===J&&Object(vt.jsxs)(vt.Fragment,{children:[Object(vt.jsx)("h3",{children:Ht}),Object(vt.jsx)(pc,{orderInfo:a})]})]})]}),n===H&&Object(vt.jsx)("div",{className:"checkin-right",children:Object(vt.jsx)(Cs,{testId:"ticket-buyer-next",errors:this.props.errors,showErrorHelper:o,showErrors:c,handleCollapse:s,current:be,target:this.getTarget(),nextName:Nt,handleValidation:this.handleValidation,ref:this.ref})})]})]}),this.state.modalIsOpen&&Object(vt.jsx)(Ns,{modalIsOpen:this.state.modalIsOpen,toggleModal:this.toggleModal,modalMessage:this.state.modalMessage,removeOrPutOnWaiting:this.removeOrPutOnWaiting})]})}}]),n}(f.a.Component),vc=Object(g.d)(mr((function(e){return{fillAllTickets:e.funcs.fillAllTickets,handleChange:e.funcs.handleChange,handleCollapse:e.funcs.handleCollapse,fillTicketBuyer:e.funcs.fillTicketBuyer,runCalculateTicketFee:e.funcs.runCalculateTicketFee,setDidReserve:e.funcs.setDidReserve,saveError:e.funcs.saveError,removeTicket:e.funcs.removeTicket,didReserve:e.didReserve,orderInfo:e.orderInfo,components:e.components,users:e.users,timerStart:e.timerStart,totalQuantity:e.totalQuantity,temporaryCategories:e.temporaryCategories,temporaryAdditionals:e.temporaryAdditionals,ticketAdditionalChangedId:e.ticketAdditionalChangedId,eventIsFree:e.eventIsFree,setTicketAdditionalChangedId:e.funcs.setTicketAdditionalChangedId,removeAdditionalFromCrm:e.funcs.removeAdditionalFromCrm,additionalChangedKey:e.additionalChangedKey,setCustomerId:e.funcs.setCustomerId,setCountryByIp:e.funcs.setCountryByIp,isFromEventCountry:e.funcs.isFromEventCountry,countryByIP:e.countryByIP,setUserVatToZero:e.funcs.setUserVatToZero,resetUserVat:e.funcs.resetUserVat,errors:e.errors,showErrorHelper:e.funcs.showErrorHelper,showErrors:e.showErrors,shouldSkipSeatmap:e.funcs.shouldSkipSeatmap}})),Object(g.e)(Ae,{props:function(e){return{data:e.data}},options:function(){return{forceFetch:!1,fetchPolicy:"cache-only",variables:Je()}}}))(fc),jc=mr((function(e){return{addTicketAfter:e.funcs.addTicketAfter,getTicketAvailability:e.funcs.getTicketAvailability,showVat:e.showVat,getUserTranslatedText:function(t,n){return pt(t,n,e.language)}}}))((function(e){var t=e.showVat,n=e.addTicketAfter,a=e.validateCategories,i=e.toggleAdditionalTicketModal,r=e.getTicketAvailability,s=e.addTicketModalOpen,c=e.users,o=e.event,d=e.getUserTranslatedText;return Object(vt.jsx)(Ss.a,{enabled:s,children:Object(vt.jsxs)(P.a,{ariaHideApp:!1,isOpen:s,onRequestClose:i,className:"CheckinOrderModal",overlayClassName:"Overlay",shouldCloseOnOverlayClick:!0,shouldCloseOnEsc:!0,children:[Object(vt.jsx)("h2",{className:"CheckinOrderModal--title",children:ga}),Object(vt.jsx)("button",{type:"button",className:"Modal--close icon icons8-delete-filled",onClick:i}),o&&o.categories.map((function(e){return e.left&&(e.available>0&&e.available-function(e,t){var n=0;return Object.keys(t).sort().forEach((function(a){var i=t[a];e.id===i.category_id&&n++})),n}(e,c)>0)||null===e.available?Object(vt.jsxs)("div",{className:"checkin_registration checkinAddTicket",children:[Object(vt.jsxs)("div",{className:"df jcsb",children:[Object(vt.jsxs)("div",{className:"modalMessageSection df jcsb w100p aib",children:[Object(vt.jsx)("p",{className:"modalTicketTitle",children:d(e,"name")}),Object(vt.jsx)("span",{className:"tright",children:Object(vt.jsx)("h4",{className:"asc price light",children:Object(vt.jsx)(ur.a,{value:Ge(e,t),displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}})})})]}),Object(vt.jsxs)("div",{className:"modalMessageSection--left",children:[Object(vt.jsx)("button",{type:"button",className:"checkinAddTicket--button",onClick:Object(x.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i(),t.next=3,n(e);case 3:a();case 4:case"end":return t.stop()}}),t)}))),children:ja}),r(e)&&Object(vt.jsx)("div",{className:"availableTickets pl15",children:r(e)})]})]}),Object(vt.jsx)("div",{className:"ticket--description",dangerouslySetInnerHTML:{__html:d(e,"description")}})]},e.id):null}))]})})})),gc="sameAsOrder",Oc=function(e){var t=e.index,n=e.ticket,a=e.handleCheckedSameAs,i="".concat(gc,"-").concat(t);return Object(vt.jsxs)("div",{className:"df aic jcfs form-group",children:[Object(vt.jsx)(hr,{className:"checkbox",name:gc,type:"checkbox",checked:n.checkedSameAs,id:i,onChange:function(){return a(n)}}),Object(vt.jsx)("label",{className:"label",htmlFor:i,children:$t})]})},yc=function(e,t){return e.ticket.checkedSameAs===t.ticket.checkedSameAs},xc=Object(b.memo)(Oc,yc),kc=function(e){var t=e.ticket,n=e.crmName,a=e.handleCrmChange,i=e.handleCrmValidation,r=gr(t.errors.name);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"name-".concat(t.id),labelName:qt,required:!0}),Object(vt.jsx)(hr,{id:"name-".concat(t.id),value:n,name:"name",className:jr(t.errors.name),type:"text","aria-required":!0,"aria-invalid":r,"aria-describedby":r?"name-".concat(t.id,"-err"):null,onChange:function(e){return a(e,t)},onBlur:function(e){return i(e,t)},required:!0}),vr(t.errors.name,"name-".concat(t.id,"-err"))]})},Cc=function(e,t){var n=e.crmName===t.crmName,a=e.ticket.errors===t.ticket.errors;return n&&a},Tc=mr((function(e){return{handleCrmChange:e.funcs.handleCrmChange,handleCrmValidation:e.funcs.handleCrmValidation}}))(Object(b.memo)(kc,Cc)),Ec=function(e){var t=e.ticket,n=e.crmEmail,a=e.handleCrmChange,i=e.handleCrmValidation,r=e.requireEmail,s=gr(t.errors.email);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"email-".concat(t.id),labelName:Vt,required:r}),Object(vt.jsx)(hr,{id:"email-".concat(t.id),required:r,value:n,name:"email",className:jr(t.errors.email),type:"email","aria-required":r,"aria-invalid":s,"aria-describedby":s?"email-".concat(t.id,"-err"):null,onChange:function(e){return a(e,t)},onBlur:function(e){return i(e,t)}}),vr(t.errors.email,"email-".concat(t.id,"-err"))]})},Sc=function(e,t){var n=e.ticket.crm.email===t.ticket.crm.email,a=e.ticket.errors===t.ticket.errors;return n&&a},Nc=mr((function(e){return{handleCrmChange:e.funcs.handleCrmChange,handleCrmValidation:e.funcs.handleCrmValidation,requireEmail:e.event.settings.fields.map((function(e){return e.key})).includes("email")&&e.event.settings.fields.find((function(e){return"email"===e.key})).required}}))(Object(b.memo)(Ec,Sc)),_c=mr((function(e){return{handleCrmChange:e.funcs.handleCrmChange,handleCrmValidation:e.funcs.handleCrmValidation}}))((function(e){var t=e.ticket,n=e.field,a=e.handleCrmChange,i=e.handleCrmValidation,r=Cr(t,n),s=gr(t.errors.address);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"address-".concat(r),labelName:It,required:n.required}),Object(vt.jsx)(hr,{id:"address-".concat(r),value:t.crm.address.address,name:"address",className:jr(t.errors.address),type:"text","aria-required":n.required,"aria-invalid":s,"aria-describedby":s?"address-".concat(r,"-err"):null,onChange:function(e){return a(e,t)},onBlur:function(e){return i(e,t)},required:n.required}),vr(t.errors.address,"address-".concat(r,"-err"))]})})),Ic=mr((function(e){return{handleCrmChange:e.funcs.handleCrmChange,handleCrmValidation:e.funcs.handleCrmValidation}}))((function(e){var t=e.ticket,n=e.field,a=e.handleCrmChange,i=e.handleCrmValidation,r=Cr(t,n),s=gr(t.errors.zipcode);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"zip-code-".concat(r),labelName:Qt,required:!0}),Object(vt.jsx)(hr,{id:"zip-code-".concat(r),value:t.crm.address.zipcode,name:"zipcode",className:jr(t.errors.zipcode),type:"text","aria-required":n.required,"aria-invalid":s,"aria-describedby":s?"zip-code-".concat(r,"-err"):null,onChange:function(e){return a(e,t)},onBlur:function(e){return i(e,t)},required:n.required}),vr(t.errors.zipcode,"zip-code-".concat(r,"-err"))]})})),wc=mr((function(e){return{handleCrmChange:e.funcs.handleCrmChange,handleCrmValidation:e.funcs.handleCrmValidation}}))((function(e){var t=e.ticket,n=e.field,a=e.handleCrmChange,i=e.handleCrmValidation,r=Cr(t,n),s=gr(t.errors.city);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"city-".concat(r),labelName:wt,required:!0}),Object(vt.jsx)(hr,{id:"city-".concat(r),value:t.crm.address.city,name:"city",className:jr(t.errors.city),type:"text","aria-required":n.required,"aria-invalid":s,"aria-describedby":s?"city-".concat(r,"-err"):null,onChange:function(e){return a(e,t)},onBlur:function(e){return i(e,t)},required:n.required}),vr(t.errors.city,"city-".concat(r,"-err"))]})})),Ac=mr((function(e){return{handleCrmChange:e.funcs.handleCrmChange}}))((function(e){var t=e.ticket,n=e.field,a=e.handleCrmChange,i=dc()().getData(),r=Cr(t,n);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"country-".concat(r),labelName:pa,required:!0}),Object(vt.jsx)(Pr,{id:"country-".concat(r),onChange:function(e){return a(e,t)},name:"country",value:t.crm.address.country,createSelectList:function(e){return i.map((function(t){return Object(vt.jsx)("option",{"aria-selected":t.value===e,value:t.value,children:t.label},t.value)}))},size:"full"})]})})),Rc=function(e){var t=e.ticket,n=e.field;return Object(vt.jsxs)(b.Fragment,{children:[Object(vt.jsx)(_c,{ticket:t,field:n}),Object(vt.jsxs)("div",{className:"form-col-2--zipcity",children:[Object(vt.jsx)(Ic,{ticket:t,field:n}),Object(vt.jsx)(wc,{ticket:t,field:n})]}),Object(vt.jsx)(Ac,{ticket:t,field:n})]})},Pc=mr((function(e){return{handleCrmChange:e.funcs.handleCrmChange}}))((function(e){var t=e.ticket,n=e.field,a=e.handleCrmChange;return Object(vt.jsxs)("div",{className:"singleTicket--additional mb20 pb10",role:"radiogroup",children:[Object(vt.jsx)(fr,{medium:!0,labelName:da,required:n.required}),Object.keys(ye).map((function(e){var i={target:{name:"sexGroup-".concat(t.id),value:ye[e]}},r="".concat(t.id,"-").concat(ye[e]);return Object(vt.jsxs)("div",{className:"df aic",children:[Object(vt.jsx)(hr,{className:"checkbox",name:"sexGroup-".concat(t.id),checked:t.crm.sex===ye[e],value:ye[e],type:"radio",id:r,onChange:function(){a(i,t)}}),Object(vt.jsx)(fr,{labelName:r==="".concat(t.id,"-").concat(ye.male)?la:ua,htmlFor:r,required:n.required})]},r)})),vr(t.errors.sex)]})})),Dc=mr((function(e){return{handleCrmChange:e.funcs.handleCrmChange,handleCrmValidation:e.funcs.handleCrmValidation,fields:e.event.settings.fields}}))((function(e){var t=e.ticket,n=e.fieldName,a=e.field,i=e.handleCrmChange,r=e.handleCrmValidation,s=e.fields,c=Cr(t,a),o=gr(t.errors[a.key]);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"text-".concat(c),labelName:n,required:a.required}),Object(vt.jsx)(hr,{id:"text-".concat(c),value:t.fields[a.key]?t.fields[a.key].value:"",name:a.key,className:jr(t.errors[a.key]),type:"text","aria-required":a.required,"aria-invalid":o,"aria-describedby":o?"text-".concat(c,"-err"):null,onChange:function(e){return i(e,t)},onBlur:function(e){return r(e,t)},required:s.required}),vr(t.errors[a.key],"text-".concat(c,"-err"))]})})),Mc=n(234),Fc=mr((function(e){return{handleCrmChange:e.funcs.handleCrmChange,handleCrmValidation:e.funcs.handleCrmValidation}}))((function(e){var t=e.ticket,n=e.fieldName,a=e.field,i=e.handleCrmChange,r=e.handleCrmValidation,s=Object(b.useContext)(jt).language,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.crm[a.key];return{target:{name:"born",value:e}}};return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{labelName:n,required:a.required}),Object(vt.jsx)(Mc.a,Object(C.a)(Object(C.a)({},{placeholder:"nb"===s?"dd.mm.yyyy":"mm/dd/yyyy",format:"nb"===s?"##.##.####":"##/##/####",mask:"nb"===s?["d","d","m","m","y","y","y","y"]:["m","m","d","d","y","y","y","y"]}),{},{value:t.crm[a.key],className:jr(t.errors[a.key]),renderText:function(e){return e},onBlur:function(){return r(c(),t)},onValueChange:function(e){return i(c(e.formattedValue),t)}})),vr(t.errors[a.key])]},a.key)})),Lc=function(e){var t=e.ticket;return e.fields.filter((function(e){return!["email","orgnr"].includes(e.key)})).map((function(e){var n="",a="text";switch(e.key){case"address":return Object(vt.jsx)(Rc,{ticket:t,field:e},e.key);case"work_title":return n=An,Object(vt.jsx)(Dc,{ticket:t,field:e,fieldName:n},e.key);case"company":return n=Ht,Object(vt.jsx)(Dc,{ticket:t,field:e,fieldName:n},e.key);case"sex":return a="radio",Object(vt.jsx)(Pc,{ticket:t,inputType:a,field:e},e.key);case"born":return n=ma,Object(vt.jsx)(Fc,{ticket:t,fieldName:n,field:e},e.key);default:return Object(vt.jsx)(Dc,{ticket:t,field:e,fieldName:e.label},e.key)}}))},Wc=n(1001),qc=function(e){var t=e.ticket,n=e.crmPhone,a=e.handleCrmPhone,i=Object(b.useState)("47"),r=Object(U.a)(i,2),s=r[0],c=r[1],o=gr(t.errors.phone);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"phone-".concat(t.id),labelName:Bt,required:!0}),Object(vt.jsx)(qs.a,{disableAreaCodes:!0,inputProps:{id:"phone-".concat(t.id),name:"phone",required:!0,autoComplete:"off","aria-required":!0,"aria-invalid":o,"aria-describedby":o?"phone-".concat(t.id,"-err"):null,onPaste:function(e){var n=e.clipboardData.getData("Text");if("0"==n[0]&&"0"==n[1]&&0===e.target.selectionStart&&(n=n.replace("00","+")),n.includes("+")){var i=Object(Wc.a)(n),r={countryCode:i.country,dialCode:i.countryCallingCode};a({target:{value:i.number,name:e.target.name}},r,t)}else if(e.target.selectionStart<=1)try{var c="+".concat(s).concat(n),o=Object(Wc.a)(c);if(o){var d={countryCode:o.country,dialCode:o.countryCallingCode};a({target:{value:o.number,name:e.target.name}},d,t)}}catch(l){}}},onChange:function(e,t){c(t.dialCode)},specialLabel:null,inputClass:jr(t.errors.phone),enableTerritories:!0,enableSearch:!0,countryCodeEditable:!1,country:"no",value:n,onBlur:function(e,n){return a(e,n,t)}}),vr(t.errors.phone,"phone-".concat(t.id,"-err"))]})},Vc=mr((function(e){return{handleCrmPhone:e.funcs.handleCrmPhone}}))(Object(b.memo)(qc)),Bc=function(e){Object(_.a)(n,e);var t=Object(I.a)(n);function n(e){var a;return Object(E.a)(this,n),(a=t.call(this,e)).state={hasScrolled:!1},a.componentDidMount=function(){var e=a.props,t=e.index,n=e.ticket,i=e.handleCheckedSameAs,r=e.orderName;0===t&&r.length>0&&!n.checkedSameAs&&a.props.event.uiSettings.sameAsTicketBuyer&&![12485,12675,12666,12837,13137,13139,13138,13141,13142,10233,10150,10005].includes(a.props.event.customer.id)&&i(n)},a.componentDidUpdate=function(e){(!e.ticket.expanded&&a.props.ticket.expanded||a.props.userCrms[0]===a.props.ticket.id&&!a.state.hasScrolled)&&(a.setState({hasScrolled:!0}),rr(a.ref))},a.nextTargetElement=function(e){if(e)return null;var t=document.getElementsByClassName("userDetails"),n=a.props,i=n.index,r=n.userCrms;return void 0!==r[i+1]?{current:t[i+1]}:{current:t[r.length-1]}},a.getNextTarget=function(e){var t=a.props,n=t.index,i=t.userCrms,r=t.hasAdditionals;return e?a.props.shouldSkipSeatmap()?r?ve:je:Oe:void 0!==i[n+1]?i[n+1]:i[i.length-1]},a.nextButton=function(e){var t=a.props,n=t.index,i=t.ticket,r=t.userCrms,s=t.handleCollapse,c=t.showErrorHelper,o=t.showErrors,d=t.hasAdditionals,l=t.orderIsFree,u=t.event,m=_t;e&&(m=un,u.seatmap||d?m=Nt:l()||(m=dn));return Object(vt.jsx)(Cs,{testId:"ticket-details-id",errors:i.errors,ref:a.state.hasScrolled?null:a.ref,showErrorHelper:c,showErrors:o,handleCollapse:s,current:e?ne:r[n],target:a.getNextTarget(e),targetElement:a.nextTargetElement(e),nextName:m,handleValidation:function(){return e?a.props.validateAllFields(!1):ci(a.props.saveTicketError,a.props.ticket)},fromTicket:!1})},a.calculatePrice=function(){var e=a.props.ticket;return yi.a.chain(e.ticket.price_ex_vat).multiply(1+Number(e.vat)/100).round().done()},a.orderHasTicket=function(){return!(!a.props.checkedSameAsTickets.includes(a.props.ticket.category_id)||a.props.ticket.checkedSameAs)},a.ref=f.a.createRef(),a}return Object(S.a)(n,[{key:"render",value:function(){var e=this.props,t=e.index,n=e.ticket,a=e.event,i=e.handleCollapse,r=e.removeTicket,s=e.handleCheckedSameAs,c=e.getUserTranslatedText,o=e.addNewTicketButton,d=e.userCrms,l=e.showErrors,u=t+1,m=d[t]===d[d.length-1],p=gr(Object.values(n.errors)[0]),h="accordionTitle ".concat(p&&l?"errorBackground":"");return Object(vt.jsxs)("div",{role:"listitem",className:"userDetails".concat(n.expanded?" mb30":""),ref:this.ref,children:[Object(vt.jsxs)(bs.AccordionItem,{expanded:n.expanded,children:[Object(vt.jsx)(bs.AccordionItemTitle,{"aria-label":"#".concat(u," ").concat(c(n.ticket,"name")),className:h,onClick:function(){i(te,n.id)},onKeyPress:function(e){[32,13].includes(e.which)&&i(te,n.id)},children:Object(vt.jsxs)("div",{className:"userDetails--header".concat(n.expanded?" userDetails--header--selected":""),children:[Object(vt.jsxs)("div",{className:"leftSection",children:[Object(vt.jsxs)("h3",{className:"ticketName df jcsb",children:["#",u," ",c(n.ticket,"name")]}),n.onWaiting&&Object(vt.jsxs)("p",{children:["(",qa,")"]}),Object(vt.jsx)("p",{className:"price",children:Object(vt.jsx)(ur.a,{value:this.calculatePrice(),displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}})})]}),Object(vt.jsxs)("div",{className:"rightSection",children:[Object(vt.jsx)("span",{className:"".concat(p?"errorMessages":""),children:n.crm.name.length?n.crm.name:Ma}),Object(vt.jsxs)("button",{type:"button","data-testid":"delete-ticket-button","aria-label":"Delete this ticket",className:"deleteTicket df",onClick:function(e){e.stopPropagation(),r(n.ticket,n.id)},children:[Object(vt.jsx)("span",{children:tn}),Object(vt.jsx)("i",{className:"icons8-delete-filled icon"})]})]})]})}),n.expanded&&Object(vt.jsx)(bs.AccordionItemBody,{children:Object(vt.jsxs)("div",{role:"group","aria-labelledby":"attendee-information",children:[Object(vt.jsx)("h3",{className:"attendee-information",id:"attendee-information",children:Object(vt.jsx)("span",{children:Fa})}),this.orderHasTicket()?null:Object(vt.jsx)(xc,{index:t,ticket:n,handleCheckedSameAs:s}),Object(vt.jsx)(Tc,{ticket:n,crmName:n.crm.name}),Object(vt.jsx)(Nc,{ticket:n,crmEmail:n.crm.email}),Object(vt.jsx)(Vc,{ticket:n,crmPhone:n.crm.phone}),Object(vt.jsx)(Lc,{ticket:n,fields:a?a.settings.fields:[]}),Object(vt.jsx)(Vr,{ticket:n}),!m&&Object(vt.jsx)("div",{className:"checkin-right",children:this.nextButton(m)})]})})]}),m&&Object(vt.jsx)("div",{className:"lastTicketButtonSection ".concat(null!==o()?"jcsb":"jcfe"),children:n.expanded&&this.nextButton(m)})]})}}]),n}(f.a.Component),Uc=Object(g.d)(g.f,mr((function(e){return{orderIsFree:e.funcs.orderIsFree,handleCollapse:e.funcs.handleCollapse,removeTicket:e.funcs.removeTicket,handleCheckedSameAs:e.funcs.handleCheckedSameAs,checkedSameAsTickets:e.checkedSameAsTickets,orderName:e.orderInfo.name,saveTicketError:e.funcs.saveTicketError,showErrorHelper:e.funcs.showErrorHelper,showErrors:e.showErrors,hasAdditionals:Wr(e.event.additionals,e.additionals,e.convertedAdditionals).length>0,getUserTranslatedText:function(t,n){return pt(t,n,e.language)},validateAllFields:e.funcs.validateAllFields,shouldSkipSeatmap:e.funcs.shouldSkipSeatmap}})),Object(g.e)(Ae,{props:function(e){return{event:e.data.event}},options:function(){return{fetchPolicy:"cache-only",variables:Je()}}}))(Bc),Hc=function(e){Object(_.a)(n,e);var t=Object(I.a)(n);function n(e){var a;return Object(E.a)(this,n),(a=t.call(this,e)).state={orderItemsList:[],modalMessage:[],modalIsOpen:!1,additionalTicketModalOpen:!1,itemTypeValidation:"",ticketSort:[]},a.toggleModal=Object(x.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({modalIsOpen:!a.state.modalIsOpen});case 1:case"end":return e.stop()}}),e)}))),a.removeOrPutOnWaiting=function(){var e=Object(x.a)(y.a.mark((function e(t){var n,i,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=a.state.orderItemsList).length>0)for(i=0;i<n.length;i++)(r=n[i]).category_id,r.waiting,r.amount,r.hasWaitingList,a.props;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.reservationReserveClickTimer=function(){setTimeout((function(){var e=a.props,t=e.setDidReserveAdditional,n=e.timerStart,i=e.totalQuantity,r=e.didReserveAdditional;if(!r&&i>0){var s=Date.now()-n;Math.floor(s/1e3)>=1?(a.validateAdditionals(),t(!0)):a.reservationReserveClickTimer(r)}}),1e3)},a.validateAdditionals=function(){a.setState({itemTypeValidation:"additional",orderItemsList:[],modalMessage:[]}),(void a.props).then((function(e){a.setState({modalMessage:e.modalMessage,orderItemsList:e.orderItemsList,modalIsOpen:e.modalIsOpen})}))},a.validateCategories=function(){qi({itemsToReserve:a.props.itemsToReserve,resetItemsToReserve:a.props.resetItemsToReserve})},a.toggleAdditionalTicketModal=function(){a.setState({additionalTicketModalOpen:!a.state.additionalTicketModalOpen})},a.getUserCrms=function(){return Object.keys(a.props.users).sort().map((function(e){return a.props.users[e].id}))},a.useTicketSort=function(){var e=a.props,t=e.users,n=e.data,i={},r={};n.event.categories.forEach((function(e,t){i[e.id]=[],r[t]=e.id})),Object.values(t).forEach((function(e){i[e.category_id].push(e.id)}));var s=[];return Object.keys(r).forEach((function(e){s.push.apply(s,Object(k.a)(i[r[e]]))})),s},a.returnTicket=function(){var e=a.props,t=e.users,n=e.data;return a.state.ticketSort.map((function(e,i){var r=t[e];if(!r)return null;if(n.event?n.event.categories.find((function(e){return e.id===r.category_id})):null){var s=function(e){"radio"===r.ticket.additionals[e].type?Object.keys(r.ticket.additionals[e].children).forEach((function(t){var n=r.ticket.additionals[e].children[t];n.available&&a.props.itemsAvailabilityData[t]&&(n.left=a.props.itemsAvailabilityData[t].left)})):r.ticket.additionals[e]&&r.ticket.additionals[e].available&&a.props.itemsAvailabilityData[e]&&(r.ticket.additionals[e].left=a.props.itemsAvailabilityData[e].left)};for(var c in r.ticket.additionals)s(c)}return Object(vt.jsx)(Uc,{index:i,ticket:r,userCrms:a.state.ticketSort,addNewTicketButton:a.addNewTicketButton},i)}))},a.addNewTicketButton=function(){var e=a.props,t=e.users,n=e.data.event,i=Object(vt.jsxs)("button",{type:"button",id:"btn-add-tickets",className:"btn addNewTicket",onClick:a.toggleAdditionalTicketModal,children:[Object(vt.jsxs)("span",{children:[ga," "]}),Object(vt.jsx)("i",{className:"icons8-plus-math-3"})]}),r=vi(t);return n.settings.ticket_limit?r.length<n.settings.ticket_limit?i:null:i},a.ref=f.a.createRef(),a}return Object(S.a)(n,[{key:"componentDidMount",value:function(){rr(this.ref,this.props.activeMode),this.setState({ticketSort:this.useTicketSort()})}},{key:"componentDidUpdate",value:function(e,t){t.ticketSort.length!==Object.keys(this.props.users).length&&this.setState({ticketSort:this.useTicketSort()})}},{key:"render",value:function(){var e=this.props,t=e.activeMode,n=e.handleCollapse,a=e.components,i=e.users,r=(e.userIsPassive,e.data.event),s=a[fe];return a[fe].isTouched&&Object(vt.jsxs)("div",{className:"registration--body",ref:this.ref,children:[Object(vt.jsxs)(bs.AccordionItem,{expanded:t!==H||a[fe].expanded,children:[Object(vt.jsxs)("div",{className:"df jcsb aic",children:[Object(vt.jsx)("h2",{tabIndex:-1,className:"mb0",id:"ticket-details",children:Object(vt.jsx)("span",{children:Yt})}),Object(vt.jsx)(bc,{hidden:t!==H,ariaLabelledBy:"ticket-details",isTouched:s.isTouched,expanded:s.expanded,handleCollapse:n,current:fe})]}),Object(vt.jsx)(bs.AccordionItemBody,{children:Object(vt.jsx)(bs.Accordion,{accordion:!1,children:Object(vt.jsx)("div",{className:"mt20",role:"list",children:this.returnTicket()})})})]}),this.state.additionalTicketModalOpen&&Object(vt.jsx)(jc,{addTicketModalOpen:this.state.additionalTicketModalOpen,event:r,users:i,validateCategories:this.validateCategories,toggleAdditionalTicketModal:this.toggleAdditionalTicketModal}),this.state.modalIsOpen&&Object(vt.jsx)(Ns,{modalIsOpen:this.state.modalIsOpen,toggleModal:this.toggleModal,modalMessage:this.state.modalMessage,removeOrPutOnWaiting:this.removeOrPutOnWaiting,itemTypeValidation:this.state.itemTypeValidation})]})}}]),n}(f.a.Component),zc=mr((function(e){return{itemsAvailabilityData:e.itemsAvailabilityData,handleCollapse:e.funcs.handleCollapse,components:e.components,users:e.users,settings:e.settings,showVat:e.showVat,didReserveAdditional:e.didReserveAdditional,setDidReserveAdditional:e.funcs.setDidReserveAdditional,timerStart:e.timerStart,totalQuantity:e.totalQuantity,ticketAdditionalChangedId:e.ticketAdditionalChangedId,temporaryCategories:e.temporaryCategories,temporaryAdditionals:e.temporaryAdditionals,removeAdditionalFromCrm:e.funcs.removeAdditionalFromCrm,removeTicket:e.funcs.removeTicket,additionalChangedKey:e.additionalChangedKey,userIsPassive:e.userIsPassive,resetItemsToReserve:e.funcs.resetItemsToReserve,itemsToReserve:e.itemsToReserve}}))(Hc),Kc=Object(g.d)(Object(g.e)(Ae,{props:function(e){return{data:e.data}},options:function(){return{fetchPolicy:"cache-only",variables:Je()}}}))(zc),Qc=function(e){var t=e.stateAdditionals,n=e.showVat,a=e.onWaiting,i=e.holdBackInvoice,r=Object.values(t).filter((function(e){return["checkbox","radio","number","child"].includes(e.type)}));return 0===r.length?null:Object(vt.jsxs)("table",{className:"border-bottom-1px",width:"100%",cellSpacing:"0",cellPadding:"0",children:[Object(vt.jsx)("thead",{children:Object(vt.jsxs)("tr",{className:"table-ticket",children:[Object(vt.jsx)("td",{colSpan:"2",width:"50%",children:Wt(!0)}),Object(vt.jsx)("td",{width:"10%"}),Object(vt.jsx)("td",{width:"40%"})]})}),Object(vt.jsx)("tbody",{children:r.map((function(e){var t=0;return!a&&e.number-e.onWaiting>0?t=Ni(e,n,!1,i):a&&e.onWaiting>0&&(t=Ni(e,n,!0)),Object(vt.jsx)(vt.Fragment,{children:!a&&e.number-e.onWaiting>0?Object(vt.jsxs)("tr",{className:"table-ticket table-additional",children:[Object(vt.jsx)("td",{colSpan:"2",children:e.name}),Object(vt.jsx)("td",{className:"tcenter",children:e.number-e.onWaiting>1?e.number-e.onWaiting:""}),Object(vt.jsx)("td",{className:"tright ".concat(0!==+t?"price":""),children:0!==+t&&Object(vt.jsx)(ur.a,{value:t,displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}})})]},e.id):a&&e.onWaiting>0?Object(vt.jsxs)("tr",{className:"table-ticket table-additional",children:[Object(vt.jsx)("td",{colSpan:"2",children:e.name}),Object(vt.jsx)("td",{className:"tcenter",children:e.onWaiting>1?e.onWaiting:""}),Object(vt.jsx)("td",{className:"tright ".concat(t>0?"price":""),children:t>0&&Object(vt.jsx)(ur.a,{value:t,displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}})})]},e.id):null})}))})]})},Gc=function(e){var t=e.ticket,n=e.showVat,a=e.onWaiting,i=e.holdBackInvoice,r=e.allTicketsAreFree,s=e.seats;return 0===t.number?null:Object(vt.jsxs)("table",{className:"border-bottom-1px",width:"100%",cellSpacing:"0",cellPadding:"0",children:[Object(vt.jsx)("thead",{children:!a&&t.number-t.onWaiting>0||a&&t.onWaiting>0?Object(vt.jsxs)("tr",{className:"table-ticket",children:[Object(vt.jsxs)("td",{colSpan:"2",width:"50%",children:[pt(t,"name"),"  ","FREE"===t.seating&&Object(vt.jsxs)("span",{children:["(",ti,")"]})]}),Object(vt.jsx)("td",{width:"10%",className:"tcenter",children:a?t.onWaiting:t.number-t.onWaiting}),Object(vt.jsx)("td",{width:"40%",className:"tright ".concat(r?"":"price"),children:!r&&Object(vt.jsx)(ur.a,{value:a?t.onWaitingPrice:t.price,displayType:"text",thousandSeparator:" "})})]}):null}),Object(vt.jsxs)("tbody",{children:[Object.values(t.additionals).map((function(e){var t=0;return!a&&e.number-e.onWaiting>0?t=Ni(e,n,!1,i):a&&e.onWaiting>0&&(t=Ni(e,n,!0)),Object(vt.jsx)(vt.Fragment,{children:!a&&e.number-e.onWaiting>0?Object(vt.jsxs)("tr",{className:"table-ticket table-additional",children:[Object(vt.jsx)("td",{colSpan:"2",children:e.name}),Object(vt.jsx)("td",{className:"tcenter",children:e.number-e.onWaiting>1?e.number-e.onWaiting:""}),Object(vt.jsx)("td",{className:"tright ".concat(0!==+t?"price":""),children:0!==+t&&Object(vt.jsx)(ur.a,{value:t,displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}})})]},e.id):a&&e.onWaiting?Object(vt.jsxs)("tr",{className:"table-ticket table-additional",children:[Object(vt.jsx)("td",{colSpan:"2",children:e.name}),Object(vt.jsx)("td",{className:"tcenter",children:e.onWaiting>1?e.onWaiting:""}),Object(vt.jsx)("td",{className:"tright ".concat(0!==+t?"price":""),children:0!==+t&&Object(vt.jsx)(ur.a,{value:t,displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}})})]},e.id):null})})),s.filter((function(e){return e.ticketId===t.id})).map((function(e){var t,n;return Object(vt.jsx)("tr",{className:"table-ticket table-additional",children:Object(vt.jsx)("td",{colSpan:"4",children:0===Number(e.row)?Object(vt.jsxs)("p",{children:[Kn," ",e.fieldTitle," - ",null!==(t=e.unit)&&void 0!==t?t:"Stand"," ",e.seat]}):Object(vt.jsxs)("p",{children:[Kn," ",e.fieldTitle," - ",Qn," ",e.row," - ",null!==(n=e.unit)&&void 0!==n?n:Gn," ",e.seat]})})},"".concat(e.fieldTitle,"-").concat(e.row,"-").concat(e.seat))}))]})]},t.category_id)};Gc.defaultProps={holdBackInvoice:!1};var $c=mr((function(e){return{holdBackInvoice:e.holdBackInvoice,allTicketsAreFree:e.allTicketsAreFree,seats:e.seats,getUserTranslatedText:function(t,n){return pt(t,n,e.language)}}}))(Gc),Yc=function(e){var t=e.tickets,n=e.sumTicketFeeWaiting,a=e.users,i=e.stateAdditionals,r=e.showVat,s=e.holdBackInvoice,c=Object(b.useState)([]),o=Object(U.a)(c,2),d=o[0],l=o[1];Object(b.useEffect)((function(){l(Object.values(t).filter((function(e){return e.onWaiting>0||Object.values(e.additionals).some((function(e){return e.onWaiting>0}))})))}),[t]);var u=Ii(n,a,!0,!0,i,!0),m=Ii(n,a,!1,!0,i,!0),p=_i(a,i,!0);return Object(vt.jsxs)("table",{className:"summary",cellSpacing:"0",cellPadding:"0",children:[Object(vt.jsx)("thead",{children:Object(vt.jsxs)("tr",{children:[Object(vt.jsx)("th",{colSpan:"2",width:"50%",className:"tleft",id:"summary-tickets",children:s||0===u?Object(vt.jsx)("span",{children:Ka}):Object(vt.jsx)("span",{children:za})}),Object(vt.jsx)("td",{width:"10%",className:"tcenter wauto"}),Object(vt.jsx)("td",{width:"40%",className:"tright"})]})}),Object(vt.jsxs)("tbody",{children:[Object(vt.jsx)("td",{colSpan:"4",children:Object(vt.jsxs)(vt.Fragment,{children:[Object.values(d).map((function(e){return Object(vt.jsx)($c,{onWaiting:!0,ticket:e,showVat:r},e.id)})),Object(vt.jsx)(Qc,{stateAdditionals:i,showVat:r,onWaiting:!0,holdBackInvoice:s})]})}),n?Object(vt.jsxs)("tr",{className:"table-total sum",children:[Object(vt.jsx)("td",{colSpan:"2",children:Ft}),Object(vt.jsx)("td",{colSpan:"2",className:"tright",children:Object(vt.jsx)(ur.a,{value:n,displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{className:"price",children:e})}})})]}):null,m?Object(vt.jsxs)("tr",{className:"table-total sum",children:[Object(vt.jsx)("td",{colSpan:"2",children:an}),Object(vt.jsx)("td",{colSpan:"2",className:"tright",children:Object(vt.jsx)(ur.a,{value:m,displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{className:"price",children:e})}})})]}):null,p||m?Object(vt.jsxs)("tr",{className:"table-total vat",children:[Object(vt.jsx)("td",{colSpan:"2",children:rn}),Object(vt.jsx)("td",{colSpan:"2",className:"tright",children:Object(vt.jsx)(ur.a,{value:p,displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{className:"price",children:e})}})})]}):null]}),u?Object(vt.jsx)("tfoot",{children:Object(vt.jsxs)("tr",{children:[Object(vt.jsx)("th",{colSpan:"2",children:Object(vt.jsx)("h3",{className:"tleft",children:nn})}),Object(vt.jsx)("th",{colSpan:"2",children:Object(vt.jsx)("h3",{className:"tright",children:Object(vt.jsx)(ur.a,{value:u,displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{className:"price",children:e})}})})})]})}):null]})},Xc=function(e){var t=e.users,n=e.sumTicketFee,a=e.sumTicketFeeWaiting,i=e.showVat,r=e.hasLockedTicketForm,s=e.stateAdditionals,c=e.showCouponInputSet,o=e.getUserTranslatedText,d=(e.seatUsers,e.activeMode),l=e.components,u=e.noScroll,m=e.holdBackInvoice,p=e.orderHasWaitingItems,h=e.userIsWaiting,f=e.allTicketsAreFree,v=l[je].isTouched,j=Object(b.useRef)();Object(b.useEffect)((function(){v&&setTimeout((function(){u||rr(j,d)}),50)}),[d,v]);var g=function(e){var n=[],a=Object(C.a)({},e.additionals),i=function(e,n){var a=0;return Object.values(t).forEach((function(t){Object.values(t.additionals).filter((function(a){return e===t.category_id&&a.id===n&&(t.onWaiting||a.onWaiting)})).forEach((function(e){"number"===e.type?a+=e.onWaiting:e.onWaiting&&a++}))})),a};return Object.values(t).forEach((function(r){r.category_id===e.id&&Object.values(r.additionals).filter((function(e){var t="child"===e.type?e.parent_id:e.id;return["checkbox","radio","number","multicheckbox"].includes(r.ticket.additionals[t].type)})).forEach((function(s){var c=s.child_id?s.child_id:s.id;n.push(c);var d="number"===s.type?function(e,n){var a=[];return Object.values(t).forEach((function(t){return Object.values(t.additionals).filter((function(n){return"number"===n.type&&e.category_id===t.category_id})).forEach((function(e){a.push({additionalId:e.id,number:e.number})}))})),a.filter((function(e){return e.additionalId===n})).map((function(e){return e.number})).reduce((function(e,t){return+e+ +t}))}(r,c):n.filter((function(e){return e===c})).length;a[c]={id:c,name:o(s,"name"),number:d,onWaiting:i(e.id,c),price:s.price,vat:s.vat}}))})),a},O=function(){var e={};return Object.values(t).forEach((function(n){Object.keys(n.additionals).forEach((function(e){var t=n.additionals[e];n.onWaiting&&(t.onWaiting=t.number)}));var a=n.price;e[n.category_id]={id:n.category_id,name:o(r?n:n.ticket,"name"),number:r?lt(t,n.category_id):n.number,price:r?a:Ei(n,i,m),prices:n.prices,onWaitingPrice:0,seating:n.seating,onWaiting:r?ut(t,n.category_id):n.onWaiting,vat:n.vat,additionals:r?{}:n.additionals};var s=e[n.category_id];e[n.category_id]&&(r?(e[n.category_id].price=Ei(s,i,m),e[n.category_id].price=yi.a.chain(e[n.category_id].price).add(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;return e.forEach((function(e){e.seat&&(n=yi.a.chain(n).add(yi.a.chain(e.seat.price).multiply(t?1+e.seat.vat/100:1).round(2).done()).round(2).done())})),n}(Object.values(t).filter((function(e){return e.category_id===n.category_id})),i)).round(2).done(),e[n.category_id].additionals=g(s),e[n.category_id].onWaitingPrice=Si(n,i,s.onWaiting)):e[n.category_id].onWaitingPrice=Si(n,i,n.onWaiting))})),e};return Object(vt.jsxs)("div",{className:"registration--body",ref:j,children:[Object(vt.jsx)("h2",{className:"tleft",children:Xt}),c&&Object(vt.jsx)(Xr,{}),Object(vt.jsxs)("div",{className:"registration--summary mt20",children:[Object(vt.jsxs)("table",{className:"summary",cellSpacing:"0",cellPadding:"0",children:[Object(vt.jsx)("thead",{children:Object(vt.jsxs)("tr",{children:[Object(vt.jsx)("th",{width:"50%",className:"tleft",id:"summary-tickets",children:Object(vt.jsx)("span",{children:wn})}),Object(vt.jsx)("td",{width:"10%",className:"tcenter wauto",children:en}),Object(vt.jsx)("td",{width:"40%",className:"tright",children:Dt})]})}),Object(vt.jsxs)("tbody",{children:[Object(vt.jsx)("tr",{children:Object(vt.jsx)("td",{colSpan:"4",children:Object(vt.jsxs)(vt.Fragment,{children:[Object.values(O()).map((function(e){return Object(vt.jsx)($c,{onWaiting:!1,ticket:e,showVat:i},e.id)})),Object(vt.jsx)(Qc,{stateAdditionals:s,showVat:i,onWaiting:!1,holdBackInvoice:m})]})})}),wi(t,s,i)>0&&Object(vt.jsxs)("tr",{className:"table-total sum category",children:[Object(vt.jsx)("td",{colSpan:"2",children:Mt}),Object(vt.jsx)("td",{colSpan:"2",className:"tright price",children:Object(vt.jsx)(ur.a,{value:wi(t,s,i),displayType:"text",thousandSeparator:" ",renderText:function(e){return"0"===e?Object(vt.jsx)("span",{children:e}):Object(vt.jsxs)("span",{children:["- ",e]})}})})]}),n?Object(vt.jsxs)("tr",{className:"table-total sum",children:[Object(vt.jsx)("td",{colSpan:"2",children:Ft}),Object(vt.jsx)("td",{colSpan:"2",className:"tright",children:Object(vt.jsx)(ur.a,{value:n,displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{className:"price",children:e})}})})]}):null,(!f||Ii(n,t,!1,!0,s)>0)&&Object(vt.jsxs)("tr",{className:"table-total sum",children:[Object(vt.jsx)("td",{colSpan:"2",children:an}),Object(vt.jsx)("td",{colSpan:"2",className:"tright",children:Object(vt.jsx)(ur.a,{value:Ii(n,t,!1,!0,s),displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{className:"price",children:e})}})})]}),(!f||_i(t,s)>0)&&Object(vt.jsxs)("tr",{className:"table-total vat",children:[Object(vt.jsx)("td",{colSpan:"2",children:rn}),Object(vt.jsx)("td",{colSpan:"2",className:"tright",children:Object(vt.jsx)(ur.a,{value:_i(t,s),displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{className:"price",children:e})}})})]})]}),(!f||Ii(n,t,!0,!0,s)>0)&&Object(vt.jsx)("tfoot",{children:Object(vt.jsxs)("tr",{children:[Object(vt.jsx)("th",{colSpan:"2",children:Object(vt.jsx)("h3",{className:"tleft",children:nn})}),Object(vt.jsx)("th",{colSpan:"2",children:Object(vt.jsx)("h3",{className:"tright",children:Object(vt.jsx)(ur.a,{value:Ii(n,t,!0,!0,s),displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{className:"price",children:e})}})})})]})})]}),p&&Object(vt.jsx)(vt.Fragment,{children:Object(vt.jsx)(Yc,{tickets:O(),sumTicketFeeWaiting:a,stateAdditionals:s,users:t,holdBackInvoice:m,showVat:i})}),h&&m&&Object(vt.jsx)("div",{className:"info-pill",children:Object(vt.jsxs)("p",{children:[Object(vt.jsx)("i",{className:"icons8-info"}),Qa]})})]})]})},Jc=mr((function(e){return{users:e.users,seatUsers:e.seatUsers,sumTicketFee:e.sumTicketFee,sumTicketFeeWaiting:e.sumTicketFeeWaiting,orderHasWaitingItems:e.orderHasWaitingItems,userIsWaiting:e.userIsWaiting,holdBackInvoice:e.holdBackInvoice,showVat:e.showVat,stateAdditionals:e.additionals,components:e.components,activeMode:e.apolloState.activeMode,showCouponInputSet:e.hasLockedTicketForm&&e.settings.coupons&&!e.apolloState.hasOrdered,hasLockedTicketForm:e.hasLockedTicketForm,allTicketsAreFree:e.allTicketsAreFree,getUserTranslatedText:function(t,n){return pt(t,n,e.language)}}}))(Object(b.memo)(Xc));var Zc,eo=function(e){var t=e.handleChange,n=e.handleValidation,a=e.invoiceEmailerror,i=e.invoiceEmail,r=gr(a);return Object(vt.jsxs)("div",{className:"form-group",children:[Object(vt.jsx)(fr,{htmlFor:"invoice-email",labelName:mn,required:!0}),Object(vt.jsx)(hr,{id:"invoice-email",name:"invoiceEmail",type:"email","aria-required":!0,"aria-invalid":r,"aria-describedby":r?"invoice-email-err":null,className:jr(a),onChange:t,value:i,onBlur:n,required:!0}),vr(a,"invoice-email-err")]})},to=mr((function(e){return{invoiceEmail:e.paymentInfo.invoiceEmail,handleChange:e.funcs.handleChange,handleValidation:e.funcs.handleValidation,invoiceEmailerror:e.errors.invoiceEmail}}))(Object(b.memo)(eo)),no=function(e){e.settings;var t=e.modalIsOpen,n=e.setToggleModal,a=Object(b.useContext)(jt);return Object(vt.jsx)(Ss.a,{enabled:t,children:Object(vt.jsxs)(P.a,{ariaHideApp:!1,isOpen:t,onRequestClose:n,className:"Modal",overlayClassName:"Overlay",children:[Object(vt.jsx)("h2",{className:"df jcc",children:vn}),Object(vt.jsxs)("div",{className:"w60p mauto",children:[Object(vt.jsx)("button",{type:"button",className:"Modal--close icon icons8-delete-filled",onClick:n}),Object(vt.jsx)("div",{className:"dangerousDescription",dangerouslySetInnerHTML:{__html:ft(a.language)}})]})]})})},ao=function(e){var t=e.acceptedConditions,n=e.setAcceptedConditions,a=e.setToggleModal,i=Object(b.useContext)(jt);return Object(vt.jsxs)("div",{className:"df aic jcc terms",children:[Object(vt.jsx)(hr,{className:"checkbox",type:"checkbox",checked:t,onClick:n,id:"termsCheckbox"}),Object(vt.jsxs)("p",{children:[Object(vt.jsxs)("label",{htmlFor:"termsCheckbox",className:"mb0",children:[pn,"\xa0"]}),Object(vt.jsxs)("span",{children:[Object(vt.jsx)("button",{type:"button",className:"terms-link",onClick:a,children:hn})," ",bn," ",Object(vt.jsx)("a",{className:"terms-link",href:Wa[i.language],target:"_blank",rel:"noopener noreferrer",children:fn})]})]})]})},io={PRIMARY:"primary",WARNING:"warning",DANGER:"danger",SUCCESS:"success",TEXT:"text"},ro=or.a.button(Zc||(Zc=Object(Ee.a)(["\n  border-radius: 3px;\n  width: ",";\n  height: 2.4rem;\n  text-align: center;\n  align-items: center;\n  font-size: 1.2rem;\n  display: flex;\n  justify-content: center;\n  margin: 20px auto;\n\n  color: white;\n  ","\n  ",";\n"])),(function(e){return e.buttonWidth}),(function(e){return function(e){if(e===io.PRIMARY)return"\n        &:after {\n            color: red;\n            content: ' * ';\n        }\n        ";if(e===io.SUCCESS)return"\n            background-color: #1c2b39;\n        }\n        ";if(e===io.WARNING);else if(e===io.TEXT)return"\n    border-width: 1px;\n    color: #1c2b39;\n    background-color: transparent;\n  }\n    "}(e.buttonType)}),(function(e){return e.disabled?"\n            opacity: 0.3;\n            cursor: not-allowed;\n        ":"\n            cursor: pointer;\n        "})),so=function(e){var t=e.text,n=e.buttonType,a=e.size,i=e.disabled,r=e.onClick,s=e.buttonWidth;return Object(vt.jsx)(ro,{buttonWidth:s,onClick:r,type:"button",buttonType:n,size:a,disabled:i,children:t})};so.defaultProps={size:io.MEDIUM,buttonType:io.SUCCESS,buttonWidth:"15rem"};var co,oo,lo,uo,mo,po,ho,bo,fo,vo,jo,go,Oo,yo,xo,ko,Co=so,To=Object(or.b)(co||(co=Object(Ee.a)(["\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n"]))),Eo=or.a.div(oo||(oo=Object(Ee.a)(["\n  animation: "," 0.5s linear;\n  transition: visibility 0.5s linear;\n"])),To),So=or.a.div(lo||(lo=Object(Ee.a)(["\n  padding: 15px;\n  font-size: 80px;\n  margin-bottom: 10px;\n  color: #43b649;\n  text-align: center;\n  justify-content: center;\n"]))),No=or.a.div(uo||(uo=Object(Ee.a)(["\n  text-align: center;\n  font-size: 32px;\n"]))),_o=function(){return Object(vt.jsx)("div",{children:Object(vt.jsxs)(Eo,{children:[Object(vt.jsx)(So,{children:Object(vt.jsx)("i",{className:"icons8-green-check-mark"})}),Object(vt.jsx)(No,{children:Object(vt.jsx)("p",{className:"text_center",children:Sn})})]})})},Io=Object(or.b)(mo||(mo=Object(Ee.a)(["\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n"]))),wo=or.a.div(po||(po=Object(Ee.a)(["\n  animation: "," 0.5s linear;\n  transition: visibility 0.5s linear;\n"])),Io),Ao=or.a.div(ho||(ho=Object(Ee.a)(["\n  text-align: center;\n  font-size: 42px;\n"]))),Ro=or.a.div(bo||(bo=Object(Ee.a)(["\n  margin-top: 30px;\n"]))),Po=function(e){return Object(vt.jsx)(wo,{children:Object(vt.jsxs)(Ao,{children:["vipps"===e.method?Object(vt.jsx)("p",{style:{fontSize:"22px"},children:ya}):Object(vt.jsx)("p",{style:{fontSize:"22px"},children:xa}),Object(vt.jsx)(Ro,{children:Object(vt.jsx)(vs.a,{type:"TailSpin",color:"#2dc943",height:"100",width:"100"})})]})})},Do=Object(or.b)(fo||(fo=Object(Ee.a)(["\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n"]))),Mo=or.a.div(vo||(vo=Object(Ee.a)(["\n  animation: "," 0.5s linear;\n  transition: visibility 0.5s linear;\n  padding-top: ",";\n"])),Do,js.isMobile?"30%":"5%"),Fo=or.a.div(jo||(jo=Object(Ee.a)(["\n  padding: 15px;\n  font-size: 80px;\n  margin-top: -30;\n  margin-bottom: 10px;\n  color: #B31415;\n  text-align: center;\n  justify-content: center;\n"]))),Lo=or.a.div(go||(go=Object(Ee.a)(["\n  text-align: center;\n  font-size: ",";\n"])),js.isBrowser?"24px":"19px"),Wo=function(e){return Object(vt.jsx)("div",{children:Object(vt.jsxs)(Mo,{children:[Object(vt.jsx)(Fo,{children:Object(vt.jsx)("i",{className:"icons8-cancel errorMessages error"})}),Object(vt.jsx)(Lo,{children:Object(vt.jsx)("p",{className:"text_center errorMessages",children:e.customMessage?e.customMessage:ka})})]})})},qo=Object(or.b)(Oo||(Oo=Object(Ee.a)(["\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n"]))),Vo=or.a.div(yo||(yo=Object(Ee.a)(["\n  animation: "," 0.5s linear;\n  transition: visibility 0.5s linear;\n"])),qo),Bo=or.a.div(xo||(xo=Object(Ee.a)(["\n  padding: 15px;\n  font-size: 80px;\n  margin-top: -30;\n  margin-bottom: 10px;\n  color: #B31415;\n  text-align: center;\n  justify-content: center;\n"]))),Uo=or.a.div(ko||(ko=Object(Ee.a)(["\n  text-align: center;\n  font-size: 24px;\n"]))),Ho=function(){return Object(vt.jsx)("div",{children:Object(vt.jsxs)(Vo,{children:[Object(vt.jsx)(Bo,{children:Object(vt.jsx)("i",{className:"icons8-x-mark errorMessages error"})}),Object(vt.jsx)(Uo,{children:Object(vt.jsx)("p",{className:"text_center red",children:Ca})})]})})},zo="https://epayment.nets.eu/terminal/default.aspx";(window.location.href.includes("checkin.local")||window.location.href.includes("localhost"))&&(zo="https://test.epayment.nets.eu/terminal/default.aspx");var Ko,Qo,Go,$o,Yo,Xo,Jo,Zo,ed=function(e){Object(b.useEffect)((function(){var e=document.getElementById("bbs_redirect");e&&e.submit()}));var t=Object(vt.jsxs)("div",{children:[Object(vt.jsx)("input",{type:"hidden",name:"ma",value:e.cardNumber}),Object(vt.jsx)("input",{type:"hidden",name:"mm",value:e.cardExpireMonth}),Object(vt.jsx)("input",{type:"hidden",name:"my",value:e.cardExpireYear}),Object(vt.jsx)("input",{type:"hidden",name:"mc",value:e.cardCvc})]}),n=Object(vt.jsxs)("div",{children:[Object(vt.jsx)("input",{type:"hidden",name:"va",value:e.cardNumber}),Object(vt.jsx)("input",{type:"hidden",name:"vm",value:e.cardExpireMonth}),Object(vt.jsx)("input",{type:"hidden",name:"vy",value:e.cardExpireYear}),Object(vt.jsx)("input",{type:"hidden",name:"vc",value:e.cardCvc})]});return Object(vt.jsxs)("div",{children:[Object(vt.jsx)("iframe",{title:"card payment frame",id:"card_payment_iframe",name:"card_payment_iframe",style:{width:"100%",height:"600px",border:"none",overflow:"hidden",zoom:.75}}),Object(vt.jsxs)("form",{name:"bbs_redirect",id:"bbs_redirect",action:zo,method:"post",className:"ignore",target:"card_payment_iframe",children:[Object(vt.jsx)("input",{type:"hidden",name:"BBSePay_transaction",value:e.transactionReference}),"visa"===e.cardType?n:t]})]})},td=Object(Se.a)(Ko||(Ko=Object(Ee.a)(["\n  mutation registerTransaction(\n    $type: OrderTypeEnum!\n    $customer_id: Int!\n    $method: PaymentMethodEnum!\n    $tlf: BigInt\n    $sum: String!\n    $expires: DateTime\n    $order_data: String!\n    $callback: String\n  ) {\n    registerTransaction(\n      type: $type\n      customer_id: $customer_id\n      method: $method\n      tlf: $tlf\n      expires: $expires\n      sum: $sum\n      order_data: $order_data\n      callback: $callback\n    ) {\n      id\n      hash\n      url\n      transaction_reference\n    }\n  }\n"]))),nd=Object(Se.a)(Qo||(Qo=Object(Ee.a)(["\n  query transactionStatus($id: BigInt!, $hash: String!) {\n    transactionStatus(id: $id, hash: $hash) {\n      id\n      hash\n      status\n      message\n      receipt\n    }\n  }\n"]))),ad=Object(or.b)(Go||(Go=Object(Ee.a)(["\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n"]))),id=or.a.div($o||($o=Object(Ee.a)(["\n  animation: "," 0.5s linear;\n  transition: visibility 0.5s linear;\n"])),ad),rd=Object(b.forwardRef)((function(e,t){var n,a,i,r=Object(b.useState)({}),s=Object(U.a)(r,2),c=s[0],o=s[1],d=Object(b.useContext)(jt),l=Object(b.useState)(""),u=Object(U.a)(l,2),m=u[0],p=u[1],h=Object(b.useState)(""),f=Object(U.a)(h,2),v=f[0],j=f[1],O=Object(b.useState)(null),y=Object(U.a)(O,2),x=y[0],k=y[1],T=Object(b.useState)(null),E=Object(U.a)(T,2),S=E[0],N=E[1],_=Object(b.useState)(null),I=Object(U.a)(_,2),w=I[0],A=I[1],R=Object(b.useState)(!1),M=Object(U.a)(R,2),L=(M[0],M[1]),W=Object(b.useState)(!1),q=Object(U.a)(W,2),V=q[0],B=q[1],K=Object(b.useState)(!1),Q=Object(U.a)(K,2),G=Q[0],$=Q[1],Y=Object(b.useState)(""),Z=Object(U.a)(Y,2),ee=Z[0],te=Z[1],ne=Object(b.useState)(!1),ae=Object(U.a)(ne,2),ie=ae[0],re=ae[1],se=Object(b.useState)(""),ce=Object(U.a)(se,2),oe=ce[0],de=ce[1],le=Object(b.useState)(!1),ue=Object(U.a)(le,2),me=ue[0],pe=ue[1],he={cancelled:Object(vt.jsx)(Ho,{}),done:Object(vt.jsx)(_o,{}),failed:Object(vt.jsx)(Wo,{}),initiated:Object(vt.jsx)(Po,{method:"vipps"})},be=function(){$(!G),p(""),j(""),te(""),re(!1),B(!1),k(null),pe(!0)},fe=function(){$(!G),p(""),j(""),te(""),re(!1),B(!1),k(null),pe(!0),de("");var e=Ze(window.location.href,"checkin_hash");e=Ze(e,"checkin_transaction_id"),e=Ze(e,"status"),window.location=e};function ve(){$(!1),p(""),j(""),te(""),re(!1),B(!1),pe(!0),k(null),N(null),de("")}n=window,a="message",i=function(t){if("closePaymentFrame"===t.data.func)if(o(t.data),"1"===t.data.status){e.setPaymentSuccessful(!0);try{Zi.dispatchEvent(Gi.PROGRESS,{data:{step:Gi.REGISTRATION_COMPLETED,status:"success",orderType:"paid",paymentMethod:e.paymentMethod,orderData:e.getOrderDataForAnalytics()}})}catch(n){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:Gi.REGISTRATION_COMPLETED}})}ve()}else"05"===t.data.errors.code?ve():0===t.data.errors.length?(N(Na),k(Na),pe(!0)):"Refused by issuer"===t.data.errors.raw?(N(_a),k(_a),pe(!0)):(N(ka),k(ka),pe(!0))},n.addEventListener?n.addEventListener(a,i,!1):n.attachEvent&&n.attachEvent("on"+a,i),Object(b.useEffect)((function(){x&&D.b("Payment failed",{level:F.a.Critical,extra:{Post_Message_Status:JSON.stringify(c),payment_failed:"string"===typeof x?x:JSON.stringify(x)}})}),[x,c]),Object(b.useEffect)((function(){et("checkin_hash")&&(p(et("checkin_hash")),j(et("checkin_transaction_id")),$(!0))}),[]),Object(b.useImperativeHandle)(t,(function(){return{onSubmit:function(){pe(!1),$(!0),k(null);var t=JSON.stringify(function(e,t,n){var a=Object(C.a)({language:t,event_id:Number(document.event_id),mode:e.mode,contact_crm:function(){var t,n,i,r,s=e.orderInfo.name.split(" ");return i=null!==(t=e.orderInfo.firstName)&&void 0!==t?t:s[0],r=null!==(n=e.orderInfo.lastName)&&void 0!==n?n:s[1],a={first_name:i,last_name:r,email:e.orderInfo.email,tlf:Number(e.orderInfo.formattedPhone),prefix:Number(e.orderInfo.dialCode),born:null,sex:null},e.orderInfo.payer===J&&(a.org_nr=e.orderInfo.orgNo.replace(/\s/g,""),a.ehf="ehf"===e.paymentInfo.paymentOption,a.address={address:e.orderInfo.address,zip:di(e.orderInfo.zipcode)?e.orderInfo.zipcode.trim():"1",city:e.orderInfo.city,country:e.orderInfo.companyCountry}),a}(),users:[],coupon:e.coupon},mi());try{e.orderInfo.payer===J&&(a.billing_crm={name:e.orderInfo.companyName,email_invoice:e.orderInfo.invoiceEmail,org_nr:e.orderInfo.orgNo.replace(/\s/g,""),address:{types:["WORK"],address:e.orderInfo.address,zip:di(e.orderInfo.zipcode)?e.orderInfo.zipcode.trim():"1",city:e.orderInfo.city,country:e.orderInfo.companyCountry.toUpperCase().trim()}})}catch(i){console.log(i)}return e.mode===H?a.users=hi(Object(C.a)(Object(C.a)({},e),{},{eventType:n})):e.mode===z&&(a.users=pi(Object(C.a)({},e))),a.additionals=bi(e.additionals),a}(e.orderData,d.language,e.event.type));A(null),delete Ke["Idempotency-Key"],Qe.mutate({mutation:td,variables:{type:"event",customer_id:e.orderData.customerId,method:e.paymentMethod,tlf:Number(e.orderData.orderInfo.formattedPhone),sum:e.orderData.sum,expires:ui()().format(),order_data:t,callback:window.location.href}}).then((function(t){js.isMobile&&e.paymentMethod===X&&(window.onbeforeunload=null,window.location=t.data.registerTransaction.url),de(t.data.registerTransaction.transaction_reference),te(t.data.registerTransaction.url),p(t.data.registerTransaction.hash),j(t.data.registerTransaction.id),$(!0)})).catch((function(e){var t=e.toString().split(":")[2];D.b("Register Transaction",{level:F.a.Critical}),A(t),k("Register transaction")}))}}}));var je=function(){var t=e.paymentMethod,n="";return t===X?n+="vippsGray":n="cardGray",js.isBrowser?n+=t===X?" CheckinOrderModal width500 height600":" CheckinPaymentModal width500 height650":n+=" CheckinMobileModal",n},ge=function e(t,n){n<3&&L(!1),"initiated"===t&&setTimeout((function(){"initiated"===t&&n++,n>=3?(L(!1),n=0):L(!1),e(t,n)}),3e3)},Oe=function(){var t="";return t=js.isMobile?"40%":"5%",Object(vt.jsx)(js.BrowserView,{children:ee&&!V?Object(vt.jsx)("iframe",{title:"vipps iframe",style:{border:"none",marginTop:"-50px"},id:"vippsIframe",src:ee,scrolling:"no",width:"500",height:"600",onLoad:ye}):m&&v?Object(vt.jsx)(g.c,{query:nd,variables:{id:parseFloat(v),hash:m},pollInterval:3e3,fetchPolicy:"cache-and-network",children:function(t){var n=t.loading,a=t.error,i=t.data,r=t.stopPolling;return n||(ge(i.transactionStatus.status,0),"done"===i.transactionStatus.status&&e.setPaymentSuccessful(!0),"done"===i.transactionStatus.status&&r()),Object(vt.jsxs)("div",{children:[Object(vt.jsx)("div",{className:"w60p mauto"}),a?he.failed:n&&!i.transactionStatus?Object(vt.jsx)("div",{className:"text_center",children:Object(vt.jsx)(vs.a,{type:"TailSpin",color:"#2dc943",height:"100",width:"100"})}):Object(vt.jsxs)("div",{children:[Object(vt.jsx)("div",{className:"text_center",children:he[i.transactionStatus.status]}),Object(vt.jsx)("div",{style:{marginTop:"50px"},children:Object(vt.jsx)(Co,{type:"button",text:"Lukk",onClick:be})})]})]})}}):Object(vt.jsx)("div",{className:"text_center",style:{marginTop:t},children:x?Object(vt.jsxs)("div",{children:[Object(vt.jsx)(Ho,{}),w?Object(vt.jsx)("p",{className:"error text_center",children:w}):null,Object(vt.jsx)(Co,{type:"button",text:Et,onClick:be})]}):Object(vt.jsx)(Po,{method:"vipps"})})})},ye=function(){ie?(B(!0),te("")):re(!0)},xe=function(){var t="";return t=js.isMobile?"40%":"5%",Object(vt.jsx)(js.MobileView,{children:x?Object(vt.jsxs)("div",{children:[Object(vt.jsx)(Ho,{}),w?Object(vt.jsx)("p",{className:"error text_center",children:w}):null,Object(vt.jsx)(Co,{type:"button",text:Et,onClick:be})]}):Object(vt.jsx)("div",{className:"text_center",style:{marginTop:t},children:m&&v?Object(vt.jsx)(g.c,{query:nd,variables:{id:parseFloat(v),hash:m},pollInterval:3e3,onError:function(e){var t;((null===(t=e.graphQLErrors)||void 0===t?void 0:t.length)>0||e.networkError&&Object.keys(e.networkError).length>0)&&k({type:"Transaction status",error:e})},children:function(t){var n=t.loading,a=t.error,i=t.data,r=t.stopPolling;return a&&r(),n||("done"===i.transactionStatus.status&&e.setPaymentSuccessful(!0),"done"===i.transactionStatus.status&&r()),Object(vt.jsx)(vt.Fragment,{children:Object(vt.jsxs)("div",{children:[Object(vt.jsx)("div",{className:"w60p mauto"}),a?he.failed:n&&!i.transactionStatus?Object(vt.jsx)(vs.a,{type:"TailSpin",color:"#2dc943",height:"100",width:"100"}):Object(vt.jsxs)("div",{children:[Object(vt.jsx)("div",{className:"text_center",children:ke(i.transactionStatus.status)})," "]})]})})}}):Object(vt.jsx)(Po,{method:"vipps"})})})},ke=function(t){return Object(vt.jsx)("div",{children:e.orderData?Object(vt.jsxs)("div",{children:[he[t],Object(vt.jsx)(Co,{type:"button",text:Et,onClick:be})]}):Object(vt.jsx)("div",{children:"cancelled"===t?Object(vt.jsxs)("div",{children:[Object(vt.jsx)("p",{children:Nn}),Object(vt.jsx)(Co,{type:"button",text:Wn,onClick:fe})]}):Object(vt.jsxs)("div",{children:[he[t],Object(vt.jsx)(Co,{type:"button",text:Et,onClick:be})]})})})},Ce=function(t){var n="";return n=js.isMobile?"40%":"5%",Object(vt.jsx)("div",{"data-private":!0,style:{marginTop:"10vh"},children:oe&&!me&&t?Object(vt.jsx)(ed,{cardNumber:t.cardNumber,cardType:t.cardType,cardExpireMonth:t.cardExpireMonth,cardExpireYear:e.cardInfo.cardExpireYear,cardCvc:t.cardCvc,transactionReference:oe}):S?Object(vt.jsxs)("div",{children:[Object(vt.jsx)(Wo,{customMessage:S}),Object(vt.jsx)(Co,{type:"button",text:Oa,onClick:be})]}):x?Object(vt.jsxs)("div",{children:[Object(vt.jsx)(Ho,{}),w?Object(vt.jsx)("p",{className:"error text_center",children:w}):null,Object(vt.jsx)(Co,{type:"button",text:Et,onClick:be})]}):Object(vt.jsx)("div",{className:"text_center",children:Object(vt.jsx)("div",{style:{marginTop:n},children:Object(vt.jsx)(id,{children:Object(vt.jsx)(vs.a,{type:"TailSpin",color:"#2dc943",height:"100",width:"100"})})})})})};return function(){var t=e.cardInfo,n=je();return Object(vt.jsx)(Ss.a,{enabled:G,children:Object(vt.jsx)(P.a,{ariaHideApp:!1,isOpen:G,onRequestClose:be,className:n,overlayClassName:"Overlay",shouldCloseOnEsc:!1,shouldCloseOnOverlayClick:!1,children:Object(vt.jsx)("div",{id:"paymentModal",children:e.orderData&&e.orderData.paymentInfo.paymentOption===X||et("checkin_hash")?Object(vt.jsxs)("div",{children:[Oe(),xe()]}):Ce(t)})})})}()})),sd=n(343),cd=n.n(sd),od=or.a.div(Yo||(Yo=Object(Ee.a)(["\n  font-weight: 400;\n"]))),dd=Object(or.b)(Xo||(Xo=Object(Ee.a)(["\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n"]))),ld=or.a.div(Jo||(Jo=Object(Ee.a)(["\n  animation: "," 0.5s linear;\n  transition: visibility 0.5s linear;\n"])),dd),ud=or.a.div(Zo||(Zo=Object(Ee.a)(["\n  animation: "," 0.2s linear;\n  transition: visibility 0.2s linear;\n"])),dd),md=function(e){Object(_.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(E.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).cvcRef=f.a.createRef(),e.handleBlur=function(t){var n=t.target;e.props.cardInfoChange(Object(C.a)(Object(C.a)({},e.props.cardInfo),{},{touched:Object(C.a)(Object(C.a)({},e.props.cardInfo.touched),{},Object(T.a)({},n.name,!0))}))},e.handleKeyPress=function(t){e.props.cardInfoChange(Object(C.a)(Object(C.a)({},e.props.cardInfo),{},{previousKey:t.keyCode}))},e.handleChange=function(t){var n=t.target;"card-number"===n.name?e.handleCardNumberChange(n):"card-expiry"===n.name?e.handleCardExpiryChange(n):"card-cvc"===n.name&&e.handleCardCvcChange(n)},e.handleCardNumberChange=function(t){var n=t.value.replace(/\s/g,""),a=e.formatCardInput(n);n.length<=16&&e.props.cardInfoChange(Object(C.a)(Object(C.a)({},e.props.cardInfo),{},{card:a,cardType:e.getCardType(n),cardNumber:n,validCard:cd.a.validateCardNumber(a)}))},e.formatCardInput=function(e){for(var t="",n=0;n<e.length;n++)n%4===0&&0!==n&&(t+=" "),"0123456789/".includes(e[n])&&(t+=e[n]);return t},e.getCardType=function(e){return"4"===e[0]?"visa":"5"===e[0]?"mastercard":""},e.handleCardExpiryChange=function(t){for(var n=t.value.replace("/",""),a="",i=0;i<n.length;i++)"0123456789".includes(n[i])&&n.length<=4&&(a+=n[i]),1===i&&8!==e.props.cardInfo.previousKey&&(a+="/");var r=Array.from(a);8===e.props.cardInfo.previousKey&&3===a.length&&r.splice(2,0,"/"),a=r.join("");var s,c=n.substring(0,2);4===n.length&&(s=n.substring(2,4)),n.length<=4&&e.props.cardInfoChange(Object(C.a)(Object(C.a)({},e.props.cardInfo),{},{cardExpiry:a,cardExpireMonth:c,cardExpireYear:s})),cd.a.validateCardExpiry(c,s)&&setTimeout((function(){e.cvcRef.current.focus()}),0),e.props.cardInfoChange(Object(C.a)(Object(C.a)({},e.props.cardInfo),{},{cardExpiry:a,cardExpireMonth:c,cardExpireYear:s,validDate:cd.a.validateCardExpiry(c,s)}))},e.handleCardCvcChange=function(t){for(var n=t.value.replace(/\s/g,""),a="",i=0;i<n.length;i++)"0123456789".includes(n[i])&&(a+=n[i]);n.length<=3&&e.props.cardInfoChange(Object(C.a)(Object(C.a)({},e.props.cardInfo),{},{cardCvc:a}))},e}return Object(S.a)(n,[{key:"render",value:function(){var e=this.props.cardInfo;return Object(vt.jsx)(ld,{children:Object(vt.jsxs)(od,{children:[Object(vt.jsx)(fr,{htmlFor:"card-number",labelName:Ia,required:!0}),Object(vt.jsxs)("div",{className:"df aic",children:[Object(vt.jsx)(hr,{id:"card-number","data-private":!0,autoComplete:"cc-number",className:"cc-number",value:e.card,name:"card-number",onChange:this.handleChange,onBlur:this.handleBlur,inputMode:"numeric",onKeyDown:this.handleKeyPress,required:!0}),""===e.cardType?null:Object(vt.jsx)(ud,{children:Object(vt.jsx)("img",{className:"mt5 ml10",src:"visa"===e.cardType?"https://app.checkin.no/images/payment/visa_logo.svg":"https://app.checkin.no/images/payment/mastercard_logo.svg",width:"45px",height:"30px",alt:"By en:Visa, Inc. Icon of visa card"})})]}),!e.validCard&&e.touched["card-number"]&&Object(vt.jsx)("p",{className:"errorMessages",children:Ea}),Object(vt.jsxs)("div",{className:"df mt25",children:[Object(vt.jsxs)("div",{className:"mr30",children:[Object(vt.jsx)(fr,{htmlFor:"card-expiry",labelName:wa,required:!0}),Object(vt.jsx)(Mc.a,{id:"card-expiry","data-private":!0,format:"##/##",autoComplete:"cc-expiry",className:"cc-expiry",value:e.cardExpiry,onChange:this.handleChange,onBlur:this.handleBlur,name:"card-expiry",inputMode:"numeric",onKeyDown:this.handleKeyPress,mask:["M","M","Y","Y"],required:!0}),e.touched["card-expiry"]&&!e.validDate&&Object(vt.jsx)("p",{className:"errorMessages",children:Sa})]}),Object(vt.jsxs)("div",{children:[Object(vt.jsx)(fr,{htmlFor:"card-cvc",labelName:"CVC",required:!0}),Object(vt.jsx)("input",{id:"card-cvc","data-private":!0,autoComplete:"cc-cvc",className:"cc-expiry",name:"card-cvc",onChange:this.handleChange,onBlur:this.handleBlur,value:e.cardCvc,inputMode:"numeric",onKeyDown:this.handleKeyPress,type:"text",ref:this.cvcRef,required:!0}),e.touched["card-cvc"]&&e.cardCvc.length<3&&Object(vt.jsx)("p",{className:"errorMessages",children:aa})]})]})]})})}}]),n}(f.a.Component),pd=md,hd=function(e){var t=e.client,n=e.orderIsFree,a=e.getOrderDataForAnalytics,i=e.event,r=e.handleSubmit,s=e.handleNewSubmit,c=e.setPaymentSuccessful,o=e.setPaymentOption,d=e.handleChange,l=e.settings,u=e.paymentInfo,m=e.paymentInfo.paymentOption,p=e.users,h=e.orderInfo,f=e.orderInfo.payer,v=e.validOrgNo,j=e.customerId,O=e.additionals,y=e.sumTicketFee,x=e.activeMode,k=e.returnAllTicketErrors,T=e.coupon,E=Object(b.useRef)(),S={additionals:O,orderInfo:h,users:p,coupon:T,paymentInfo:u,mode:x,customerId:j,sum:Ii(y,p,!0,!0,O).toString()},N=function(e){var t=Object(b.useState)(e),n=Object(U.a)(t,2),a=n[0],i=n[1],r=Object(b.useState)(e),s=Object(U.a)(r,2),c=s[0],o=s[1];return{modalIsOpen:a,acceptedConditions:c,setToggleModal:function(){i(!a)},setAcceptedConditions:function(){o(!c)}}}(!1),_=N.modalIsOpen,I=N.setToggleModal,w=N.acceptedConditions,A=N.setAcceptedConditions,R=Object(b.useState)({card:"",cardCvc:"",cardExpiry:"",cardType:"",cardExpireYear:"",cardExpireMonth:"",validCard:!1,cardNumber:"",validDate:!1,previousKey:"",touched:{}}),P=Object(U.a)(R,2),M=P[0],L=P[1],W=function(e){L(e)};Object(b.useEffect)((function(){if(Object.keys(M.touched).length>0)try{Zi.dispatchEvent(Gi.PROGRESS,{data:{step:Gi.CHECKOUT_STEP_VISITED,orderData:a()}})}catch(e){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:Gi.CHECKOUT_STEP_VISITED}})}}),[M.touched]),Object(b.useEffect)((function(){l.payment_method?o([l.payment_method]):l.paymentMethods?o(f===J?l.paymentMethods.corporate:l.paymentMethods.private):o(l.payment_methods)}),[o,l.paymentMethods]),Object(b.useEffect)((function(){f===J&&v&&d({target:{name:"paymentOption",value:"ehf"}})}),[f]),Object(b.useEffect)((function(){m!==K&&m!==Q&&n()?o([K]):(m===K&&q()&&!n()||m!==K&&!z.includes(m))&&o(z)}));var q=function(){return i&&i.customer&&f!==J&&pe.includes(i.customer.id)},V=f===J?l.paymentMethods.corporate:l.paymentMethods.private,B=V.filter((function(e){return v?![Y,$].includes(e):![Y,$,Q].includes(e)})),H=B.filter((function(e){return e!==Q})),z=H;f===J?(z=B,B.includes("ehf")&&"mail"===m&&v&&d({target:{name:"paymentOption",value:"ehf"}})):q()&&(z=H.filter((function(e){return e!==K})));var Z=new Date(i.settings.invoiceStartsSendingAt)>new Date,ee=ui()(i.settings.invoiceStartsSendingAt).format("DD.MM.YYYY"),te=function(e){return Object(vt.jsxs)(b.Fragment,{children:[bd(k()),Object(vt.jsx)("div",{className:"btn-wrapper",children:Object(vt.jsx)("button",{type:"button",disabled:!w,className:"btn wide ".concat(w?"btn-success":"btn-disabled"),onClick:e||function(){},children:[G,X].includes(m)?n()?gn:jn:gn})})]})};return n()||0!==V.length?Object(vt.jsxs)("section",{className:"registration--body",children:[!n()&&Object(vt.jsxs)(b.Fragment,{children:[Object(vt.jsx)("h2",{tabIndex:-1,children:ln}),!(1===z.length&&z[0]===K)&&Object(vt.jsx)("div",{role:"radiogroup","aria-label":"Payment method",className:"button-group payment ".concat(z.length<3?"":"jcsb"),children:z.map((function(e){return e===K&&z.includes(Q)?null:fd(e,m,d)}))})]}),Object(vt.jsxs)("div",{className:"registration--order ".concat(1===z.length&&z[0]===K&&"registration--order-email"),children:[m===K&&f===J&&!n()&&Object(vt.jsx)(to,{}),!n()&&Z&&m===K&&Object(vt.jsxs)("p",{className:"registration-payment-request-sent-label",children:[ni," ",ee]}),m===G?Object(vt.jsx)(pd,{cardInfoChange:W,cardInfo:M}):null,Object(vt.jsx)(ao,{acceptedConditions:w,setAcceptedConditions:A,setToggleModal:I}),_&&Object(vt.jsx)(no,{settings:l,setToggleModal:I,modalIsOpen:_}),m!==X&&m!==G?Object(vt.jsx)(g.b,{mutation:Pe,onError:function(e){e&&e.message&&e.message.toLowerCase().includes("unexpected token")?D.b("Add event order unexpected token",{level:F.a.Critical}):D.b("Add event order",{level:F.a.Critical})},onCompleted:function(e){e.addEventOrder;if(t.writeData({data:{hasOrdered:!0}}),m===K||m===Q||n()){try{Zi.dispatchEvent(Gi.PROGRESS,{data:{step:Gi.REGISTRATION_COMPLETED,status:"success",orderType:n()?"free":"paid",paymentMethod:m,orderData:a()}})}catch(r){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:Gi.REGISTRATION_COMPLETED,data:{orderType:n()?"free":"paid",paymentMethod:m}}})}i&&i.settings.texts.thankyou_url&&(window.onbeforeunload=null,window.location!==window.parent.location?window.open(i.settings.texts.thankyou_url,"_parent"):window.location.href=i.settings.texts.thankyou_url)}},children:function(e,t){var n=t.loading,a=t.error;return n?Object(vt.jsx)(ys,{className:"graphqlMessage mauto tcenter"}):Object(vt.jsxs)(vt.Fragment,{children:[a&&Object(vt.jsx)(Qr,{error:a,className:"graphqlMessage graphqlMessage--error mt20 mb20 mauto"}),te((function(t){r(t,e)}))]})}}):te((function(){try{Zi.dispatchEvent(Gi.CHECKOUT_INITIATED,{event:Gi.CHECKOUT_INITIATED,data:{orderType:"paid",orderData:a(),paymentMethod:m}})}catch(e){D.b("Could not dispatch registration events",{level:F.a.Critical,extra:{step:Gi.CHECKOUT_INITIATED,data:{orderType:"paid",paymentMethod:m}}})}m===G?function(){var e=!0;return W(Object(C.a)(Object(C.a)({},M),{},{touched:Object(C.a)(Object(C.a)({},M.touched),{},{"card-expiry":!0,"card-cvc":!0,"card-number":!0})})),M.validDate||(e=!1),M.validCard||(e=!1),(!M.cardCvc||M.cardCvc&&M.cardCvc.length<3)&&(e=!1),e}()&&s(E.current.onSubmit,M):s(E.current.onSubmit,M)}))]}),Object(vt.jsx)(rd,{paymentMethod:m,setPaymentSuccessful:c,event:i,ref:E,cardInfo:M,orderData:S,getOrderDataForAnalytics:a})]}):Object(vt.jsx)("section",{className:"registration--body",children:Object(vt.jsxs)(b.Fragment,{children:[Object(vt.jsx)("h2",{tabIndex:-1,children:ln}),Object(vt.jsx)("p",{children:On})]})})},bd=function(e){var t=Object.keys(e);return t.length>0&&Object(vt.jsx)("div",{className:"errorMessages mb20 mt10 mauto w60p",children:t.map((function(t){return e[t]&&Object(vt.jsx)(Kr,{error:e[t]},t)}))})},fd=function(e,t,n){return Object(vt.jsxs)("button",{type:"button",name:"paymentOption",role:"radio","aria-checked":t===e,className:"btn payment--option btn-default ".concat(t===e?"btn--active":""),onClick:n,value:e,children:[e===G&&"Visa / MasterCard",e===K&&Ta,e===Q&&"EHF faktura",e===$&&"Post",e===Y&&"Arrival",e===X&&"Vipps"]},e)},vd=mr((function(e){return{orderIsFree:e.funcs.orderIsFree,getOrderDataForAnalytics:e.funcs.getOrderDataForAnalytics,event:e.event,orderInfo:e.orderInfo,users:e.users,customerId:e.customerId,additionals:e.additionals,paymentInfo:e.paymentInfo,handleSubmit:e.funcs.handleSubmit,handleNewSubmit:e.funcs.handleNewSubmit,setPaymentOption:e.funcs.setPaymentOption,setPaymentSuccessful:e.funcs.setPaymentSuccessful,handleChange:e.funcs.handleChange,settings:e.settings,sumTicketFee:e.sumTicketFee,returnAllTicketErrors:e.funcs.returnAllTicketErrors,coupon:e.coupon.code,validOrgNo:e.validOrgNo}}))(Object(b.memo)(hd)),jd=Object(g.f)(vd),gd=mr((function(e){return{itemsAvailabilityData:e.itemsAvailabilityData,handleCollapse:e.funcs.handleCollapse,components:e.components,convertedAdditionals:e.convertedAdditionals,additionals:e.event.additionals,stateAdditionals:e.additionals,showErrorHelper:e.funcs.showErrorHelper,showErrors:e.showErrors,orderIsFree:e.funcs.orderIsFree,orderErrors:e.errors,saveError:e.funcs.saveError,validateAdditionalItemReserve:e.funcs.validateAdditionalItemReserve,hasAdditionals:Wr(e.event.additionals,e.additionals,e.convertedAdditionals).length>0}}))((function(e){var t=e.activeMode,n=e.components,a=e.handleCollapse,i=e.additionals,r=e.stateAdditionals,s=e.showErrorHelper,c=e.showErrors,o=e.orderIsFree,d=e.convertedAdditionals,l=e.orderErrors,u=e.saveError,m=e.hasAdditionals,p=(e.data,e.itemsAvailabilityData),h=e.validateAdditionalItemReserve,f=Object(b.useRef)(),v=n[ve],j=t!==H^!n[ve].isTouched||!m;return Object(b.useEffect)((function(){f.current&&n[ve].expanded&&setTimeout((function(){rr(f,t)}),100)}),[n[ve].expanded]),j?null:Object(vt.jsx)("div",{className:"registration--body",id:"order-details",ref:f,children:Object(vt.jsxs)(bs.AccordionItem,{expanded:t!==H||n[ve].expanded,children:[Object(vt.jsxs)("div",{className:"df jcsb aic",children:[Object(vt.jsx)("h2",{tabIndex:-1,id:"order-additional",className:"mb0",children:Wt(!0)}),Object(vt.jsx)(bc,{hidden:t!==H,ariaLabelledBy:"order-additional",isTouched:v.isTouched,expanded:v.expanded,handleCollapse:a,current:ve})]}),v.expanded&&Object(vt.jsxs)(bs.AccordionItemBody,{children:[Object(vt.jsx)(Vr,{ticket:null,orderAdditionals:function(){for(var e=Object(k.a)(i),t=e.length,n=0;n<t;n++){var a=e[n];a.available&&(a.left=p[a.id].left)}return e}(),stateAdditionals:r,convertedAdditionals:d}),t===H&&Object(vt.jsx)("div",{className:"checkin-right",children:Object(vt.jsx)(Cs,{testId:"order-next",errors:l,showErrorHelper:s,showErrors:c,handleCollapse:a,current:ve,target:je,nextName:o()?un:dn,handleValidation:function(){return function(e,t,n,a,i){var r=!0,s=new si,c={},o=function(e){c[e]&&c[e].hasError?r=!1:delete c[e]},d=[],l=Object.values(n).filter((function(e){return e.required}));return oi(l,t,d),d.forEach((function(e){if(!isNaN(e)){var n=t[e]?t[e]:null;if(!n){var a=l.find((function(t){return t.id===e}));if("multicheckbox"===a.type)for(var i=0,r=Object.values(a.children);i<r.length;i++){var d=r[i];if(t[d.id]){n=t[d.id];break}}}var u=s.validate("required",n);c[e]=u,o(e)}})),Object.values(t).forEach((function(e){if("child"===e.type){var a=n[e.parent_id];a.minSelectableChoices&&Object.values(t).filter((function(t){return t.parent_id===e.parent_id})).length<a.minSelectableChoices&&(c[e.id]={hasError:!0,message:Jn(a.minSelectableChoices)},o(e.id))}})),i&&i(t,"order"),a?c:(e(c),r)}(u,r,d,null,h)}})})]})]})})})),Od=Object(g.d)(Object(g.e)(Ie,{props:function(e){return{data:e.data}},options:function(){return{forceFetch:!0,fetchPolicy:"cache",variables:Je()}}}))(gd),yd=function(e){Object(_.a)(n,e);var t=Object(I.a)(n);function n(e){var a;return Object(E.a)(this,n),(a=t.call(this,e)).state={makeNewReservation:!1},a.validateItems=function(){qi({forceWaitinglist:a.props.forceWaitinglist,itemsToReserve:a.props.itemsToReserve,resetItemsToReserve:a.props.resetItemsToReserve})},a.reservationReserveClickTimer=function(){setTimeout((function(){var e=a.props,t=e.reservationTimer,n=e.totalQuantity;if(!t.didReserve&&n>=0){var i=Date.now()-t.timerStart;Math.floor(i/1e3)>=1?(a.validateItems(),a.props.setReservationTimer(null,!0)):a.reservationReserveClickTimer()}}),1e3)},a}return Object(S.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){this.props.reservationTimer.didReserve||this.reservationReserveClickTimer()}},{key:"render",value:function(){return Object(vt.jsx)(vt.Fragment,{})}}]),n}(f.a.Component),xd=mr((function(e){return{totalQuantity:e.totalQuantity,setReservationTimer:e.funcs.setReservationTimer,itemReserveQueueComplete:e.itemReserveQueueComplete,forceWaitinglist:e.forceWaitinglist,didReserve:e.didReserve,timerStart:e.timerStart,setTimerStart:e.funcs.setTimerStart,setDidReserve:e.funcs.setDidReserve,resetItemsToReserve:e.funcs.resetItemsToReserve,itemsToReserve:e.itemsToReserve,reservationTimer:e.reservationTimer}}))(yd),kd=function(e){var t=e.seats,n=e.orderSummary;return Object(vt.jsx)(vt.Fragment,{children:t.length>0?n?Object(vt.jsxs)(vt.Fragment,{children:[Object(vt.jsx)("tr",{className:"table-ticket"}),t.map((function(e){return Object(vt.jsx)(vt.Fragment,{children:Object(vt.jsx)("tr",{className:"table-ticket table-additional",children:Object(vt.jsx)("td",{colSpan:"4",children:0==e.row?Object(vt.jsxs)("p",{children:[Kn," ",e.fieldTitle," - Stand ",e.seat]}):Object(vt.jsxs)("p",{children:[Kn," ",e.fieldTitle," - ",Qn," ",e.row," - ",Gn," ",e.seat]})})},"".concat(e.fieldTitle,"-").concat(e.row,"-").concat(e.seat))})}))]}):Object(vt.jsxs)("div",{className:"seatmap-summary",children:[Object(vt.jsx)("p",{className:"summary-title",children:Xn}),t.map((function(e){return Object(vt.jsxs)("div",{className:"seat",children:[Object(vt.jsxs)("div",{className:"seat-info",children:[Object(vt.jsxs)("p",{children:[Kn," ",Object(vt.jsx)("b",{children:e.fieldTitle})]}),Object(vt.jsxs)("p",{children:[Qn," ",Object(vt.jsx)("b",{children:e.row})]}),Object(vt.jsxs)("p",{children:[Gn," ",Object(vt.jsx)("b",{children:e.seat})]})]}),Object(vt.jsx)("div",{className:"seat-price"})]})}))]}):null})};kd.defaultProps={orderSummary:!1};Object(g.d)(mr((function(e){return{seats:e.seats}})))(kd);var Cd=n(863),Td="available",Ed="equipment",Sd="hover",Nd="selected",_d="selected-blocked",Id="reserved",wd="reserved-blocked",Ad="handicapped",Rd="confirmed",Pd=function(){function e(t,n,a){var i=this;Object(E.a)(this,e),this.channelName="",this.seats={},this.seatsSelected={},this.seatsReserved={},this.svgSeatmap=Object(vt.jsx)("svg",{}),this.svgData="",this.options={seats:4,pickseats:!1,seats_l2r:!0,setup:!1,admin_mode:!1,seats_buffer:2},this.shouldPickSeatsOverride=!1,this.dragStart=!1,this.scale=1,this.seatmapMousedown=!1,this.mouseStart={X:0,Y:0},this.svgTransformPosition={X:0,Y:0},this._multitouch={pos1X:null,pos1Y:null,pos2X:null,pos2Y:null,dist:null,transform:"",ts:null,scale:null,svgX:null,svgY:null},this.onSeatSelect=function(){},this.parseSvg=function(){document.getElementsByClassName("seatmap_svg")[0].innerHTML=i.svgData,i.svgSeatmap=document.querySelector("svg.seatmap");var e={};i.svgSeatmap.querySelectorAll("g.seatmap_field").forEach((function(t){var n=t.getAttribute("data-field");e[n]={},t.getElementsByClassName("seatmap_row").forEach((function(a){var i=a.getAttribute("data-row");e[n][i]={},a.getElementsByClassName("seatmap_seat").forEach((function(a){var r=a.getAttribute("data-seat");e[n][i][r]=a,a.setAttribute("data-field-title",t.getAttribute("data-field-name")),a.setAttribute("data-field",n),a.setAttribute("data-row",i)}))}))})),i.seats=Object(C.a)({},e),i.initWebsocketEvent(),i.seatmapInteraction()},this.initWebsocketEvent=function(){i.channelName="seatmap-".concat(document.event_id),window.socketHandler.findOrCreate(i.channelName),window.socketHandler.bindEvent("seatsStatus",(function(e){i.updateSeats(e.seats)})),window.socketHandler.bindEvent("seatsReserved",(function(e){var t=e.seats;t.length;for(var n in t){var a=i.svgSeatmap.getElementById(n);a.setAttribute("data-status",t[n]==Td?"":t[n]),t[n]===Id?(a.setAttribute("data-status",Nd),1,t[n]=a):t[n]===Td||t[n]===Ed?delete t[n]:i.options.pickseats||i.svgSeatmap.getElementById(n).setAttribute("data-status","")}Object.keys(i.seatsSelected).forEach((function(e){t[e]||i.seatsSelected[e].setAttribute("data-status","")})),i.seatsSelected=t,i.onSeatSelect(Object.values(i.seatsSelected).map((function(e){var t=e.getAttribute("data-unit");return Object(C.a)(Object(C.a)({},e.dataset),{},{id:e.getAttribute("id"),unit:null!==t&&void 0!==t?t:null})}))),i.seatsSelected=t;document.getElementById("seatmap_footer");i.updateBlockedSeats(Object.values(t),Nd)}))},this.seatmapInteraction=function(){i.svgSeatmap.addEventListener("wheel",(function(e){if(e.deltaY>0){if(i.scale>.8){var t=e.deltaY>0&&e.deltaY<-100?e.deltaY/100:-.1;i.scale+=t,i.updateScale()}}else if(i.scale<6){var n=e.deltaY<0&&e.deltaY>100?e.deltaY/100:.1;i.scale+=n,i.updateScale()}})),i.svgSeatmap.addEventListener("mousedown",(function(e){e.preventDefault(),i.svgTransformPosition=Md(i.svgSeatmap),i.mouseStart={X:e.clientX,Y:e.clientY},i.seatmapMousedown=!0})),i.svgSeatmap.addEventListener("mousemove",(function(e){e.preventDefault(),i.seatmapMousedown&&(i.dragStart=!0,Dd(i.svgSeatmap,i.scale,"translate(".concat(Number(i.svgTransformPosition.X)+-(i.mouseStart.X-e.clientX)/i.scale,"px, ").concat(Number(i.svgTransformPosition.Y)+-(i.mouseStart.Y-e.clientY)/i.scale,"px)")))})),i.svgSeatmap.addEventListener("mouseup",(function(e){e.preventDefault(),i.seatmapMousedown=!1,i.svgTransformPosition=Md(i.svgSeatmap),i.svgSeatmap.removeEventListener("mousemove",(function(){}))}));var e=document.querySelector("div.seatmap_wrapper"),t=new Cd.Manager(e,{inputClass:Cd.SUPPORT_POINTER_EVENTS?Cd.PointerEventInput:Cd.TouchInput}),n=new Cd.Pinch,a=new Cd.Tap,r=new Cd.Pan,s=0;t.add([a,n,r]),t.on("tap",(function(e){var t,n,a,r,c,o,d,l;if(!((null===(t=e.target)||void 0===t||null===(n=t.classList)||void 0===n?void 0:n.contains("seatmap_zoomcontrol"))||(null===(a=e.target)||void 0===a||null===(r=a.classList)||void 0===r?void 0:r.contains("close-seatmap"))||(null===(c=e.target)||void 0===c||null===(o=c.classList)||void 0===o?void 0:o.contains("icons8-delete"))||(null===(d=e.target)||void 0===d||null===(l=d.closest("span"))||void 0===l?void 0:l.classList.contains("seatmap_pick_mode")))){if((s=e.tapCount)<2){var u=e.target;return setTimeout((function(){if(s<2){var e=u,t=e.closest("g");t&&/seatmap_field/.test(t.getAttribute("class"))?t.querySelector("path.seatmap_field").dispatchEvent(new Event("mouseover")):/seatmap_seat/.test(e.getAttribute("class"))&&(this.dragStart=!1,e.dispatchEvent(new Event("mouseup")))}}),(e.pointerType,300)),void e.preventDefault()}i.scale=1,i.svgTransformPosition={X:0,Y:0},i.updateScale(),e.preventDefault()}})),t.on("pan",(function(e){Dd(i.svgSeatmap,i.scale,"translate(".concat(Number(i.svgTransformPosition.X)+-(i.mouseStart.X-e.deltaX)/i.scale,"px, ").concat(Number(i.svgTransformPosition.Y)+-(i.mouseStart.Y-e.deltaY)/i.scale,"px)"))})),t.on("panend",(function(e){i.svgTransformPosition=Md(i.svgSeatmap)})),t.on("panstart",(function(e){i.svgTransformPosition=Md(i.svgSeatmap),i.mouseStart={X:e.deltaX,Y:e.deltaY}})),t.on("pinchend",(function(e){i._multitouch.scale=i.scale})),t.on("pinch",(function(e){i.scale=Math.max(.999,Math.min(i._multitouch.scale*e.scale,4)),i.updateScale(),e.preventDefault()})),i.svgSeatmap.addEventListener("mouseout",(function(e){i.selectSeat(null,Sd),i.updateBlockedSeats(Object.values(i.seatsSelected),Nd)})),i.svgSeatmap.querySelectorAll("path.seatmap_field").forEach((function(e){e.addEventListener("mouseout",i.fieldLeave),e.addEventListener("mouseover",i.fieldHover),e.addEventListener("click",i.fieldClick)})),i.svgSeatmap.querySelectorAll(".seatmap_seat, .seatmap_seat ~ text").forEach((function(e){e.addEventListener("mouseover",(function(t){i.selectSeat("text"===e.nodeName?e.previousSibling:e,Sd)})),e.addEventListener("mousedown",(function(e){i.dragStart=!1})),e.addEventListener("mouseup",(function(t){var n="text"==e.nodeName?e.previousSibling:e;i.dragStart||(i.options.setup?i.selectSeat(n,n.getAttribute("data-status")==Ed?Td:Ed):i.selectSeat(n,Nd))}))}))},this.zoomIn=function(){i.scale+=.15,i.updateScale()},this.zoomOut=function(){i.scale-=.15,i.updateScale()},this.updateScale=function(){i.svgSeatmap&&i.svgSeatmap.style&&(i.svgSeatmap.style.transform="scale(".concat(i.scale,") translate(").concat(i.svgTransformPosition.X,"px, ").concat(i.svgTransformPosition.Y,"px)"))},this.fieldClick=function(e){if(!e.currentTarget.closest("g.seatmap_field").classList.contains("free-seating"))return!1},this.fieldHover=function(e){if("number"!=typeof e.target.style.opacity||0!=e.target.style.opacity){var t=e.currentTarget,n=t.closest("g.seatmap_field"),a=n.getAttribute("data-field"),r=n.getElementsByTagName("text")[0],s=n.classList.contains("free-seating")?.6:0;r.style.opacity=s,t.style.transition="opacity 0.3s",t.style.opacity=s,n.prepend(r),n.prepend(t),i.svgSeatmap.querySelectorAll("g.seatmap_field").forEach((function(e){var t=e.querySelector("path.seatmap_field");a!==e.getAttribute("data-field")&&(parseFloat(t.style.opacity)>.1||t.dispatchEvent(new Event("mouseout")))}))}},this.fieldLeave=function(e){var t=e.currentTarget,n=t.closest("g.seatmap_field");if(!(e.relatedTarget&&e.relatedTarget.classList.contains("seatmap_field_label")||e.relatedTarget&&e.relatedTarget.classList.contains("seatmap_seat"))){var a=e.currentTarget.parentNode.getElementsByTagName("text")[0];n.append(t),n.append(a),a.style.opacity=1,e.target.style.opacity=.8}},this.resetTransform=function(){var e=window.getComputedStyle(document.getElementsByClassName("seatmap_svg")[0]),t=window.getComputedStyle(i.svgSeatmap);i.svgTransformPosition={X:e.width.replace("px","")/2-t.width.replace("px","")/2,Y:e.height.replace("px","")/2-t.height.replace("px","")/2},i.scale=1,i.updateScale()},this.setPickseats=function(){i.options.pickseats=!i.options.pickseats,i.options.pickseats?document.getElementById("seatmap").getElementsByClassName("seatmap_pick_mode")[0].classList.remove("multiple"):document.getElementById("seatmap").getElementsByClassName("seatmap_pick_mode")[0].classList.add("multiple")},this.selectSeat=function(e,t){var n=i.options.setup&&t!=Sd?{}:i.seatsSelected;if(null!==e){var a=i.options.pickseats;i.shouldPickSeatsOverride=i.options.pickseats;var r=e.getAttribute("id"),s=e.getAttribute("data-seat"),c=e.getAttribute("data-status"),o=[],d=e.getAttribute("data-field"),l=e.getAttribute("data-row");if((e.getAttribute("data-unit")||0==l)&&(a=!0,i.shouldPickSeatsOverride=!0),null!=d&&null!=l&&null!=s&&d in i.seats&&l in i.seats[d]&&s in i.seats[d][l]&&!(c==Id||c==wd||t==Sd&&c==Ed||t==Sd&&c==Nd)){var u={};for(var m in n)(t==Sd&&n[m].getAttribute("data-status")==Sd||t!=Sd)&&(t!=Sd&&o.push(n[m]),a||(u[m]=n[m],delete n[m]));a&&t==Nd&&r in n&&n[r].getAttribute("data-status")==Nd&&(u[r]=n[r],delete n[r]);var p=i.seats[d][l],h=Object.keys(p),b=h.length,f=h.indexOf(s),v=null;if((i.options.seats_l2r&&f+1==b||!i.options.seats_l2r&&0!=f)&&(h.reverse(),f=h.indexOf(s)),!(b<i.options.seats)||a){!a&&f+1+i.options.seats>b&&(f=b-i.options.seats);for(var j=a?f+1:f+i.options.seats,g=[],O=!1,y=f;y<j;y++)v=p[h[y]],g.push(v),(v.getAttribute("data-status")==Id||v.getAttribute("data-status")==wd||v.getAttribute("data-status")==Ed&&0==i.options.setup&&0==i.options.admin_mode||v.classList.contains(Ad)&&0==i.options.admin_mode||v.getAttribute("data-status")==Ed&&0==i.options.setup)&&(O=!0);if(O)for(var m in u)n[m]=u[m];else{for(y=0;y<g.length;y++)v=g[y],t==Sd&&v.getAttribute("data-status")==Nd||a&&r in u||(v.setAttribute("data-status",t==Td?"":t),n[v.getAttribute("id")]=v);for(var m in u)u[m].setAttribute("data-status","");t!=Sd&&(a?i.reserveSeat(r,i.options.setup?t:null):i.reserveSeats(i.seatsSelected,i.options.setup?t:null))}i.updateBlockedSeats(Object.values(i.seatsSelected),Nd)}}}else for(var x in n)n[x].getAttribute("data-status")==Sd&&(n[x].setAttribute("data-status",""),delete n[x])},this.reserveSeat=function(e,t){window.socketHandler.sendEvent("checkin:seatsReserve",{seats:[Number(e)],pickseats:i.options.pickseats||i.shouldPickSeatsOverride,status:t},i.channelName)},this.reserveSeats=function(e,t){var n=[];for(var a in e)n.push(Number(e[a].getAttribute("id")));window.socketHandler.sendEvent("checkin:seatsReserve",{seats:n,pickseats:i.options.pickseats||i.shouldPickSeatsOverride,status:t},i.channelName)},this.updateSeats=function(e){var t,n=[];for(var a in e){t=e[a];var r=i.svgSeatmap.getElementById(a);if(r){if(r.getAttribute("data-status")===Nd)continue;n.push(r),r.setAttribute("data-status",t==Rd?Id:t==Td?"":t)}}i.updateBlockedSeats(n,Id)},this.onActive=function(){var e=window.getComputedStyle(document.getElementsByClassName("seatmap_svg")[0]),t=window.getComputedStyle(i.svgSeatmap);i.svgTransformPosition={X:e.width.replace("px","")/2-t.width.replace("px","")/2,Y:e.height.replace("px","")/2-t.height.replace("px","")/2},i.updateScale()},this.svgData=n.svg,this.options.seats=t,this.options.seats_buffer=n.options.seatsBuffer,this.onSeatSelect=a}return Object(S.a)(e,[{key:"updateBlockedSeats",value:function(e,t){var n=t===Id?wd:_d;n===_d&&this.svgSeatmap.querySelectorAll("path[data-status='"+_d+"']").forEach((function(e){e.setAttribute("data-status","")}));for(var a=0;a<e.length;a++){var i=e[a];if(i.getAttribute("data-status")==Id||i.getAttribute("data-status")==Nd||i.getAttribute("data-status")==Sd||""==i.getAttribute("data-status"))for(var r=""==i.getAttribute("data-status"),s=1;s<=this.options.seats_buffer;s++){var c=this.svgSeatmap.querySelector("path.seatmap_seat[data-field='"+i.getAttribute("data-field")+"'][data-row='"+i.getAttribute("data-row")+"'][data-seat='"+(parseInt(i.getAttribute("data-seat"))+s)+"']"),o=this.svgSeatmap.querySelector("path.seatmap_seat[data-field='"+i.getAttribute("data-field")+"'][data-row='"+i.getAttribute("data-row")+"'][data-seat='"+(parseInt(i.getAttribute("data-seat"))-s)+"']");if(c&&(""==c.getAttribute("data-status")||r&&(c.getAttribute("data-status")==_d||c.getAttribute("data-status")==wd))){var d=!1;if(r)for(var l=1;l<=this.options.seats_buffer;l++){var u=this.svgSeatmap.querySelector("path.seatmap_seat[data-field='"+i.getAttribute("data-field")+"'][data-row='"+i.getAttribute("data-row")+"'][data-seat='"+(parseInt(i.getAttribute("data-seat"))+s+l)+"']");(u&&u.getAttribute("data-status")==Id||u&&u.getAttribute("data-status")==Nd)&&(d=!0)}d||(c.getAttribute("data-status")==_d?c.setAttribute("data-status",wd):c.setAttribute("data-status",r?"":n))}if(o&&(""==o.getAttribute("data-status")||r&&(o.getAttribute("data-status")==_d||o.getAttribute("data-status")==wd))){var m=!1;if(r)for(var p=1;p<=this.options.seats_buffer;p++){var h=this.svgSeatmap.querySelector("path.seatmap_seat[data-field='"+i.getAttribute("data-field")+"'][data-row='"+i.getAttribute("data-row")+"'][data-seat='"+(parseInt(i.getAttribute("data-seat"))-s-p)+"']");(h&&h.getAttribute("data-status")==Id||h&&h.getAttribute("data-status")==Nd)&&(m=!0)}m||(o.getAttribute("data-status")==_d?o.setAttribute("data-status",wd):o.setAttribute("data-status",r?"":n))}}}}}]),e}();var Dd=function(e,t,n){e.style.transform="scale(".concat(t,")")+n},Md=function(e){var t=e.style.transform.indexOf("translate"),n=e.style.transform.substring(t,e.style.transform.length).replace("translate","").replaceAll("(","").replaceAll(")","").replaceAll("px","").split(",");return 2===n.length?{X:n[0],Y:n[1]}:{X:0,Y:0}},Fd=Object(b.memo)((function(e){var t,n,a,i,r=e.seatmapData,s=e.ticketAmount,c=e.isActive,o=e.closeSeatmap,d=e.seats,l=e.setSeats,u=e.getPriceGroups,m=function(e,t,n){var a=Object(b.useState)(new Pd(t,e,n)),i=Object(U.a)(a,1)[0];return{onActive:i.onActive,scale:i.scale,zoomIn:i.zoomIn,zoomOut:i.zoomOut,resetTransform:i.resetTransform,setPickseats:i.setPickseats,getSeatmap:i.parseSvg,getSeats:function(){return i.seats}}}(r,s,(function(e){l(e)})),p=m.onActive,h=m.getSeatmap,f=m.zoomIn,v=m.zoomOut,j=m.resetTransform,g=m.setPickseats,O=m.pickseats;m.getSeats;Object(b.useEffect)((function(){h()}),[]),Object(b.useEffect)((function(){c&&p()}),[c]);var y=u();return Object(vt.jsxs)("div",{id:"seatmap",style:c?{}:{position:"absolute"},className:c&&"seatmap-fade-in",children:[Object(vt.jsxs)("div",{className:"seatmap_wrapper","data-event":"21457",style:{position:"absolute",top:"0",left:"0",bottom:"70px",right:"0"},children:[c&&Object(vt.jsx)("div",{className:"close-seatmap",onClick:o,children:d.length>0?Object(vt.jsxs)(vt.Fragment,{children:[Nt,Object(vt.jsx)("span",{className:" icons8-checkmark"})]}):Object(vt.jsxs)(vt.Fragment,{children:[Zn,Object(vt.jsx)("span",{className:" icons8-delete"})]})}),Object(vt.jsx)("div",{className:"seatmap_svg"})]}),Object(vt.jsxs)("div",{className:"seatmap_controls",style:{display:"initial"},children:[Object(vt.jsx)("span",{className:"seatmap_zoomcontrol zoom_reset",onClick:j,children:Object(vt.jsx)("i",{className:"seatmap_zoomcontrol icons8-reset"})}),Object(vt.jsx)("span",{className:"seatmap_zoomcontrol zoom_in",onClick:f,children:"+"}),Object(vt.jsx)("span",{className:"seatmap_zoomcontrol zoom_out",onClick:v,children:"-"}),Object(vt.jsxs)("span",{className:"seatmap_pick_mode multiple",title:"Switch between selecting grouped or single seats",onClick:function(){return g(!O)},children:[Object(vt.jsx)("svg",{className:"seatmap seatmap_pick_mode",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 32 32",xmlSpace:"preserve",children:Object(vt.jsx)("path",{"data-status":"",d:"M4.512,26.021C4.512,27.413,5.639,29,7.032,29h18.414c1.392,0,2.521-1.587,2.521-2.979l0.876-20.334 c0-1.392-1.128-2.688-2.52-2.688H6.155C4.764,3,3.635,4.296,3.635,5.688L4.512,26.021z"})}),Object(vt.jsx)("svg",{className:"seatmap seatmap_pick_mode",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 32 32",xmlSpace:"preserve",children:Object(vt.jsx)("path",{"data-status":"",d:"M4.512,26.021C4.512,27.413,5.639,29,7.032,29h18.414c1.392,0,2.521-1.587,2.521-2.979l0.876-20.334 c0-1.392-1.128-2.688-2.52-2.688H6.155C4.764,3,3.635,4.296,3.635,5.688L4.512,26.021z"})})]})]}),c&&Object(vt.jsxs)("div",{id:"seatmap_footer",children:[Object(vt.jsx)("div",{className:"seatmap_explainations",children:Object(vt.jsxs)("ul",{children:[y.length<=1?Object(vt.jsxs)("li",{children:[null!==(t=null===(n=y[0])||void 0===n?void 0:n.description)&&void 0!==t?t:ha," ",Object(vt.jsx)("svg",{className:"seatmap",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 32 32",xmlSpace:"preserve",children:Object(vt.jsx)("path",{className:"seatmap_seat","data-price-group":null!==(a=null===(i=y[0])||void 0===i?void 0:i.name)&&void 0!==a?a:"A",d:"M4.512,26.021C4.512,27.413,5.639,29,7.032,29h18.414c1.392,0,2.521-1.587,2.521-2.979l0.876-20.334 c0-1.392-1.128-2.688-2.52-2.688H6.155C4.764,3,3.635,4.296,3.635,5.688L4.512,26.021z"})})]}):Object(vt.jsx)(vt.Fragment,{children:y.map((function(e){var t;return Object(vt.jsxs)("li",{children:[null!==(t=e.description)&&void 0!==t?t:e.name," ",Object(vt.jsx)("svg",{className:"seatmap",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 32 32",xmlSpace:"preserve",children:Object(vt.jsx)("path",{className:"seatmap_seat","data-price-group":e.name,d:"M4.512,26.021C4.512,27.413,5.639,29,7.032,29h18.414c1.392,0,2.521-1.587,2.521-2.979l0.876-20.334 c0-1.392-1.128-2.688-2.52-2.688H6.155C4.764,3,3.635,4.296,3.635,5.688L4.512,26.021z"})})]})}))}),Object(vt.jsxs)("li",{children:[ta," ",Object(vt.jsx)("svg",{className:"seatmap",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 32 32",xmlSpace:"preserve",children:Object(vt.jsx)("path",{className:"seatmap_seat","data-status":"selected",d:"M4.512,26.021C4.512,27.413,5.639,29,7.032,29h18.414c1.392,0,2.521-1.587,2.521-2.979l0.876-20.334 c0-1.392-1.128-2.688-2.52-2.688H6.155C4.764,3,3.635,4.296,3.635,5.688L4.512,26.021z"})})]}),Object(vt.jsxs)("li",{children:[ea," ",Object(vt.jsx)("svg",{className:"seatmap",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 32 32",xmlSpace:"preserve",children:Object(vt.jsx)("path",{className:"seatmap_seat","data-status":"reserved",d:"M4.512,26.021C4.512,27.413,5.639,29,7.032,29h18.414c1.392,0,2.521-1.587,2.521-2.979l0.876-20.334 c0-1.392-1.128-2.688-2.52-2.688H6.155C4.764,3,3.635,4.296,3.635,5.688L4.512,26.021z"})})]}),Object(vt.jsxs)("li",{children:[na,Object(vt.jsx)("svg",{className:"seatmap",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 32 32",xmlSpace:"preserve",children:Object(vt.jsx)("path",{className:"seatmap_seat handicapped","data-status":"",d:"M1.512,26.021C1.512,27.413,2.639,29,4.032,29h24.414c1.392,0,2.521-1.587,2.521-2.979l0.876-20.334 c0-1.392-1.128-2.688-2.52-2.688H3.155C1.764,3,0.635,4.296,0.635,5.688L1.512,26.021z"})})]})]})}),d.length>0&&Object(vt.jsx)(vt.Fragment,{children:Object(vt.jsx)("div",{className:"seatmap-footer-header",onClick:o,children:Nt})})]})]})})),Ld=Object(g.d)(mr((function(e){return{setSeats:e.funcs.setSeats,seats:e.seats,getPriceGroups:e.funcs.getPriceGroups}})))(Fd),Wd=n(7),qd=n.n(Wd),Vd=n(74),Bd=n(166),Ud=n(996),Hd=n(1004),zd=n(146),Kd=n(517),Qd=(n(198),n(864),n(348)),Gd=n(414),$d=n(997),Yd=n(5),Xd=n(1002),Jd=n(1003),Zd=n(253),el=(n(547),n(413)),tl=n(408),nl=n.n(tl),al=n(520),il=n.n(al),rl=n(521),sl=n.n(rl),cl=n(551),ol=n(350),dl=n(549),ll=(n(415),n(62),n(177),n(545),n(335),n(320)),ul=n(133),ml=(n(167),n(107)),pl=(n(345),n(69),n(346),n(522),n(43),n(313),n(524),n(347)),hl=n.n(pl),bl=n(525),fl=n.n(bl),vl=n(526),jl=n.n(vl);n(957),n(349),n(548);function gl(e,t,n,a,i,r,s){try{var c=e[r](s),o=c.value}catch(d){return void n(d)}c.done?t(o):Promise.resolve(o).then(a,i)}function Ol(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){gl(r,a,i,s,c,"next",e)}function c(e){gl(r,a,i,s,c,"throw",e)}s(void 0)}))}}function yl(){return yl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},yl.apply(this,arguments)}function xl(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}var kl=function(e){var t=e.size,n=e.variant;return f.a.createElement("span",{className:qd()("checkin-loader","checkin-loader--"+t,"checkin-loader--"+n),role:"status"},f.a.createElement("span",{className:"checkin-loader__text"},"Loading..."))};kl.defaultProps={variant:"default",size:"md"};var Cl=["size","variant","icon","iconPlacement","loading","disabled","className","onlyHTMLButton","children"],Tl=Object(b.forwardRef)((function(e,t){var n=e.size,a=e.variant,i=e.icon,r=e.iconPlacement,s=e.loading,c=e.disabled,o=e.className,d=e.onlyHTMLButton,l=e.children,u=xl(e,Cl),m=qd()("checkin-btn","checkin-btn--"+a,"checkin-btn--"+n,o);return f.a.createElement("button",Object.assign({},u,{ref:t,className:m,disabled:c||s}),f.a.createElement("span",{className:"checkin-btn__inner"},i&&"left"===r&&f.a.createElement("span",{className:"checkin-btn__icon"},i),l&&!d&&f.a.createElement("span",{className:"checkin-btn__content"},l),i&&"right"===r&&f.a.createElement("span",{className:"checkin-btn__icon"},i)),l&&d&&l,s&&f.a.createElement("span",{className:"checkin-btn__loader"},f.a.createElement(kl,{size:"sm",variant:"default"})))}));Tl.displayName="Button",Tl.defaultProps={type:"button",size:"md",loading:!1,disabled:!1,iconPlacement:"right"};var El=Object.assign(Tl,{Primary:function(e){return f.a.createElement(Tl,Object.assign({},e,{variant:"primary"}))},Secondary:function(e){return f.a.createElement(Tl,Object.assign({},e,{variant:"secondary"}))},Outline:function(e){return f.a.createElement(Tl,Object.assign({},e,{variant:"outline"}))},Text:function(e){return f.a.createElement(Tl,Object.assign({},e,{variant:"text"}))},Danger:function(e){return f.a.createElement(Tl,Object.assign({},e,{variant:"danger"}))}}),Sl=function(e){var t=e.name,n=e.className,a=e.testId;return f.a.createElement("i",{className:qd()("icons8-"+t,n),"data-testid":a})};function Nl(e,t){return e(t={exports:{}},t.exports),t.exports}zd.a.use(Kd.a).use(Bd.e).init({fallbackLng:"en",debug:!1,react:{bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transKeepBasicHtmlNodesFor:["br","strong","b","i","p"],useSuspense:!0}});var _l=Nl((function(e){var t=function(e){var t,n=Object.prototype,a=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function o(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(w){o=function(e,t,n){return e[t]=n}}function d(e,t,n,a){var i=t&&t.prototype instanceof f?t:f,r=Object.create(i.prototype),s=new N(a||[]);return r._invoke=function(e,t,n){var a=u;return function(i,r){if(a===p)throw new Error("Generator is already running");if(a===h){if("throw"===i)throw r;return I()}for(n.method=i,n.arg=r;;){var s=n.delegate;if(s){var c=T(s,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===u)throw a=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=p;var o=l(e,t,n);if("normal"===o.type){if(a=n.done?h:m,o.arg===b)continue;return{value:o.arg,done:n.done}}"throw"===o.type&&(a=h,n.method="throw",n.arg=o.arg)}}}(e,n,s),r}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(w){return{type:"throw",arg:w}}}e.wrap=d;var u="suspendedStart",m="suspendedYield",p="executing",h="completed",b={};function f(){}function v(){}function j(){}var g={};o(g,r,(function(){return this}));var O=Object.getPrototypeOf,y=O&&O(O(_([])));y&&y!==n&&a.call(y,r)&&(g=y);var x=j.prototype=f.prototype=Object.create(g);function k(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,r,s,c){var o=l(e[i],e,r);if("throw"!==o.type){var d=o.arg,u=d.value;return u&&"object"===typeof u&&a.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(u).then((function(e){d.value=e,s(d)}),(function(e){return n("throw",e,s,c)}))}c(o.arg)}var i;this._invoke=function(e,a){function r(){return new t((function(t,i){n(e,a,t,i)}))}return i=i?i.then(r,r):r()}}function T(e,n){var a=e.iterator[n.method];if(a===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method))return b;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var i=l(a,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,b;var r=i.arg;return r?r.done?(n[e.resultName]=r.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,b):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function _(e){if(e){var n=e[r];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(a.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}return{next:I}}function I(){return{value:t,done:!0}}return v.prototype=j,o(x,"constructor",j),o(j,"constructor",v),v.displayName=o(j,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,j):(e.__proto__=j,o(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},k(C.prototype),o(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,a,i,r){void 0===r&&(r=Promise);var s=new C(d(t,n,a,i),r);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},k(x),o(x,c,"Generator"),o(x,r,(function(){return this})),o(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},e.values=_,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(a,i){return c.type="throw",c.arg=e,n.next=a,i&&(n.method="next",n.arg=t),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],c=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var o=a.call(s,"catchLoc"),d=a.call(s,"finallyLoc");if(o&&d){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,b):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var i=a.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:_(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),b}},e}(e.exports);try{regeneratorRuntime=t}catch(n){"object"===typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}));var Il=f.a.createContext({});Object(b.memo)((function(e){return e.dictionary[Object(b.useContext)(Il).language]})).displayName="TranslatableText";var wl=["className","borderBottom","borderTop"],Al=["required","className","children"],Rl=["className","children"],Pl=function(e){var t=e.className,n=e.borderBottom,a=e.borderTop,i=xl(e,wl),r=qd()("checkin-formGroup",{"checkin-formGroup--bdBottom":n,"checkin-formGroup--bdTop":a},t);return f.a.createElement("div",Object.assign({className:r},i))};Pl.displayName="FormGroup",Pl.defaultProps={borderBottom:!1,borderTop:!1};var Dl=Object.assign(Pl,{Label:function(e){var t=e.required,n=e.className,a=e.children,i=xl(e,Al),r=Object(Ud.a)().t,s=qd()("checkin-formGroupLabel",n);return f.a.createElement("label",Object.assign({className:s},i),a,!1===t&&f.a.createElement("span",{className:"checkin-formGroupLabel-optional"},"(",r("core.Optional").toLowerCase(),")"))},Help:function(e){var t=e.className,n=e.children,a=xl(e,Rl);return f.a.createElement("p",Object.assign({className:qd()("checkin-formGroupHelp",t)},a),n)},Error:function(e){var t=e.className,n=e.error,a=Object(Ud.a)().t;if(!n)return null;var i="string"===typeof n?f.a.createElement(Hd.a,{i18nKey:n,t:a}):f.a.createElement(Hd.a,{components:n.components?n.components:[],i18nKey:n.key,t:a,values:n.values});return f.a.createElement("p",{className:qd()("checkin-formGroupError",t)},f.a.createElement(Sl,{name:"error"}),f.a.createElement("span",{className:"checkin-formGroupError__text"},i))},Fields:function(e){var t=e.className,n=e.children;return f.a.createElement("div",{className:qd()("checkin-formGroupFields",t)},n)}}),Ml=["hasError","icon","wrapperClass","focused","size","iconPlacement","className","allowDecimal","children","onChange"],Fl=Object(b.forwardRef)((function(e,t){var n,a=e.hasError,i=e.icon,r=e.wrapperClass,s=e.focused,c=e.size,o=void 0===c?"lg":c,d=e.iconPlacement,l=void 0===d?"left":d,u=e.className,m=e.allowDecimal,p=void 0!==m&&m,h=e.children,v=e.onChange,j=xl(e,Ml),g=qd()("checkin-input",((n={})["checkin-input--"+o]=!!o,n["checkin-input--invalid"]=a,n["checkin-input--hasIcon"]=!!i,n["checkin-input--hasSuffix"]=!!j.suffix,n["checkin-input--focused"]=s,n["checkin-input__icon-placement-left"]="left"===l,n["checkin-input__icon-placement-right"]="right"===l,n),u),O=qd()("checkin-input__icon",{"checkin-input__icon-left":"left"===l,"checkin-input__icon-right":"right"===l}),y=Object(b.useCallback)((function(e){if("number"===j.type){var t,n=parseFloat(e.target.value)||0;if("undefined"!==typeof j.min&&n<parseFloat(j.min)&&(e.target.value=""),"undefined"!==typeof j.max&&n>parseFloat(j.max)&&(e.target.value=""+j.max),!p)e.target.value=""+(null!=(t=parseInt(e.target.value))?t:"")}v(e)}),[p,j.type,j.max,j.min,v]);return f.a.createElement("div",{className:qd()("checkin-input__control",r)},f.a.createElement("input",Object.assign({className:g},j,{onChange:y,onBlur:function(e){"number"===j.type||Object(Qd.a)(j.value)||(e.target.value=j.value.toString().trim(),v(e)),j.onBlur&&j.onBlur(e)},ref:t})),i&&f.a.createElement("span",{className:O},i),j.suffix&&f.a.createElement("span",{className:"checkin-input__control__suffix"},j.suffix),h)}));Fl.displayName="Input",Object(b.forwardRef)((function(e,t){var n=Object(Vd.b)(e.name),a=n[0],i=n[1];return f.a.createElement(f.a.Fragment,null,f.a.createElement(Fl,Object.assign({},a,e,{hasError:!(!i.touched||!i.error),ref:t})),i.touched&&f.a.createElement(Dl.Error,{error:i.error}))})).displayName="FormikInput";var Ll=["name","id","label","required","description","children"];Object(b.forwardRef)((function(e,t){var n=e.name,a=e.id,i=e.label,r=e.required,s=e.description,c=e.children,o=xl(e,Ll),d=Object(Vd.b)(n),l=d[0],u=d[1];return f.a.createElement(Dl,null,i&&f.a.createElement(Dl.Label,{htmlFor:a,required:r},i),s&&f.a.createElement(Dl.Help,null,s),f.a.createElement(Fl,Object.assign({},l,o,{hasError:!(!u.touched||!u.error),id:a,name:n,ref:t})),u.touched&&f.a.createElement(Dl.Error,{error:u.error}),c)})).displayName="InputField";var Wl=function(e){var t=!!["tags","multiple"].includes(e.mode||"")&&f.a.createElement(Sl,{name:"green-check-mark-2"});return f.a.createElement(Gd.b,Object.assign({},e,{inputIcon:f.a.createElement(Sl,{name:"chevron-down"}),clearIcon:f.a.createElement(Sl,{name:"multiply-2"}),removeIcon:f.a.createElement(Sl,{name:"multiply-2"}),menuItemSelectedIcon:t,getPopupContainer:function(e){return e.parentNode},prefixCls:"checkin-select",showAction:["focus","click"]}))};Wl.defaultProps={showSearch:!0,optionFilterProp:"label",showArrow:!0,placeholder:"Select..."};var ql={NOK:{region:"NO",fullName:"Norwegian kroner",currency:"NOK"},EUR:{region:"EU",fullName:"Euros",currency:"EUR"},USD:{region:"US",fullName:"United States Dollar",currency:"USD"}},Vl=function(e){var t=e.currency,n=e.size,a=void 0===n?"md":n,i=qd()("checkin-badge__currency","checkin-badge__currency--"+a);return f.a.createElement("div",{className:i},f.a.createElement("div",{className:"checkin-badge__flag"},f.a.createElement("div",{className:"ch-flag-currency-"+t.toUpperCase()})," "),f.a.createElement("span",{className:"checkin-badge__label"},t.toUpperCase()))},Bl=function(e){var t=e.currency;return f.a.createElement("div",{className:"checkin-input__currency-select-option-label"},f.a.createElement(Vl,{currency:t})," ",f.a.createElement("p",null,ql[t.toUpperCase()].fullName))},Ul=[{title:"NOK",label:f.a.createElement(Bl,{currency:"nok"}),value:"nok"},{title:"EUR",label:f.a.createElement(Bl,{currency:"eur"}),value:"eur"},{title:"USD",label:f.a.createElement(Bl,{currency:"usd"}),value:"usd"}],Hl=["hasError","focused","wrapperClass","size","currency","defaultCurrency","allowNegative","className","placeholder","onCurrencyChange","showCurrencyDropdown","currencyDropdownHeader","onBlur"],zl=["formatValue"],Kl=Object(b.forwardRef)((function(e,t){var n,a=e.hasError,i=e.focused,r=e.wrapperClass,s=e.size,c=void 0===s?"lg":s,o=e.currency,d=void 0===o?null:o,l=e.defaultCurrency,u=void 0===l?"nok":l,m=e.allowNegative,p=void 0!==m&&m,h=e.className,v=e.placeholder,j=e.onCurrencyChange,g=e.showCurrencyDropdown,O=void 0!==g&&g,y=e.currencyDropdownHeader,x=void 0===y?null:y,k=e.onBlur,C=xl(e,Hl),T=Object(b.useContext)(Il).language,E=Object(b.useRef)();Object(b.useImperativeHandle)(t,(function(){return E.current}));var S=Object(b.useState)(d||u),N=S[0],_=S[1],I=qd()("checkin-input checkin-input__currency",((n={})["checkin-input--"+c]=!!c,n["checkin-input--invalid"]=a,n["checkin-input--focused"]=i,n["checkin-input--hasDropDown"]=O,n),h);Object(b.useEffect)((function(){C.value||(E.current.value=null)}));var w="undefined"!==typeof v?v:"en"===T?"0.00":"0,00",A=x?[{label:x,options:Ul}]:Ul;return f.a.createElement("div",{className:qd()("checkin-input__control checkin-input__currency-wrapper",r)},f.a.createElement(Mc.a,Object.assign({},C,{value:Number(C.value)||null,getInputRef:E,className:I,autoComplete:"off",displayType:"input",type:"text",decimalScale:2,fixedDecimalScale:!0,allowNegative:p,allowEmptyFormatting:!1,placeholder:w,decimalSeparator:"en"===T?".":",",thousandSeparator:"en"===T?",":" ",onBlur:function(e){if(e.target.value){var t=e.target.value.replace(/[\s,\.]/g,"");parseInt(t)||(e.target.value="")}k&&k(e)}})),!O||C.value?f.a.createElement("span",{className:"checkin-input__currency-label"},d||N," ",O&&f.a.createElement(Sl,{name:"lock-filled"})):f.a.createElement("div",{className:"checkin-input__currency-select"},f.a.createElement(Wl,{optionLabelProp:"children",showSearch:!1,value:d||N,defaultValue:N,onChange:function(e){_(e),j&&j(e)},options:A})))}));Kl.displayName="CurrencyInput",Object(b.forwardRef)((function(e,t){var n=e.formatValue,a=xl(e,zl),i=Object(Vd.b)(a.name),r=i[0],s=i[1],c=i[2],o=Object(b.useCallback)((function(e){a.onValueChange?a.onValueChange(e):c.setValue(n?n(e):e)}),[a.onValueChange,n]);return f.a.createElement(f.a.Fragment,null,f.a.createElement(Kl,Object.assign({value:r.value&&"object"===typeof r.value?r.value.floatValue:r.value,onBlur:r.onBlur},a,{onValueChange:o,hasError:!(!s.touched||!s.error),ref:t})),s.touched&&f.a.createElement(Dl.Error,{error:s.error}))})).displayName="FormikCurrencyInput";var Ql=["hasError","wrapperClass","className","focused","resizable"],Gl=Object(b.forwardRef)((function(e,t){var n=e.hasError,a=e.wrapperClass,i=e.className,r=e.focused,s=e.resizable,c=xl(e,Ql),o=qd()("checkin-input",{"checkin-input--invalid":n,"checkin-input--focused":!!r,"checkin-input--no-resize":!s},i);return f.a.createElement("div",{className:qd()("checkin-input__control",a)},f.a.createElement("textarea",Object.assign({className:o},c,{ref:t})))}));Gl.displayName="TextArea",Object(b.forwardRef)((function(e,t){var n=Object(Vd.b)(e.name),a=n[0],i=n[1];return f.a.createElement(f.a.Fragment,null,f.a.createElement(Gl,Object.assign({},a,e,{hasError:!(!i.touched||!i.error),ref:t})),i.touched&&f.a.createElement(Dl.Error,{error:i.error}))})).displayName="FormikTextArea";$d.a,Yd.Ed,Yd.xe;var $l=["hasError","wrapperClass","label","className","onChange","id","icon"],Yl=0;Object(b.forwardRef)((function(e,t){var n=e.hasError,a=e.wrapperClass,i=e.label,r=e.className,s=e.onChange,c=e.id,o=e.icon,d=xl(e,$l),l=f.a.useState(null),u=l[0],m=l[1],p=qd()("checkin-fileInput",{"checkin-fileInput--invalid":n,"checkin-fileInput--disabled":d.disabled},r),h=c||"file-input-"+Yl++;return f.a.createElement("div",{className:a},f.a.createElement("input",Object.assign({},d,{className:"checkin-input-hidden",id:h,onChange:function(e){for(var t=e.target.files||[],n=[],a=0;a<t.length;a++){var i=t[a].name.split(/(\\|\/)/g).pop();n.push(i)}m(n.join(", ")),s&&s(e)},type:"file",ref:t})),f.a.createElement("label",{htmlFor:h,className:p},f.a.createElement("span",{className:"checkin-fileInput__inner"},u?f.a.createElement("span",null,u):f.a.createElement("span",{className:"checkin-fileInput__placeholder"},d.placeholder)),f.a.createElement("span",{className:"checkin-btn checkin-btn--primary checkin-btn--lg"},f.a.createElement("span",{className:"checkin-btn__inner"},o&&f.a.createElement("span",{className:"checkin-btn__icon"},o),i&&f.a.createElement("span",{className:"checkin-btn__content"},i)))))})).displayName="FileInput";var Xl=["label","hasError","icon","wrapperClass","focused","size","iconPlacement","className","onChange","prefix"],Jl=Object(b.forwardRef)((function(e,t){var n,a=e.label,i=e.hasError,r=e.icon,s=e.wrapperClass,c=e.focused,o=e.size,d=void 0===o?"lg":o,l=e.iconPlacement,u=void 0===l?"left":l,m=e.className,p=e.onChange,h=e.prefix,v=xl(e,Xl),j=qd()("checkin-div-input",((n={})["checkin-div-input--"+d]=!!d,n["checkin-div-input--invalid"]=i,n["checkin-div-input--focused"]=c,n["checkin-div-input--read-only"]=v.readOnly,n["checkin-div-input--disabled"]=v.disabled,n),m),g=qd()("checkin-card-input",{"checkin-input--hasIcon":!!r,"checkin-input--hasSuffix":!!v.suffix,"checkin-div-input--read-only":v.readOnly}),O=qd()("checkin-card-prefix",{"checkin-div-input--read-only":v.readOnly,"checkin-div-input__prefix-icon-left":"left"===u}),y=qd()("checkin-input__icon",{"checkin-div-input__icon-left":"left"===u,"checkin-div-input__icon-right":"right"===u}),x=Object(b.useCallback)((function(e){"insertText"===e.nativeEvent.inputType&&isNaN(e.nativeEvent.data)&&(e.target.value=e.target.value.slice(0,-1)),p(e)}),["tel",v.max,v.min,p]);return f.a.createElement(Dl,null,f.a.createElement(Dl.Label,{htmlFor:v.id},a),f.a.createElement("div",{className:qd()("checkin-input__control",s)},f.a.createElement("div",{className:j},h&&f.a.createElement("label",{htmlFor:v.id,className:O},h),f.a.createElement("div",null,f.a.createElement("input",Object.assign({className:g,type:"tel"},v,{onChange:x,onBlur:function(e){Object(Qd.a)(v.value)||(e.target.value=v.value.toString().trim(),p(e)),v.onBlur&&v.onBlur(e)},maxLength:4,pattern:"\\d*",ref:t})),r&&f.a.createElement("span",{className:y},r),v.suffix&&f.a.createElement("span",{className:"checkin-input__control__suffix"},v.suffix)))))}));Jl.displayName="CardNumberInput",Object(b.forwardRef)((function(e,t){var n=Object(Vd.b)(e.name),a=n[0],i=n[1];return f.a.createElement(f.a.Fragment,null,f.a.createElement(Jl,Object.assign({},a,e,{hasError:!(!i.touched||!i.error),ref:t})),i.touched&&f.a.createElement(Dl.Error,{error:i.error}))})).displayName="FormikCardInput",Object(Zd.setLocale)({mixed:{required:"core.FieldIsRequired"},string:{min:function(e){return{key:"core.FieldMinLen",values:{number:e.min}}},max:function(e){return{key:"core.FieldMaxLen",values:{number:e.max}}},email:"core.FieldIsValidEmail",url:"core.FieldIsValidURL"}}),Object(Zd.addMethod)(Zd.mixed,"tlf",(function(e){return void 0===e&&(e={}),this.test("tlf",e.message,(function(t){var n=this.path,a=this.createError,i=t.value||"";if(!i)return!e.required||a({path:n,message:"core.FieldIsRequired"});var r=0===i.indexOf("+")?i:"+"+i,s=Object(Xd.a)(r);if(s){var c="TOO_SHORT"===s?"core.PhoneTooShort":"TOO_LONG"===s?"core.PhoneTooLong":"core.PhoneInvalid";return this.createError({path:this.path,message:e.message||c})}return!!Object(Jd.a)(r)||this.createError({path:this.path,message:e.message||"core.PhoneInvalid"})}))}));var Zl=["hideError"],eu=f.a.forwardRef((function(e,t){var n=e.id,a=e.label,i=e.name,r=e.value,s=e.description,c=e.disabled,o=e.indeterminate,d=e.checked,l=e.labelClassName,u=e.onChange,m=e.onBlur,p=e.children,h=e.className,b=e.dataId;return f.a.createElement("div",{className:qd()("checkin-checkbox",h,{"checkin-checkbox--disabled":c})},f.a.createElement("label",{className:"checkin-checkbox__label","data-id":b},f.a.createElement("input",{ref:t,id:n,name:i,value:r,className:"checkin-input-hidden checkin-checkbox__input",disabled:c,type:"checkbox","aria-checked":d,checked:d,onChange:u,onBlur:m}),f.a.createElement("span",{className:qd()("checkin-checkbox__check",{"checkin-checkbox__check--semi":o})},o&&!d?f.a.createElement(Sl,{name:"subtract"}):f.a.createElement(Sl,{name:"green-check-mark-2"})),!(!a&&!s)&&f.a.createElement("div",{className:"checkin-checkbox__desc"},a&&f.a.createElement("div",{className:qd()("checkin-checkbox__text",l)},a),s&&f.a.createElement("div",{className:"checkin-checkbox__help"},s))),p)}));eu.displayName="Checkbox",Object(b.forwardRef)((function(e,t){var n=e.hideError,a=xl(e,Zl),i=Object(Vd.b)(a.name),r=i[0],s=i[1];return f.a.createElement(f.a.Fragment,null,f.a.createElement(eu,Object.assign({},r,a,{checked:!!r.value,ref:t})),!n&&s.touched&&f.a.createElement(Dl.Error,{error:s.error}))})).displayName="FormikCheckbox";var tu=Object(b.forwardRef)((function(e,t){var n=e.id,a=e.label,i=e.name,r=e.value,s=e.description,c=e.htmlDescription,o=e.disabled,d=e.checked,l=e.onChange;return f.a.createElement("div",{className:qd()("checkin-radio",{"checkin-radio--disabled":o})},f.a.createElement("label",{className:"checkin-radio__label"},f.a.createElement("input",{id:n,ref:t,onChange:l,className:"checkin-input-hidden checkin-radio__input",name:i,value:r,disabled:o,type:"radio","aria-checked":d,checked:d}),f.a.createElement("span",{className:"checkin-radio__check"}),!!(a||s||c)&&f.a.createElement("div",{className:"checkin-radio__desc"},a&&f.a.createElement("div",{className:"checkin-radio__text"},a),s&&f.a.createElement("div",{className:"checkin-radio__help"},s),c&&f.a.createElement("div",{className:"checkin-radio__help",dangerouslySetInnerHTML:{__html:c}}))))}));tu.displayName="Radio";var nu=function(e){var t=Object(Ud.a)().t;return f.a.createElement(El.Primary,Object.assign({size:"sm"},e),t("core.Done"))},au=function(e){var t=e.get("month"),n=e.get("date");return 1===t?n>28:n>30},iu=function(e){return["nb","no"].includes(e)?il.a:sl.a},ru=function(e,t){var n=!1;return t.max&&(n=e.isAfter(t.max)),t.min&&(n=n||e.isBefore(t.min)),n},su=["className"],cu=function(e){var t,n=e.className,a=xl(e,su),i=Object(b.useContext)(Il).language,r=iu(i);return f.a.createElement("div",{className:"checkin-picker_wrap checkin-picker_wrap-icon-left"},f.a.createElement(el.a,Object.assign({prefixCls:"checkin-picker",className:qd()((t={},t["checkin-picker--with-clear"]=a.allowClear,t),n),locale:r,picker:"time",format:a.use12Hours?"LT":"HH:mm",generateConfig:nl.a,suffixIcon:f.a.createElement(Sl,{name:"clock-2",className:"time-icon"}),clearIcon:f.a.createElement(Sl,{name:"multiply-2"}),showSecond:!1,getPopupContainer:function(e){return e.parentNode},components:{button:nu}},a)))};cu.defaultProps={showNow:!1,placeholder:"00:00",hourStep:1,minuteStep:5};var ou=["iconPlacement","isAbstractDate","format","className","disabledDate"],du=function(e){var t,n,a=e.iconPlacement,i=void 0===a?"left":a,r=e.isAbstractDate,s=e.format,c=e.className,o=e.disabledDate,d=xl(e,ou),l=Object(b.useContext)(Il).language,u=iu(l),m=qd()("checkin-picker_wrap",{"checkin-picker_wrap-icon-left":"left"===i,"checkin-picker_wrap-icon-right":"right"===i});return f.a.createElement("div",{className:m},f.a.createElement(el.a,Object.assign({prefixCls:"checkin-picker",className:qd()((t={},t["checkin-picker--with-clear"]=d.allowClear,t),c),dropdownClassName:qd()((n={},n["checkin-picker--abstract"]=r,n)),locale:u,picker:"date",generateConfig:nl.a,suffixIcon:f.a.createElement(Sl,{name:"calendar-2",className:"calendar-icon"}),nextIcon:f.a.createElement(Sl,{name:"forward"}),prevIcon:f.a.createElement(Sl,{name:"back"}),superNextIcon:f.a.createElement(Sl,{name:"double-right"}),superPrevIcon:f.a.createElement(Sl,{name:"double-left"}),getPopupContainer:function(e){return e.parentNode},clearIcon:f.a.createElement(Sl,{name:"multiply-2"}),components:{button:nu},disabledDate:d.maxDate||d.minDate?function(e){return ru(e,{max:d.maxDate,min:d.minDate})}:r?au:o,format:s||u.dateFormat},d)))};du.defaultProps={showNow:!1};var lu=function(e){var t=e.color,n=e.percentage,a=void 0===n?0:n,i=2*Math.PI*90,r=(100-a)*i/100;return f.a.createElement("circle",{r:90,cx:100,cy:100,stroke:t,strokeWidth:14,fill:"transparent",style:{strokeDasharray:i,strokeDashoffset:a?r:i}})},uu=function(e){var t=e.value,n=e.pathColor,a=e.title,i=e.trailColor,r=Math.min(Math.max(t,0),100),s=Math.max(r,.5);return f.a.createElement("svg",{className:"checkin-progressBar__circle",viewBox:"0 0 200 200",version:"1.1",xmlns:"http://www.w3.org/2000/svg",role:"progressbar","aria-valuenow":r},f.a.createElement("g",{transform:"rotate(-90 100 100)"},f.a.createElement(lu,{color:i,percentage:100}),f.a.createElement(lu,{color:n,percentage:s})),f.a.createElement("g",{transform:"translate(0, -25)"},f.a.createElement("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",alignmentBaseline:"middle"},f.a.createElement("tspan",{fontSize:"1.5em",x:"50%",dy:"0.5em"},r,"%"),f.a.createElement("tspan",{fontSize:"0.95em",x:"50%",dy:"1.5em"},a))))};uu.defaultProps={pathColor:"#0099D8",trailColor:"#EFF0F1"};var mu=function(e){var t=e.value,n=e.pathColor,a=e.title,i=e.trailColor,r=Math.min(Math.max(t,0),100),s=Math.max(r,1);return f.a.createElement("div",{className:"checkin-progressBar__line"},f.a.createElement("div",{className:"checkin-progressBar__label"},a),f.a.createElement("div",{className:"checkin-progressBar__container",style:{backgroundColor:i}},f.a.createElement("div",{className:"checkin-progressBar__lineBar",role:"progressbar","aria-valuenow":r,style:{width:s+"%",backgroundColor:n}})))};mu.defaultProps={pathColor:"#0099D8",trailColor:"#EFF0F1"};var pu=["children","trigger","popupContainer"],hu=["className"],bu=["children"],fu=["triggerRef","children"],vu=function(e){var t=e.children,n=e.trigger,a=void 0===n?["click"]:n,i=e.popupContainer,r=xl(e,pu),s=Object(b.useRef)(),c=f.a.cloneElement("function"===typeof r.overlay?r.overlay():r.overlay,{triggerRef:s});return f.a.createElement(cl.a,Object.assign({prefixCls:"checkin-dropdown",trigger:a,getPopupContainer:function(e){return i||e.parentNode}},r,{overlay:c}),f.a.createElement("div",{ref:s},t||f.a.createElement(ju,null)))};vu.displayName="Dropdown";var ju=function(e){var t=e.className,n=xl(e,hu);return f.a.createElement("button",Object.assign({},n,{type:"button",className:qd()("checkin-dropdown-trigger",t)}),f.a.createElement(Sl,{name:"menu-horizontal"}))},gu=Object.assign(vu,{Menu:function(e){var t=e.triggerRef,n=e.children,a=xl(e,fu),i=Object(b.useRef)();return f.a.createElement("div",{ref:i},f.a.createElement(ol.c,Object.assign({onBlur:function(e){var n=i.current?i.current.parentNode:void 0,a=!!n&&"none"===window.getComputedStyle(n).display,r=e.currentTarget.contains(e.relatedTarget);!t||r||a||t.current.click()}},a,{tabIndex:-1}),n))},MenuItem:function(e){var t=e.children,n=xl(e,bu);return f.a.createElement(ol.b,Object.assign({tabIndex:0},n),t)},MenuDivider:function(e){var t=yl({},e);return f.a.createElement(ol.a,Object.assign({},t))},Trigger:ju}),Ou=["useBodyContainer","getTooltipContainer"],yu=function(e){var t=e.useBodyContainer,n=e.getTooltipContainer,a=xl(e,Ou),i=Object(b.useMemo)((function(){return n||(t?null:function(e){return(null==e?void 0:e.parentNode)||document.body})}),[n,t]);return f.a.createElement(dl.a,Object.assign({prefixCls:"checkin-tooltip",getTooltipContainer:i},a))};yu.displayName="Tooltip";var xu;!function(e){e[e.OUTER=0]="OUTER",e[e.INNER=1]="INNER"}(xu||(xu={}));var ku;!function(e){e.asc="asc",e.desc="desc"}(ku||(ku={}));var Cu=f.a.memo((function(e){var t=e.id,n=e.className,a=e.actions,i=e.totalRowsCount,r=e.positionTop,s=e.rowsSelected,c=e.canSelectAll,o=void 0!==c&&c,d=e.isSelectedAll,l=void 0!==d&&d,u=e.toggleSelectAll,m=Object(Ud.a)(),p=m.t,h=m.i18n,v=s>0,j=Object(b.useMemo)((function(){return new Intl.NumberFormat(h.language)}),[h.language]),g=Object(b.useMemo)((function(){return a.reduce((function(e,t){if(Object(ll.a)(t)){var n=t({rowsSelected:s,isSelectedAll:l});n&&e.push(n)}else e.push(t);return e}),[])}),[a,s,l]);return f.a.createElement("div",{id:t,className:qd()("checkin-table-toolbar",{"checkin-table-toolbar--fixed":v},n),style:{top:v?r:0}},v&&f.a.createElement("div",{className:"checkin-table-toolbar__selections"},p("core.YouHaveSelectedXRows",{count:j.format(s)}),o&&f.a.createElement("button",{type:"button",className:"checkin-table-toolbar__selections-link",onClick:u},l?p("core.DeselectAllRows"):p("core.SelectAllXRowsInList",{count:j.format(i)}))),f.a.createElement("div",{className:"checkin-table-toolbar__actions"},f.a.createElement(ul.a,{data:g,renderItem:Tu,renderRest:Eu,maxCount:"responsive",itemWidth:110})))}));function Tu(e){var t=e.type,n=e.icon,a=e.label,i=e.disabled,r=e.onClick,s=Object(b.useState)(!1),c=s[0],o=s[1];return f.a.createElement(El,{variant:"button"===t?"outline":"text",className:"checkin-table-toolbar__action",onClick:function(){var e=Ol(_l.mark((function e(){return _l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,r();case 3:o(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),disabled:i,size:"sm",iconPlacement:"left",icon:f.a.createElement(Sl,{name:n}),loading:c},a)}function Eu(e){return f.a.createElement(gu,{overlay:f.a.createElement(gu.Menu,null,e.map((function(e){var t=e.label,n=e.icon,a=e.disabled,i=e.onClick;return f.a.createElement(gu.MenuItem,{key:t,disabled:a,onClick:i},n&&f.a.createElement(Sl,{name:n}),f.a.createElement("span",null,t))})))})}Cu.displayName="Toolbar";var Su;!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.HEADER=1]="HEADER",e[e.SHADOW=2]="SHADOW"}(Su||(Su={}));var Nu,_u,Iu,wu=function(e){return"ch-notif-icon ch-notif-"+e};(Nu={})[ml.NotificationType.SUCCESS]=f.a.createElement(Sl,{className:wu("green"),name:"ok",testId:"notification-ok-icon"}),Nu[ml.NotificationType.ERROR]=f.a.createElement(Sl,{className:wu("red"),name:"error",testId:"notification-error-icon"}),Nu[ml.NotificationType.INFO]=f.a.createElement(Sl,{className:wu("blue"),name:"info",testId:"notification-info-icon"}),Nu[ml.NotificationType.WARNING]=f.a.createElement(Sl,{className:wu("yellow"),name:"error-2",testId:"notification-error-2-icon"}),Nu[ml.NotificationType.DARK]=null;!function(e){e.sidebar="sidebar",e.preview="preview",e.footer="footer",e.head="head"}(_u||(_u={})),function(e){e.sm="sm",e.md="md",e.lg="lg",e.xl="xl"}(Iu||(Iu={}));Iu.sm;var Au;!function(e){e.CREATE="CREATE",e.DELETE="DELETE",e.UPDATE="UPDATE",e.MOVE="MOVE"}(Au||(Au={}));hl.a.registerLanguage("javascript",fl.a),hl.a.registerLanguage("xml",jl.a);var Ru=Object(g.d)(mr((function(e){return{hasDifferentSeatPriceGroups:e.funcs.hasDifferentSeatPriceGroups,getTicketSeatPriceGroupPrice:e.funcs.getTicketSeatPriceGroupPrice,_setSeatUsers:e.funcs.setSeatUsers,showVat:e.showVat,users:e.users,seats:e.seats}})),Object(g.e)(Ae,{props:function(e){return{data:e.data}},options:function(){return{forceFetch:!1,fetchPolicy:"cache-only",variables:Je()}}}))((function(e){var t=e.seats,n=e.users,a=e.hasDifferentSeatPriceGroups,i=e.getTicketSeatPriceGroupPrice,r=e._setSeatUsers,s=e.data,c=e.showVat,o=Object(b.useState)([]),d=Object(U.a)(o,2),l=d[0],u=d[1],m=Object.values(n).filter((function(e){return"RESERVED"===e.seating}));Object(b.useEffect)((function(){var e=Object(k.a)(t);m.forEach((function(t){if(t.seat){var n=e.find((function(e){return e.id===t.seat.id}));n&&(n.userId=t.id,n.ticketId=t.category_id)}})),u(e)}),[t]);var p=function(){var e=[];e=m.filter((function(t){return!e.includes(t.category_id)}));var t=l.filter((function(e){return!e.userId})).length>0;return e.map((function(e){var n="EVENT"===s.event.type?Object(vt.jsxs)("div",{className:"checkin-seatmap-select",children:[Object(vt.jsx)("p",{children:e.name}),Object(vt.jsx)("div",{className:"checkin-seatmap-select__option-name",children:"".concat(e.crm.name)})]}):e.name;return{key:"ticket-option-".concat(e.category_id),value:e.id,disabled:t&&l.find((function(t){return t.userId===e.id})),label:n}}))};return Object(b.useEffect)((function(){0===l.filter((function(e){return!e.userId})).length&&r(l)}),[l]),0!==t.length&&a(m.map((function(e,n){return e.seat?Object(C.a)(Object(C.a)({},e.seat),{},{ticketId:e.category_id}):Object(C.a)(Object(C.a)({},t[n]),{},{ticketId:e.category_id})})))?Object(vt.jsx)("div",{className:"seatmap-allocation",children:l.map((function(e){var t,a;return Object(vt.jsxs)("div",{className:"seatmap-allocation__user",children:[Object(vt.jsx)(Wl,{size:"lg",value:null===e||void 0===e?void 0:e.userId,showSearch:!1,placeholder:Pt,options:p(),onChange:function(t){!function(e,t){var a=l.filter((function(e){return!e.userId}));if(e&&0===a.length){var r=Object(k.a)(l),s=e.userId,c=e.ticketId,o=r.findIndex((function(e){return e.userId===t})),d=r.findIndex((function(e){return e.userId===s}));r[d].userId=t,r[d].ticketId=r[o].ticketId,r[o].userId=s,r[o].ticketId=c;var m=i(n[t].category_id,r[d]),p=i(n[s].category_id,r[o]);r[d].price=m.price,r[d].vat=m.vat,r[o].price=p.price,r[o].vat=p.vat,u(r)}else{var h=Object(k.a)(l),b=h.find((function(t){return t.id===e.id})),f=i(n[t].category_id,e);b.userId=t,b.ticketId=n[t].category_id,b.price=f.price,b.vat=f.vat,u(h)}}(e,t)}}),Object(vt.jsxs)("div",{className:"seatmap-allocation__seat-wrapper",children:[Object(vt.jsxs)("div",{className:"seatmap-allocation__seat-wrapper__price-group",children:[Object(vt.jsx)("div",{className:"data-price-group-".concat(e.priceGroup)}),Object(vt.jsx)("p",{children:null!==(t=null===(a=s.event.seatmap.priceGroups.find((function(t){return t.name===e.priceGroup})))||void 0===a?void 0:a.description)&&void 0!==t?t:e.priceGroup})]}),Object(vt.jsxs)("div",{className:"seatmap-allocation__seat-wrapper__seat-info",children:[Object(vt.jsxs)("p",{children:[Kn," ",Object(vt.jsx)("b",{children:e.fieldTitle})]}),0!=e.row&&Object(vt.jsxs)("p",{children:[Qn," ",Object(vt.jsx)("b",{children:e.row})]}),Object(vt.jsxs)("p",{children:[e.unit?e.unit:Gn," ",Object(vt.jsx)("b",{children:e.seat})]})]}),e&&(Number(e.price)>0||Number(e.price)<0)&&Object(vt.jsxs)("p",{className:"seatmap-allocation__seat-wrapper__seat-price",children:[Object(vt.jsx)("span",{children:e.price>0?"+":"-"}),Object(vt.jsx)(ur.a,{value:c?yi.a.chain(e.price).multiply(e.vat/100+1).round(2).done():e.price,displayType:"text",thousandSeparator:" ",renderText:function(e){return Object(vt.jsx)("span",{children:e})}})," ",Object(vt.jsx)("span",{children:"NOK"})]})]})]},"seat-".concat(e.id))}))}):null})),Pu=function(e){Object(_.a)(n,e);var t=Object(I.a)(n);function n(e){var a;return Object(E.a)(this,n),(a=t.call(this,e)).state={modalIsOpen:!1,modalContent:"",modalMessage:[],hasIdentifiedUser:!1,orderItemsList:[],waitingTotal:0,hasClickedNext:!1,hasDigitalTickets:!1,error:!1,expanded:!1},a.openSeatmap=Object(x.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({modalIsOpen:!0}),document.body.style.overflowY="hidden";case 2:case"end":return e.stop()}}),e)}))),a.closeSeatmap=function(){var e=Object(x.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a.setState({modalIsOpen:!1,error:!1}),document.body.style.overflowY="initial";case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleValidation=function(){if(a.props.seats.length==a.props.getTotalQuantityWithSeating()){a.setState({error:!1});var e,t=Object.values(a.props.users).filter((function(e){return"RESERVED"===e.seating})),n=Object(B.a)(t);try{for(n.s();!(e=n.n()).done;){if(!e.value.seat)return a.setState({error:"AllocateTicket"}),!1}}catch(i){n.e(i)}finally{n.f()}return!0}return a.setState({error:"PickSeat"}),!1},a.ref=f.a.createRef(),a}return Object(S.a)(n,[{key:"componentDidUpdate",value:function(e){var t=this;this.ref.current&&this.props.components[Oe].expanded&&!this.state.expanded&&(setTimeout((function(){rr(t.ref,t.props.activeMode)}),100),this.setState({expanded:!0})),e.components[Oe].expanded&&!this.props.components[Oe].expanded&&this.setState({expanded:!1})}},{key:"render",value:function(){var e=this.props,t=e.activeMode,n=(e.orderInfo,e.components),a=e.handleCollapse,i=e.errors,r=e.showErrorHelper,s=e.showErrors,c=n[Oe];return t!==H^!n[Oe].isTouched?null:Object(vt.jsx)("div",{className:"registration--body",ref:this.ref,children:Object(vt.jsxs)(bs.AccordionItem,{expanded:t!==H||n[Oe].expanded,children:[Object(vt.jsxs)("div",{className:"df jcsb aic",children:[Object(vt.jsx)("h2",{tabIndex:-1,id:"seatmap-title",className:"mb0",children:Object(vt.jsx)("span",{children:$n})}),Object(vt.jsx)(bc,{hidden:t!==H,ariaLabelledBy:"seatmap-title",isTouched:c.isTouched,expanded:c.expanded,handleCollapse:a,current:Oe})]}),Object(vt.jsxs)(bs.AccordionItemBody,{children:[Object(vt.jsxs)("div",{className:!this.state.modalIsOpen&&"checkin-seatmap",children:[!this.state.modalIsOpen&&Object(vt.jsx)("div",{className:"dark-overlay",children:Object(vt.jsx)(Co,{text:Yn,onClick:this.openSeatmap})}),Object(vt.jsx)(Ld,{isActive:this.state.modalIsOpen,closeSeatmap:this.closeSeatmap,seatmapData:this.props.data.event.seatmap,ticketAmount:this.props.getTotalQuantityWithSeating()})]}),Object(vt.jsx)(Ru,{}),t===H&&Object(vt.jsx)("div",{className:"checkin-right",children:Object(vt.jsx)(Cs,{errors:i,showErrorHelper:r,showErrors:s,handleCollapse:a,current:Oe,target:this.props.hasAdditionals?ve:je,nextName:Nt,handleValidation:this.handleValidation,ref:this.ref})}),this.state.error&&Object(vt.jsx)("p",{className:"tright db errorMessages mt5",children:"PickSeat"===this.state.error?ei:Object(vt.jsx)("span",{children:"Velg hvillken billett som tilh\xf8rer sete"})})]})]})})}}]),n}(f.a.Component),Du=Object(g.d)(mr((function(e){return{setSeats:e.funcs.setSeats,handleChange:e.funcs.handleChange,handleCollapse:e.funcs.handleCollapse,components:e.components,getTotalQuantityWithSeating:e.funcs.getTotalQuantityWithSeating,errors:e.errors,showErrorHelper:e.funcs.showErrorHelper,showErrors:e.showErrors,seats:e.seats,users:e.users,hasAdditionals:Wr(e.event.additionals,e.additionals,e.convertedAdditionals).length>0}})),Object(g.e)(Ae,{props:function(e){return{data:e.data}},options:function(){return{fetchPolicy:"cache-only",variables:Je()}}}))(Pu),Mu=function(e){var t=e.event;return t.current===oe||t.current===re?Object(vt.jsx)("div",{role:"alert",className:"info-pill connection-alert",style:{margin:"0 auto",maxWidth:"650px"},children:Object(vt.jsxs)("p",{children:[Object(vt.jsx)("i",{className:"icons8-error"}),Ja]})}):t.current===ie?Object(vt.jsxs)("div",{role:"alert",className:"info-pill connection-alert",style:{margin:"0 auto",maxWidth:"650px"},children:[Object(vt.jsxs)("p",{children:[Object(vt.jsx)("i",{className:"icons8-error"}),"Connection failed"]}),Object(vt.jsxs)("div",{className:"reconnect-btn",children:[Object(vt.jsx)("p",{children:$a}),Object(vt.jsx)(vs.a,{type:"TailSpin",color:"#1c2b39",height:"30",width:"30"})]})]}):t.current===ae?Object(vt.jsxs)("div",{role:"alert",className:"info-pill connection-alert",style:{margin:"0 auto",maxWidth:"650px"},children:[Object(vt.jsxs)("p",{children:[Object(vt.jsx)("i",{className:"icons8-error"}),Ga]}),Object(vt.jsxs)("div",{className:"reconnect-btn",children:[Object(vt.jsx)("p",{children:$a}),Object(vt.jsx)(vs.a,{type:"TailSpin",color:"#1c2b39",height:"30",width:"30"})]})]}):t.current===ce&&t.previous.length>0&&t.previous!==ce?Object(vt.jsxs)("div",{role:"alert",className:"info-pill connection-alert",style:{margin:"0 auto",maxWidth:"650px"},children:[Object(vt.jsxs)("p",{children:[Object(vt.jsx)("i",{className:"icons8-error"}),$a]}),Object(vt.jsx)("div",{className:"reconnect-btn",children:Object(vt.jsx)(vs.a,{type:"TailSpin",color:"#1c2b39",height:"30",width:"30"})})]}):null},Fu=function(e){var t=e.event,n=e.orderIsFree,a=e.totalQuantity,i=e.hasLockedTicketForm,r=e.components,s=e.paymentOption,c=e.paymentSuccessful,o=e.setPaymentSuccessful,d=e.hasOrdered,l=e.activeMode,u=e.websocketConnectionState,m=e.orderHasWaitingItems,p=e.expired,h=e.hasAvailability;return Object(b.useEffect)((function(){et("checkin_hash")&&t&&t.settings.texts.thankyou_url&&(window.onbeforeunload=null,window.location.replace(t.settings.texts.thankyou_url))}),[t]),Object(vt.jsx)(vt.Fragment,{children:p?Object(vt.jsxs)("div",{role:"alert",className:"registration mt60 tcenter",children:[Object(vt.jsx)("h3",{className:"tcenter mb30",children:Xa}),Object(vt.jsx)("div",{style:{display:"flex",justifyContent:"space-around"},children:Object(vt.jsx)("button",{className:"btn btn-default mb30 db w80p",onClick:function(){window.open("https://app.checkin.no/event/".concat(document.event_id))},children:Ya})})]}):Object(vt.jsxs)(vt.Fragment,{children:[h&&Object(vt.jsx)(Mu,{event:u,expired:p}),Object(vt.jsxs)("div",{className:"registration ".concat(!h||u.current!==ie&&u.current!==oe&&u.current!==ce&&u.current!==ae?"":"disabled"),children:[Object(vt.jsx)(xd,{}),et("checkin_hash")?Object(vt.jsxs)("div",{children:[Object(vt.jsx)(js.BrowserView,{children:Object(vt.jsx)("div",{className:"vippsGray mt110",children:Object(vt.jsx)("div",{className:"tcenter",children:Object(vt.jsx)(vs.a,{type:"TailSpin",color:"#2dc943",height:"100",width:"100"})})})}),Object(vt.jsx)(js.MobileOnlyView,{children:c?Object(vt.jsx)(Os,{orderHasWaitingItems:m,event:t}):Object(vt.jsx)(rd,{setPaymentSuccessful:o})})]}):Object(vt.jsxs)(b.Fragment,{children:[("100"===et("status")||"202"===et("status"))&&Object(vt.jsx)(js.MobileOnlyView,{children:c?Object(vt.jsx)(Os,{orderHasWaitingItems:m,event:t}):Object(vt.jsx)(rd,{setPaymentSuccessful:o})}),Object(vt.jsx)(bs.Accordion,{accordion:!1,children:d&&s!==X?Object(vt.jsxs)(b.Fragment,{children:[(s!==G&&s!==X||n())&&Object(vt.jsx)(Os,{orderHasWaitingItems:m,event:t}),Object(vt.jsx)(Jc,{noScroll:!0})]}):Object(vt.jsx)(b.Fragment,{children:s===X&&c||s===G&&c?Object(vt.jsxs)("div",{children:[Object(vt.jsx)(Os,{orderHasWaitingItems:m,event:t}),Object(vt.jsx)(Jc,{noScroll:!0})]}):Object(vt.jsxs)(b.Fragment,{children:[Object(vt.jsx)(Es,{activeMode:l}),a>0&&Object(vt.jsxs)(b.Fragment,{children:[l!==H&&Object(vt.jsxs)(b.Fragment,{children:[Object(vt.jsx)(Ps,{}),Object(vt.jsx)(vc,{activeMode:l}),Object(vt.jsx)(Od,{activeMode:l})]}),l!==z&&i&&Object(vt.jsxs)(b.Fragment,{children:[Object(vt.jsx)(vc,{activeMode:l}),r[fe].isTouched&&Object(vt.jsx)(Kc,{activeMode:l}),r[Oe].isTouched&&Object(vt.jsx)(Du,{activeMode:l}),r[ve].isTouched&&Object(vt.jsx)(Od,{activeMode:l})]}),Object(vt.jsx)(Jc,{}),(l===z||r[je].isTouched)&&Object(vt.jsx)(jd,{activeMode:l})]})]})})})]})]})]})})},Lu=mr((function(e){return{websocketConnectionState:e.websocketConnectionState,event:e.event,expired:e.expired,orderHasWaitingItems:e.orderHasWaitingItems,orderIsFree:e.funcs.orderIsFree,setPaymentSuccessful:e.funcs.setPaymentSuccessful,totalQuantity:e.totalQuantity,hasLockedTicketForm:e.hasLockedTicketForm,components:e.components,paymentSuccessful:e.paymentSuccessful,paymentOption:e.paymentInfo.paymentOption,hasOrdered:e.apolloState.hasOrdered,activeMode:e.apolloState.activeMode,hasAvailability:e.hasAvailability}}))(Object(b.memo)(Fu)),Wu=function(e){Object(_.a)(n,e);var t=Object(I.a)(n);function n(){var e;Object(E.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={error:!1,message:"",info:null},e}return Object(S.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,message:e.message,info:t});try{window.checkin_event&&window.checkin_event.getEventRegistrationForm(document.event_id).initRegistrationForm()}catch(n){console.error(n)}}},{key:"render",value:function(){var e="https://app.checkin.no/event/".concat(+document.event_id,"/i");return this.state.error?Object(vt.jsxs)("div",{role:"alert",className:"registration mt60 tcenter",children:[Object(vt.jsx)("h3",{className:"tcenter mb30",children:"Sorry, something went wrong!"}),Object(vt.jsxs)("div",{style:{display:"flex",justifyContent:"space-around"},children:[localStorage.getItem("checkin_state")&&Object(vt.jsx)("button",{type:"button",className:"btn btn-default mb30 db w80p",onClick:function(){localStorage.removeItem("checkin_state"),window.location.reload()},children:"Delete App state"}),Object(vt.jsx)("button",{className:"btn btn-default mb30 db w80p",onClick:function(){return window.location.reload()},children:"Try again"})]}),js.isIE&&Object(vt.jsx)("p",{className:"mb30",children:"Your browser might not be fully supported, try another one"}),window.location.href.includes("checkin.no")||this.state.message.includes("ticket sale")?null:Object(vt.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"btn btn-default mb60 db w80p",style:{textDecoration:"none",cursor:"pointer",margin:"auto"},children:"Go to the event form at Checkin.no"})]}):this.props.children}}]),n}(f.a.Component),qu=Wu;n(977);var Vu=function(){return Object(b.useEffect)((function(){return document.isCheckinRegistrationFormMounted=!0,function(){document.isCheckinRegistrationFormMounted=!1}}),[]),Object(vt.jsx)(qu,{children:Object(vt.jsx)(g.a,{client:Qe,children:Object(vt.jsx)(yt,{children:Object(vt.jsx)(hs,{children:Object(vt.jsx)(Lu,{})})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));j.a.render(Object(vt.jsx)(Vu,{}),document.getElementById("checkin_registration")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[978,1,2]]]);
//# sourceMappingURL=main.0176837d.chunk.js.map